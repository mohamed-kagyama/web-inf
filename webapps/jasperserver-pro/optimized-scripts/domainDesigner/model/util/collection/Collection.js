/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore"],function(t,n,i){function e(t,n,i,e){switch(e.length){case 0:return t.call(n,i);case 1:return t.call(n,i,e[0]);case 2:return t.call(n,i,e[0],e[1]);case 3:return t.call(n,i,e[0],e[1],e[2]);case 4:return t.call(n,i,e[0],e[1],e[2],e[3])}}var c=t("underscore"),o=["map","filter","where","reject","sortBy","initial","rest","compact"],r=["each","reduce","reduceRight","find","findWhere","every","some","any","max","min","size","first","last"],l=function(t,n){n=n||{},n.chain&&(this._chain=!0),this.fromArray(t,n)};c.extend(l.prototype,{fromArray:function(t,n){this.collection=t&&c.isArray(t)?t:[]},toArray:function(t){return t?this.collection:c.clone(this.collection)},by:function(t){return this.findWhere(t)},byField:function(t,n){var i={};return i[t]=n,this.by(i)},chain:function(){return this._createCollection(this.collection,{chain:!0})},add:function(t,n){return n=c.isNumber(n)?n:this.size(),c.isArray(t)?this.collection.splice.apply(this.collection,[n,0].concat(t)):this.collection.splice(n,0,t),this},remove:function(t,n){return n=n||1,this.collection.splice(t,n)},indexOf:function(t){var n,i=-1;return c.isFunction(t)?(n=t,this.find(function(t,e){if(n(t))return i=e,!0})):(t=this.by(t),i=t?c.indexOf(this.collection,t):-1),i},at:function(t){return this.collection[t]},concat:function(t){return this._isCollection(t)&&(t=t.toArray(!0)),this._createCollection(this.collection.concat(t))},_isCollection:function(t){return t&&c.isFunction(t.chain)&&c.isArray(t.collection)},_createCollection:function(t,n){return new(this._getCollectionClass())(t,n)},_getCollectionClass:function(){return l}}),function(){c.each(o,function(t){l.prototype[t]=function(){var n=e(c[t],null,this.collection,arguments);return this._chain&&(n=this._createCollection(n,{chain:!0})),n}})}(),function(){c.each(r,function(t){l.prototype[t]=function(){return e(c[t],null,this.collection,arguments)}})}(),i.exports=l});