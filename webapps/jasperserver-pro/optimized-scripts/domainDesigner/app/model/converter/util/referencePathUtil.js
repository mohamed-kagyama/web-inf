/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../../util/pathUtil","../../../../model/schema/util/schemaModelUtil","../../../../model/schema/util/entityUtil","../../../../model/schema/enum/schemaEntitiesEnum"],function(e,t,a){function n(e,t){var a=d.getTableReferenceByJoinAlias(e,t),n=d.getTableByTableReference(a,t),i=d.getResourceParents(n,t).map(function(e){return e.getName()}),r=[a.getName()].concat(i).reverse();return c.join(r,"\\",".")}function i(e,t){var a=r(e,t);return c.join(a,"\\",".")}function r(e,t){var a,n,i,r=e.getFieldId(),s=e.getFieldType(),l=e.getSourceId(),c=e.getSourceType(),u=[];if(g.isConstantGroup(c)){var m=t.constantGroups.byId(l);a=m.getCalcFields().byId(r),u=[m.getName(),a.getName()]}else if(g.isTableReference(c))n=t.tableReferences.byId(l),i=t.tables.byId(n.getTableId()),g.isCalcField(s)?(a=n.getCalcFields().byId(r),u=d.getResourceParents(i,t).map(function(e){return e.getName()}),u.reverse(),u.push(n.getName(),a.getName())):(a=o.findWhere(d.getAllTableFields(i),{id:r}),u=d.getResourceParents(a,t).map(function(e){return e.getId()===i.getId()?n.getName():e.getName()}),u.reverse(),u.push(a.getName()));else{var f=t.dataIslands.byId(e.getDataIslandId()),I=d.getDataIslandSource(f,t);if(g.isJoinTree(c))a=I.getCalcFields().byId(r),u=[I.getName(),a.getName()];else if(g.isJoinAlias(c)){var b=I.getJoinAliases().byId(l);n=d.getTableReferenceByJoinAlias(b,t),g.isCalcField(s)?a=n.getCalcFields().byId(r):(i=t.tables.byId(n.getTableId()),a=o.findWhere(d.getAllTableFields(i),{id:r})),u=[I.getName(),b.getName(),a.getName()]}}return u}function s(e,t){var a=d.getPresentationParents(e,t);return a.reverse(),a.splice(0,1),a.push(e),a=o.map(a,function(e){return e.getName()}),c.join(a,"\\",".")}function l(e,t){var a,n,i,r="",s=t.collections,l=e.getSourceId(),m=e.getSourceType(),f=[];return a=d.getResourceByIdAndType(l,m,s),g.isJoinTree(m)||g.isConstantGroup(m)?r=a.getName():g.isTableReference(m)&&(f=d.getResourceParentsByIdAndType(a.getTableId(),u.TABLE,s),n=o.map(f,function(e){return e.getName()}),i=n.reverse().concat(a.getName()),r=c.join(i,"\\",".")),r}var o=e("underscore"),c=e("../../../util/pathUtil"),d=e("../../../../model/schema/util/schemaModelUtil"),g=e("../../../../model/schema/util/entityUtil"),u=e("../../../../model/schema/enum/schemaEntitiesEnum");a.exports={getJoinAliasReferencePath:n,getPresentationFieldReferencePath:i,getPresentationFieldHierarchicalName:s,getDataIslandResourcePath:l}});