/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","./state/ParseJoinExpressionOperatorState","./state/ParseConstantJoinExpressionState","./error/CannotParseJoinExpressionError","./factory/joinParserStateFactory","./enum/joinParserStateNamesEnum","../expressionWalker"],function(t,e,n){function a(t){return(new u).parseJoin(t)}var s=t("underscore"),r=t("./state/ParseJoinExpressionOperatorState"),i=t("./state/ParseConstantJoinExpressionState"),o=t("./error/CannotParseJoinExpressionError"),h=t("./factory/joinParserStateFactory"),c=t("./enum/joinParserStateNamesEnum"),S=t("../expressionWalker"),u=function(){this.initialize()};s.extend(u.prototype,{initialize:function(){s.bindAll(this,"_changeState","_beforeChangeState"),this.context={currentJoinExpression:{},joinExpressions:[]},this.state=h.create(c.PARSE_JOIN_EXPRESSION_OPERATOR_STATE,this.context)},parseJoin:function(t){return S.walk(t,this._getHandlers()),this.context.joinExpressions},_getHandlers:function(){return{any:this._beforeChangeState,and:this._changeState,not:this._changeState,operands:this._changeState,equals:this._changeState,notEqual:this._changeState,greater:this._changeState,less:this._changeState,greaterOrEqual:this._changeState,lessOrEqual:this._changeState,in:this._changeState,variable:this._changeState,name:this._changeState}},_beforeChangeState:function(t){if(this.state instanceof r&&s.isString(t)&&!this.state[t])throw new o},_changeState:function(t,e){if(this.state=this.state[e](t,e),this.state instanceof i)return this.state=this.state.parseConstantJoinExpression(t),!0}}),n.exports={parseJoin:a}});