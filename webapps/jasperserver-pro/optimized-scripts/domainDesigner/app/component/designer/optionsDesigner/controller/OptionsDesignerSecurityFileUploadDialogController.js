/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","runtime_dependencies/js-sdk/src/common/util/base64","bundle!DomainDesignerBundle","runtime_dependencies/js-sdk/src/common/util/i18nMessage","../../../../model/enum/subResourceTypesEnum","../../../../common/util/storeChangeEventCallbackExecutorUtil","backbone","../../../../dispatcher/enum/applicationStateEventsEnum"],function(e,i,t){var n=e("underscore"),o=e("runtime_dependencies/js-sdk/src/common/util/base64"),s=e("bundle!DomainDesignerBundle"),r=e("runtime_dependencies/js-sdk/src/common/util/i18nMessage"),l=e("../../../../model/enum/subResourceTypesEnum"),c=e("../../../../common/util/storeChangeEventCallbackExecutorUtil"),a=e("backbone"),u=e("../../../../dispatcher/enum/applicationStateEventsEnum"),d=(r.create(s),function(e){this.initialize(e)});n.extend(d.prototype,{initialize:function(e){this.storeChangeEventBus=e.storeChangeEventBus,this.applicationDispatcherEventBus=e.applicationDispatcherEventBus,this.optionsDesignerEventBus=e.optionsDesignerEventBus,this.securityFileUploadDialog=e.securityFileUploadDialog,this.notification=e.notification,this.optionsDesignerStore=e.optionsDesignerStore,this._initEvents()},_initEvents:function(){var e=c.getExecutor(this);this.listenTo(this.storeChangeEventBus,"change",e),this.listenTo(this.optionsDesignerEventBus,"show:securityFileUploadDialog",this._onShowSecurityFileUploadDialog),this.listenTo(this.securityFileUploadDialog,"add:fromRepository",this._onAddSecurityFileFromRepository),this.listenTo(this.securityFileUploadDialog,"add:localFile",this._onAddSecurityFileFromFileSystem)},_onShowSecurityFileUploadDialog:function(){this.securityFileUploadDialog.open()},_onAddSecurityFileFromRepository:function(e){var i={uri:e,type:l.FILE_REFERENCE};this._triggerAddSecurityFile(i)},_onAddSecurityFileFromFileSystem:function(e){var i=e.content,t=e.name,n=o.encode(i);this._triggerAddSecurityFile({content:{raw:i,base64:n},type:l.FILE,label:t})},_triggerAddSecurityFile:function(e){this.applicationDispatcherEventBus.trigger(u.SECURITY_DESIGNER_SHOW_REPLACE_FILE_CONFIRM_DIALOG,e)},"optionsDesigner:replaceSecurityFile":function(){}},a.Events),t.exports=d});