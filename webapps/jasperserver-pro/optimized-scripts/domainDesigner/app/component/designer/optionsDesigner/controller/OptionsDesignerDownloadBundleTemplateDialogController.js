/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../util/fileDownloader","../../../../common/util/storeChangeEventCallbackExecutorUtil","backbone","../../../../dispatcher/enum/applicationStateEventsEnum"],function(e,n,t){var o=e("underscore"),i=e("../util/fileDownloader"),a=e("../../../../common/util/storeChangeEventCallbackExecutorUtil"),l=e("backbone"),s=e("../../../../dispatcher/enum/applicationStateEventsEnum"),d=function(e){this.applicationDispatcherEventBus=e.applicationDispatcherEventBus,this.storeChangeEventBus=e.storeChangeEventBus,this.optionsDesignerEventBus=e.optionsDesignerEventBus,this.downloadBundleTemplateDialog=e.downloadBundleTemplateDialog,this.clientDomainSchemaAdvancedOptionsService=e.clientDomainSchemaAdvancedOptionsService,this._initEvents()};o.extend(d.prototype,l.Events,{_initEvents:function(){var e=a.getExecutor(this);this.listenTo(this.storeChangeEventBus,"change",e),this.listenTo(this.optionsDesignerEventBus,"show:downloadBundleTemplateDialog",this._onShowDownloadBundleTemplateDialog),this.listenTo(this.optionsDesignerEventBus,"hide:downloadBundleTemplateDialog",this._onHideDownloadBundleTemplateDialog),this.listenTo(this.optionsDesignerEventBus,"downloadBundleTemplate",this._onDownloadBundleTemplate)},_onShowDownloadBundleTemplateDialog:function(){this.downloadBundleTemplateDialog.open()},_onHideDownloadBundleTemplateDialog:function(){this.downloadBundleTemplateDialog.close()},_onDownloadBundleTemplate:function(e){var n=e.autoGenerateDescriptionKeyIfMissing,t=e.autoGenerateLabelKeyIfMissing;if(n||t){var o=this.clientDomainSchemaAdvancedOptionsService.generateBundleKeys(e);this.applicationDispatcherEventBus.trigger(s.OPTIONS_DESIGNER_GENERATE_BUNDLE_KEYS,o)}else this._getBundleTemplateAndDownload();this.downloadBundleTemplateDialog.close()},_getBundleTemplateAndDownload:function(){var e=this.clientDomainSchemaAdvancedOptionsService.getBundleTemplate();i.download(e,"domain18n.properties")},"optionsDesigner:generateBundleKeys":function(){this._getBundleTemplateAndDownload()}}),t.exports=d});