/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","bundle!DomainDesignerBundle","runtime_dependencies/js-sdk/src/common/util/i18nMessage","../../../../model/util/resourcePropertiesUtil","../../../../model/enum/subResourceTypesEnum"],function(e,r,t){var n=e("underscore"),u=e("bundle!DomainDesignerBundle"),i=e("runtime_dependencies/js-sdk/src/common/util/i18nMessage"),o=e("../../../../model/util/resourcePropertiesUtil"),s=e("../../../../model/enum/subResourceTypesEnum"),l=i.create(u),c=function(e){};n.extend(c.prototype,{convert:function(e){var r=e.resourceProperties.uri;return{bundles:this._getBundles(e.resourceProperties.bundles,r),securityFile:this._getSecurityFile(e.resourceProperties.securityFile,r)}},_getSecurityFile:function(e,r){return e?n.extend({},e,{location:this._getResourceLocation(e,r),computedLabel:this._getSecurityFileLabel(e)}):null},_getSecurityFileLabel:function(e){var r;return e.type===s.FILE_REFERENCE?r=o.parseFileNameFromUrl(e.uri):e.type===s.FILE&&(r=e.label),r},_getBundles:function(e,r){return n.map(e,function(e){return n.extend({},e,{location:this._getResourceLocation(e,r),computedLabel:this._getBundleLabel(e)})},this)},_getBundleLabel:function(e){return e.type===s.FILE_REFERENCE?o.parseFileNameFromUrl(e.uri):e.type===s.FILE?o.createBundleLabelFromLabelAndLocale(e.label,e.locale):void 0},_getResourceLocation:function(e,r){var t,n=e.type===s.FILE,u=e.type===s.FILE_REFERENCE;return n||o.isResourceDomainSubResource(e.uri,r)?t=l("domain.designer.advanced.options.resource.local.file"):u&&(t=e.uri),t}}),t.exports=c});