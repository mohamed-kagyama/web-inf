/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../../../common/util/storeChangeEventCallbackExecutorUtil","bundle!DomainDesignerBundle","runtime_dependencies/js-sdk/src/common/util/i18nMessage","../../../validation/state/enum/validationStateNameEnum","backbone"],function(e,t,n){var i=e("underscore"),o=e("../../../../common/util/storeChangeEventCallbackExecutorUtil"),a=e("bundle!DomainDesignerBundle"),s=e("runtime_dependencies/js-sdk/src/common/util/i18nMessage"),c=e("../../../validation/state/enum/validationStateNameEnum"),l=e("backbone"),u=s.create(a),r=function(e){this.storeChangeEventBus=e.storeChangeEventBus,this.notification=e.notification,this.applicationCrossComponentEventBus=e.applicationCrossComponentEventBus,this.uploadSchemaDialog=e.uploadSchemaDialog,this.validationStateFactory=e.validationStateFactory,this._initEvents()};i.extend(r.prototype,l.Events,{_initEvents:function(){var e=o.getExecutor(this);this.listenTo(this.storeChangeEventBus,"change",e),this.listenTo(this.applicationCrossComponentEventBus,"schema:upload",this._showUploadSchemaDialog),this.listenTo(this.uploadSchemaDialog,"uploadSchema",this._afterSchemaFileSelected)},_showUploadSchemaDialog:function(){this.uploadSchemaDialog.open()},_afterSchemaFileSelected:function(e,t){var n=this._getExtensionFromFileName(t);this.validationStateFactory.enter(c.UPLOAD_SCHEMA_INITIAL_STATE,{domainSchemaString:e,domainSchemaType:n})},_getExtensionFromFileName:function(e){return e.substr(e.lastIndexOf(".")).toLowerCase()},"optionsDesigner:uploadSchema":function(){this.notification.show({message:u("domain.designer.advanced.options.updateSchema.success.notification"),type:"success"})}}),n.exports=r});