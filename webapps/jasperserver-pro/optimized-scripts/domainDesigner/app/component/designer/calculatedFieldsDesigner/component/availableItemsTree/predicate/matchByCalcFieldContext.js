/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../../../../../../model/schema/util/entityUtil","../util/converterUtil","../../../../../layout/sidebarView/util/artificialTreeResourceEntityUtil","../../../../../../../model/schema/util/schemaModelUtil"],function(e,i,r){var l=e("underscore"),s=e("../../../../../../../model/schema/util/entityUtil"),t=e("../util/converterUtil"),a=e("../../../../../layout/sidebarView/util/artificialTreeResourceEntityUtil"),o=e("../../../../../../../model/schema/util/schemaModelUtil");r.exports=function(e){var i,r,n,c=e.schema,u=e.resource,d=e.calcFieldsContext,T=d.sourceType,f=d.sourceId,b=!1;if(s.isField(u)){var y=t.getContextKey(u.id,e);b=Boolean(d.availableVariables[y])}if(b)s.isConstantGroup(T)?b=!0:s.isCalcField(u)&&s.isConstantGroup(u.sourceType)?b=!0:s.isTableReference(T)?(i=e.tableReference,b=i&&i.id===f):s.isJoinTree(T)&&(b=e.joinTree&&e.joinTree.id===f);else if(a.isConstantGroup(u)||s.isTable(u))b=!0;else if(s.isTableReference(T))if(s.isTableReference(u))b=u.id===f;else if(s.isJoinAlias(u))i=o.getTableReferenceByJoinAlias(u,c),b=i.id===f;else if(s.isTableGroup(u))i=e.tableReference,b=i.id===f;else if(s.isDataSource(u)||s.isDataSourceGroup(u)){i=o.getResourceByIdAndType(f,T,c),r=o.getTableByTableReference(i,c);var R=o.getResourceParents(r,c);R=l.groupBy(R,"id");var p=o.getJoinAliasByTableReferenceId(i.id,c);b=Boolean(R[u.id])&&!p}else a.isDerivedTableGroup(u)?(i=o.getResourceByIdAndType(f,T,c),r=o.getTableByTableReference(i,c),b=s.isDerivedTable(r)):s.isJoinTree(u)&&(n=u,b=n.joinAliases.some(function(e){return e.tableReferenceId===f}));else s.isJoinTree(T)&&(s.isJoinAlias(u)||s.isTableGroup(u)?(n=e.joinTree,b=n.id===f):s.isJoinTree(u)&&(n=u,b=n.id===f));return b}});