/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","backbone","../../../../common/component/util/emToPxUtil","../util/presentationDesignerColumnsResizingUtil"],function(e,t,n){var i=e("underscore"),s=e("backbone"),o=e("../../../../common/component/util/emToPxUtil"),r=e("../util/presentationDesignerColumnsResizingUtil"),a=function(e){this.initialize(e)};i.extend(a.prototype,s.Events,{initialize:function(e){this.minCanvasWidth=o.convertEmToPx(e.minCanvasWidthEm),this.presentationDesignerEventBus=e.presentationDesignerEventBus,this.presentationDesignerStore=e.presentationDesignerStore,this.applicationCrossComponentEventBus=e.applicationCrossComponentEventBus,this._initEvents()},_initEvents:function(){this.listenTo(this.applicationCrossComponentEventBus,"sidebar:resize",this._onSidebarResize),this.listenTo(this.presentationDesignerEventBus,"canvas:resize:left:column",this._onDesignerResizeLeftColumn),this.listenTo(this.presentationDesignerEventBus,"canvas:resize:right:column",this._onDesignerResizeRightColumn)},_onSidebarResize:function(e,t){var n=e-t,i=this.presentationDesignerStore.get("canvasWidth");i&&this.presentationDesignerStore.set({canvasWidth:i-n})},_onDesignerResizeLeftColumn:function(e){var t=e.offsetLeft,n=this._getCanvasOrMinWidth(),i=this._getColumn0WidthInPx({canvasWidth:n});this._updateColumnsWidths({canvasWidth:n,offsetLeft:i+t})},_onDesignerResizeRightColumn:function(e){var t=e.offsetLeft;this._updateColumnsWidths({canvasWidth:this._getCanvasOrMinWidth(),offsetLeft:t})},_getColumn0WidthInPx:function(e){var t=this.presentationDesignerStore.get("column0Width");return r.convertOffsetLeftToPx(t,e.canvasWidth)},_getCanvasOrMinWidth:function(e){e=e||this.presentationDesignerStore.get("canvasWidth");var t=this.presentationDesignerStore.get("scrollBarWidth"),n=this.presentationDesignerStore.get("isScrollBarPresent"),i=this.minCanvasWidth;return r.getCanvasOrMinWidth({canvasWidth:e,scrollBarWidth:t,isScrollBarPresent:n,minCanvasWidth:i})},_updateColumnsWidths:function(e){var t=this.presentationDesignerStore.get("resizer"),n=r.getColumnsWidths({canvasWidth:e.canvasWidth,offsetLeft:e.offsetLeft});r.isResizerWithinBoundaries({offsetLeft:e.offsetLeft,canvasWidth:e.canvasWidth,minOffsetInPercent:t.minOffsetInPercent,maxOffsetInPercent:t.maxOffsetInPercent})&&this.presentationDesignerStore.set(n)}}),n.exports=a});