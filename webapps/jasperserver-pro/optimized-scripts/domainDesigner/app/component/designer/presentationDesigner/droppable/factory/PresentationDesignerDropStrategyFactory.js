/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../draggable/enum/draggableOriginEnum","../../enum/dropZonePositionEnum"],function(e,t,r){var a=e("underscore"),n=e("../../draggable/enum/draggableOriginEnum"),s=e("../../enum/dropZonePositionEnum"),i=function(e){this.initialize(e)};a.extend(i.prototype,{initialize:function(e){this.presentationCanvasDroppableItemsService=e.presentationCanvasDroppableItemsService,this.presentationSidebarToCanvasDropStrategyFactory=e.presentationSidebarToCanvasDropStrategyFactory,this.presentationCanvasDropStrategyFactory=e.presentationCanvasDropStrategyFactory},create:function(e){var t,r=e.items,a=e.dropZoneModel,s=this._getDraggableOrigin(r),i=this._getStrategyGenericOptions(e);if(n.SIDEBAR===s)return t=this._getOptionsForSidebarDropStrategy(i,a),this.presentationSidebarToCanvasDropStrategyFactory.create(t);if(n.CANVAS===s)return t=this._getOptionsForCanvasDropStrategy(i,a),this.presentationCanvasDropStrategyFactory.create(t);throw new Error("Draggable origin not supported: "+s)},_getOptionsForSidebarDropStrategy:function(e,t){var r=e.items,n=t.accepts;return a.extend({},e,{areResourcesReferencedByDataIsland:this.presentationCanvasDroppableItemsService.areResourcesReferencedByDataIsland(r),areResourcesLocatedUnderAJoinTree:this.presentationCanvasDroppableItemsService.areResourcesLocatedUnderAJoinTree(r),isConstantGroupCalcFieldsAreDropped:this.presentationCanvasDroppableItemsService.isConstantGroupCalcFieldsAreDropped(r),isAcceptsSetsOrFields:this.presentationCanvasDroppableItemsService.isDropZoneAcceptsSetsAndFields(n)})},_getOptionsForCanvasDropStrategy:function(e,t){var r=e.items,n=t.accepts;return a.extend({},e,{isDataIslandsBeingDropped:this.presentationCanvasDroppableItemsService.isDataIslandsBeingDropped(r),isAcceptsDataIslands:this.presentationCanvasDroppableItemsService.isDropZoneAcceptsDataIslands(n),isAcceptsSetsOrFields:this.presentationCanvasDroppableItemsService.isDropZoneAcceptsSetsAndFields(n)})},_getStrategyGenericOptions:function(e){var t=e.dropZoneModel;return{items:e.items,isMiddleDropZone:t.which===s.MIDDLE,targetId:t.ownerId,targetParentId:t.parentId,position:t.index}},_getDraggableOrigin:function(e){return a.first(e).origin}}),r.exports=i});