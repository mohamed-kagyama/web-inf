/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../../../../../model/schema/util/entityUtil","../../../../../common/mixin/draggable/lazyDraggableMixin"],function(e,t,a){var r=e("underscore"),i=e("../../../../../../model/schema/util/entityUtil"),n=e("../../../../../common/mixin/draggable/lazyDraggableMixin"),o=function(e){this.initialize(e)};r.extend(o.prototype,{draggable:{selector:"li",scroll:!1,containment:"body",onDragStart:"onDragStart",onDrag:"onDrag",onDragStop:"onDragStop",shouldBeDraggable:"shouldBeDraggable",attrs:["id"]},initialize:function(e){this.$el=e.el,this.presentationDesignerEventBus=e.presentationDesignerEventBus,this.sidebarTreeModel=e.sidebarTreeModel,this.presentationSidebarOnDragStartOptionsFactory=e.presentationSidebarOnDragStartOptionsFactory,this.presentationSidebarDraggableLabelFactory=e.presentationSidebarDraggableLabelFactory,this.presentationSidebarDraggableDataFactory=e.presentationSidebarDraggableDataFactory,this._initializeDraggable&&this._initializeDraggable()},shouldBeDraggable:function(e){return e=this._getResource(e),!i.isConstantGroup(e.type)},onDrag:function(e,t,a){this.presentationDesignerEventBus.trigger("sidebar:drag",a)},onDragStart:function(e,t){e=this._getResource(e);var a=this.presentationSidebarOnDragStartOptionsFactory.getOptions({event:t,item:e}),r=this._getDraggableLabel(a),i=this._getSelectionData(a);return this.presentationDesignerEventBus.trigger("sidebar:dragStart",e,a),{label:r,data:i}},onDragStop:function(e){this.presentationDesignerEventBus.trigger("sidebar:dragStop",this._getResource(e))},_getDraggableLabel:function(e){return this.presentationSidebarDraggableLabelFactory.getDraggableLabel(e)},_getSelectionData:function(e){return this.presentationSidebarDraggableDataFactory.getDraggableData(e)},_getResource:function(e){return e=this.sidebarTreeModel.getNode(e.id),e.resource}},n),a.exports=o});