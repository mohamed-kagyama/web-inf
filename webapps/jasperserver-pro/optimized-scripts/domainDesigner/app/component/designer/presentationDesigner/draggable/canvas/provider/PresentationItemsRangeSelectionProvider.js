/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore"],function(e,t,n){var i=e("underscore"),r=function(e){this.initialize(e)};i.extend(r.prototype,{initialize:function(e){this.presentationDesignerViewStateModelService=e.presentationDesignerViewStateModelService,this.clientDomainSchemaService=e.clientDomainSchemaService},getRangeSelectionByLastSelectedItem:function(e){var t=e.parentId,n=this.presentationDesignerViewStateModelService.getPresentationItemsRangeSelectionStartItem();if(!n)throw new Error("Range selection start item is undefined");var i=this._getSelectionRange(n,e),r=this.clientDomainSchemaService.getPresentationItemsInRangeOnLevel({levelId:t,start:i.start,end:i.end}),a=this._getItemsForSelection({range:i,presentationItems:r,rangeSelectionStartItem:n});return this.presentationDesignerViewStateModelService.getNewPresentationItemsSelection(a,{parentId:t})},_getSelectionRange:function(e,t){return{start:Math.min(e.index,t.index),end:Math.max(e.index,t.index)}},_getItemsForSelection:function(e){var t=e.range,n=e.presentationItems,r=e.rangeSelectionStartItem;return i.map(n,function(e,n){var a=t.start+n,o=i.extend({index:a},i.pick(e,["id","type","parentId","dataIslandId"]));return r.index===a&&(o.rangeSelectionStartItem=!0),o})}}),n.exports=r});