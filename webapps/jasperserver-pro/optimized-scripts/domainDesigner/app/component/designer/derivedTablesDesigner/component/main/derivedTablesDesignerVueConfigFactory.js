/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","bundle!DomainDesignerBundle","runtime_dependencies/js-sdk/src/common/util/i18nMessage","../../../../../common/vue/computed/i18nComputed","../../enum/queryRunningSourceEnum","text!./template/derivedTablesDesignerTemplate.htm"],function(e,i,n){var t=e("underscore"),r=e("bundle!DomainDesignerBundle"),s=e("runtime_dependencies/js-sdk/src/common/util/i18nMessage"),d=e("../../../../../common/vue/computed/i18nComputed"),u=e("../../enum/queryRunningSourceEnum"),o=e("text!./template/derivedTablesDesignerTemplate.htm"),a=s.create(r);n.exports={create:function(e){return e=e||{},{template:o,components:{virtualData:e.VirtualData},computed:t.extend({isCreateOrUpdateTableInProgress:function(){return this.isQueryRunning&&this.queryRunningSource===u.CREATE_OR_UPDATE_DERIVED_TABLE},isRunQueryInProgress:function(){return this.isQueryRunning&&this.queryRunningSource===u.RUN_QUERY},isCreateOrUpdateButtonDisabled:function(){return t.isEmpty(this.query)||this.isRunQueryInProgress||t.isEmpty(this.selection.fields)&&!t.isEmpty(this.queryAfterPreviousExecution)},isRunQueryDisabled:function(){return t.isEmpty(this.query)||this.isCreateOrUpdateTableInProgress},selectedFields:function(){return t.reduce(this.selection.fields,function(e,i,n){return e[n]=!0,e},{})},virtualDataStyleObject:function(){return{height:this.queryResultSetHeight+"px",overflowY:"auto",width:"100%"}},tableNameErrorMessageStyle:function(){return this.tableNameErrorMessage?{}:{visibility:"hidden"}},queryErrorMessageStyle:function(){return this.queryErrorMessage?{}:{visibility:"hidden"}},cancelCreateOrUpdateButtonLabel:function(){return a(this.id?"domain.designer.dialog.cancel.update":"domain.designer.dialog.cancel.creation")},isCreateOrUpdateTableInProgressLabel:function(){return a(this.id?"domain.designer.dialog.updating":"domain.designer.dialog.creating")},derivedTableDesignerTitleText:function(){return a(this.id?"domain.designer.derivedTables.createDerivedTables.dialog.title.edit":"domain.designer.derivedTables.createDerivedTables.dialog.title.new")}},d),methods:{onCreateDerivedTable:function(){this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:createDerivedTable")},onUpdateDerivedTable:function(){this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:updateDerivedTable")},onRunQuery:function(){this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:runQuery")},onCancelQuery:function(){this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:cancelQuery")},onCancel:function(){this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:cancel")},selectField:function(e,i){this.isQueryRunning||i.shiftKey||i.ctrlKey||i.metaKey||this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:selectField",e)},toggleFieldSelection:function(e,i){this.isQueryRunning||this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:toggleFieldSelection",e)},addToRangeSelection:function(e,i){this.isQueryRunning||this.$options.derivedTablesDesignerEventBus.trigger("derivedTablesDesignerView:addToRangeSelection",e)}}}}}});