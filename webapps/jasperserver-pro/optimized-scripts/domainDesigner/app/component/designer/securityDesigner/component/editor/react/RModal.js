/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","react","react-dom","bundle!DomainDesignerBundle"],function(e,t,o){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,o){return t&&i(e.prototype,t),o&&i(e,o),e}function u(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?s(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var f=e("react"),v=e("react-dom"),m=e("bundle!DomainDesignerBundle"),g=30,h=function(e){function t(e){var o;return r(this,t),o=u(this,l(t).call(this,e)),d(s(o),"overlayDiv",void 0),d(s(o),"modalDiv",void 0),d(s(o),"state",{top:0,left:0,dragging:!1,lastPosition:{x:0,y:0}}),d(s(o),"componentDidMount",function(){o.updateModalRect(),window.addEventListener("mousemove",o.onMouseMove),window.addEventListener("mouseup",o.onMouseUp)}),d(s(o),"componentDidUpdate",function(e){o.modalDiv.current&&o.props.open&&o.props.open!==e.open&&o.updateModalRect()}),d(s(o),"updateModalRect",function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(o.overlayDiv.current&&o.modalDiv.current){var t=o.overlayDiv.current.getBoundingClientRect(),n=o.modalDiv.current.getBoundingClientRect();if(e)return void o.setState({top:(t.height-n.height)/2,left:(t.width-n.width)/2});var r=o.state,i=r.top,a=r.left;i>t.height&&(i=t.height-g),a>t.width&&(a=t.width-g),o.setState({left:a,top:i})}}),d(s(o),"onMouseDown",function(e){o.stopEventPropagation(e),o.setState({dragging:!0,lastPosition:{x:e.pageX,y:e.pageY}})}),d(s(o),"onMouseMove",function(e){if(o.state.dragging){o.stopEventPropagation(e);var t=o.state.lastPosition,n={x:e.pageX-t.x,y:e.pageY-t.y};n=o.moveOf(n),o.setState({lastPosition:{x:t.x+n.x,y:t.y+n.y}})}}),d(s(o),"onMouseUp",function(e){o.setState({dragging:!1}),o.stopEventPropagation(e)}),d(s(o),"moveOf",function(e){if(0===e.x&&0===e.y)return e;var t=o.overlayDiv.current.getBoundingClientRect(),n=o.modalDiv.current.getBoundingClientRect(),r=t.height,i=t.width,a=o.state,u=a.left,l=a.top,s=Math.max(-n.width+g,Math.min(u+e.x,i-g)),c=Math.max(0,Math.min(l+e.y,r-g)),p={x:s-u,y:c-l};return o.setState({top:c,left:s}),p}),d(s(o),"stopEventPropagation",function(e){e.stopPropagation(),e.preventDefault()}),o.overlayDiv=f.createRef(),o.modalDiv=f.createRef(),o}return c(t,e),a(t,[{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)}},{key:"render",value:function(){var e=void 0!==this.props.width?this.props.width:500;return this.props.open?v.createPortal(f.createElement("div",{className:"jr-mOverlay jr",style:{zIndex:4e3,display:"block",overflow:"hidden"},ref:this.overlayDiv},f.createElement("div",{className:"jr-mDialog jr-mDialogModal jr jr-mDialogWarning",style:{position:"absolute",top:this.state.top,left:this.state.left,width:e},ref:this.modalDiv},f.createElement("div",{className:"jr-mDialog-header jr",onMouseDown:this.onMouseDown},f.createElement("h1",{className:"jr-mDialog-header-title jr"},m["domain.designer.dialog.title.warning"])),this.props.children)),document.body):null}}]),t}(f.Component);o.exports=h});