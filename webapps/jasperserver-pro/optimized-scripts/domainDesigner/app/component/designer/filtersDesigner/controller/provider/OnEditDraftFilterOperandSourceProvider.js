/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../../../../../model/schema/enum/schemaEntitiesEnum","../../../../../../model/schema/util/entityUtil","../../util/filterTypeUtil","../../util/filterOperandTypeUtil"],function(e,i,t){var r=e("underscore"),o=e("../../../../../../model/schema/enum/schemaEntitiesEnum"),l=e("../../../../../../model/schema/util/entityUtil"),n=e("../../util/filterTypeUtil"),u=e("../../util/filterOperandTypeUtil"),c=function(e){this.initialize(e)};r.extend(c.prototype,{initialize:function(e){this.clientDomainSchemaService=e.clientDomainSchemaService},getSource:function(e,i){var t=e.expression,r=t.left,o=t.right;return n.isFieldToFieldFilter(r.type,o.type)?this._getFieldToFieldFilterSource(e,i):this._getFieldToValueFilterSource(r)},_getFieldToFieldFilterSource:function(e,i){var t=e.expression,r=t[i];if(l.isJoinTree(e.sourceType))return{sourceId:r.sourceId,sourceType:r.sourceType};var o=this._getAnyVariable(e);return this._getFieldToValueFilterSource(o)},_getAnyVariable:function(e){var i=e.expression,t=i.left,r=i.right;return u.isVariable(t.type)&&!l.isConstantGroup(t.sourceType)?t:r},_getFieldToValueFilterSource:function(e){var i=e.sourceId,t=this.clientDomainSchemaService.getJoinAliasIdByTableReferenceId(i);return t?{sourceId:t,sourceType:o.JOIN_ALIAS}:{sourceId:e.sourceId,sourceType:e.sourceType}}}),t.exports=c});