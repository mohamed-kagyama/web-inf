/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../../../../common/mixin/draggable/lazyDraggableMixin"],function(e,r,i){var a=e("underscore"),n=e("../../../../../common/mixin/draggable/lazyDraggableMixin"),t=function(e){this.initialize(e)};a.extend(t.prototype,{draggable:{selector:"li",scroll:!1,containment:"body",onDragStart:"onDragStart",onDrag:"onDrag",onDragStop:"onDragStop",shouldBeDraggable:"shouldBeDraggable",attrs:["id"]},initialize:function(e){this.$el=e.el,this.sidebarTreeModel=e.sidebarTreeModel,this.joinsDesignerEventBus=e.joinsDesignerEventBus,this.joinsDesignerSidebarIsItemDraggableSpecification=e.joinsDesignerSidebarIsItemDraggableSpecification,this._initializeDraggable&&this._initializeDraggable()},shouldBeDraggable:function(e){var r=this.sidebarTreeModel.getNode(e.id);return this.joinsDesignerSidebarIsItemDraggableSpecification.isSatisfiedBy(r.resource)},onDragStart:function(e){var r=this.sidebarTreeModel.getNode(e.id);this.joinsDesignerEventBus.trigger("sidebar:selectItem",r.resource);var i=this._getDropItem(r.resource);return{label:i.label,data:i}},onDrag:function(e,r,i){this.joinsDesignerEventBus.trigger("sidebar:drag",i)},onDragStop:function(){this.joinsDesignerEventBus.trigger("sidebar:dragStop")},_getDropItem:function(e){return{label:e.name,id:e.id,resource:{id:e.resourceId,type:e.type,parentTableReferenceId:e.parentTableReferenceId,parentTableReferenceName:e.parentTableReferenceName,parentJoinTreeId:e.parentJoinTreeId}}}},n),i.exports=t});