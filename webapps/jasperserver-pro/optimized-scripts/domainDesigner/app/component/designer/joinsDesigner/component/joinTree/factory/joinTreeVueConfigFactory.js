/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","text!../template/joinTreeVueTemplate.htm","../../../../../../common/vue/computed/i18nComputed","../../../../../../common/component/enum/placementsEnum","../../../../../../common/component/enum/messageTypesEnum","../../../../../../../model/schema/util/entityUtil"],function(e,n,o){var i=e("underscore"),t=e("text!../template/joinTreeVueTemplate.htm"),r=e("../../../../../../common/vue/computed/i18nComputed"),s=e("../../../../../../common/component/enum/placementsEnum"),a=e("../../../../../../common/component/enum/messageTypesEnum"),m=e("../../../../../../../model/schema/util/entityUtil");o.exports={create:function(e){var n=e.Join,o=e.JoinExpression,u=e.ConstantJoinExpression,p=e.ComplexJoinHeader,l=e.ComplexJoinExpression,c=e.JoinAlias,d=e.JoinConstructor,T=e.tooltipDirective,x=e.tooltipOffset,J=e.lazyDroppableDirective,f=e.lazyDraggableDirective,h=e.clickMenuDirective,j=e.joinTreeMenuOptionsFactory;return{template:t,mixins:e.mixins,directives:{clickMenu:h,tooltip:T,droppable:J,draggable:f},data:function(){return{isHovered:!1}},components:{join:n,joinExpression:o,constantJoinExpression:u,complexJoinHeader:p,complexJoinExpression:l,joinAlias:c,joinConstructor:d},computed:i.extend({models:function(){return this.joinTree.children},joinTreeMenuOptions:function(){return j.create(this.joinTree)},tooltipOptions:function(){return{content:{text:this.joinTree.isValid?"":this.i18n["domain.validation.joinTree.invalid.message"],label:this.i18n["domain.validation.joinTree.invalid.title"]},offset:{top:x},placement:s.BOTTOM_LEFT,type:a.ERROR}},droppableConfig:function(){return{drop:this.drop,over:this.over,out:this.out,tolerance:"pointer",test:this.shouldBeDroppable}},draggableConfig:function(){return{getData:this.getDraggableData,tolerance:"pointer",handle:".jr-jJoinTreeDraggableHandle"}}},r),props:["joinTree"],methods:{isJoin:function(e){return m.isJoin(e)},isJoinExpression:function(e){return m.isJoinExpression(e)},isConstantJoinExpression:function(e){return m.isConstantJoinExpression(e)},isComplexJoin:function(e){return m.isComplexJoin(e)},isJoinAlias:function(e){return m.isJoinAlias(e)},isJoinConstructor:function(e){return e.isJoinConstructor},getDraggableData:function(){return{label:this.joinTree.name,resource:{id:this.joinTree.id,index:this.joinTree.index,name:this.joinTree.name,type:this.joinTree.modelType,isDraftJoinTree:this.joinTree.isDraftJoinTree}}}}}}}});