/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","backbone","./enum/validationStateNameEnum"],function(i,t,n){var a=i("underscore"),e=i("backbone"),o=i("./enum/validationStateNameEnum"),r=function(i){this.initialize(i)};a.extend(r.prototype,e.Events,{initialize:function(i){this.validationEventBus=i.validationEventBus,this.validationWarningDialog=i.validationWarningDialog,this.validationWarningDialogStore=i.validationWarningDialogStore,this.domainInitialStateSecurityFileErrorWarningDialogStateFactory=i.domainInitialStateSecurityFileErrorWarningDialogStateFactory,this.securityFileErrorsConverter=i.securityFileErrorsConverter},enter:function(i,t){var n=this._getWarningDialogState(i);this.listenTo(this.validationEventBus,n.confirmEvent,a.bind(this._onConfirmOptionClicked,this,i,t)),this.listenTo(this.validationEventBus,n.rejectEvent,a.bind(this._goToPreviousLocationOrStayInDesigner,this,i,t)),this.validationWarningDialogStore.set(n),this.validationWarningDialog.open()},_getWarningDialogState:function(i){var t=this.securityFileErrorsConverter.convert(i.errors),n=this.domainInitialStateSecurityFileErrorWarningDialogStateFactory.create();return n.warnings=n.warnings.concat(t),n},_cleanUpDialog:function(){this.stopListening(this.validationEventBus),this.validationWarningDialog.close()},_onConfirmOptionClicked:function(i,t){this._cleanUpDialog(),t.enter(o.DOMAIN_DESIGNER_INITIAL_STATE_INITIALIZE_DESIGNER_STATE_AFTER_RECOVERABLE_ERROR_STATE,i)},_goToPreviousLocationOrStayInDesigner:function(i,t){this._cleanUpDialog(),t.enter(o.GOTO_PREVIOUS_LOCATION_OR_STAY_IN_DESIGNER_STATE,i)}}),n.exports=r});