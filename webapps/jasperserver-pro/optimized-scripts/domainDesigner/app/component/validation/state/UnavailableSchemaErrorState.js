/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","backbone","bundle!DomainDesignerBundle","runtime_dependencies/js-sdk/src/common/util/i18nMessage","./enum/validationStateNameEnum"],function(e,a,i){var t=e("underscore"),r=e("backbone"),o=e("bundle!DomainDesignerBundle"),n=e("runtime_dependencies/js-sdk/src/common/util/i18nMessage"),s=e("./enum/validationStateNameEnum"),l=n.create(o),c=function(e){this.initialize(e)};t.extend(c.prototype,r.Events,{initialize:function(e){this.validationErrorDialogStore=e.validationErrorDialogStore,this.unavailableSchemasErrorDialogStateFactory=e.unavailableSchemasErrorDialogStateFactory,this.domainMapSchemaUnavailableSchemaErrorToErrorParametersConverter=e.domainMapSchemaUnavailableSchemaErrorToErrorParametersConverter,this.validationEventBus=e.validationEventBus},enter:function(e,a){var i=[{category:l("domain.designer.error.dialog.schema.map.schemas"),errorParameters:this.domainMapSchemaUnavailableSchemaErrorToErrorParametersConverter.convert(e.unavailableSchemaError)}],r=t.extend({},this.unavailableSchemasErrorDialogStateFactory.create(i),{show:!0});this._subscribeToDialogEvents(e,a,r),this.validationErrorDialogStore.setState(r)},_subscribeToDialogEvents:function(e,a,i){this.listenTo(this.validationEventBus,i.confirmEvent,t.bind(this._mapSchemas,this,e,a)),this.listenTo(this.validationEventBus,i.rejectEvent,t.bind(this._goToPreviousLocationOrStateInDesigner,this,e,a))},_mapSchemas:function(e,a){this._closeDialog(),a.enter(s.MAP_SCHEMAS_STATE,e)},_closeDialog:function(){this.stopListening(this.validationEventBus),this.validationErrorDialogStore.set("show",!1)},_goToPreviousLocationOrStateInDesigner:function(e,a){this._closeDialog(),a.enter(s.GOTO_PREVIOUS_LOCATION_OR_STAY_IN_DESIGNER_STATE,e)}}),i.exports=c});