/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","backbone","./enum/validationStateNameEnum"],function(t,r,e){var i=t("underscore"),o=t("backbone"),a=t("./enum/validationStateNameEnum"),n=function(t){this.initialize(t)};i.extend(n.prototype,o.Events,{initialize:function(t){this.validationEventBus=t.validationEventBus,this.validationErrorDialogStore=t.validationErrorDialogStore,this.unrecoverableErrorDialogStateFactoryFactory=t.unrecoverableErrorDialogStateFactoryFactory,this.unrecoverableErrorsConverterFactory=t.unrecoverableErrorsConverterFactory,this.dropRecoverableErrorsFilterFactory=t.dropRecoverableErrorsFilterFactory},enter:function(t,r){var e=this.dropRecoverableErrorsFilterFactory.create(t.initialState),o=e.filter(t.errors),a=this.unrecoverableErrorsConverterFactory.create(t.initialState),n=a.convert(o,t),s=this.unrecoverableErrorDialogStateFactoryFactory.create(t.initialState),c=i.extend({},s.create(n),{show:!0});this._initEvents(t,r,c),this.validationErrorDialogStore.setState(c)},_initEvents:function(t,r,e){this.listenTo(this.validationEventBus,e.confirmEvent,i.bind(this._goToPreviousLocationOrStayInDesigner,this,t,r)),this.listenTo(this.validationEventBus,e.rejectEvent,i.bind(this._goToPreviousLocationOrStayInDesigner,this,t,r))},_goToPreviousLocationOrStayInDesigner:function(t,r){this.stopListening(this.validationEventBus),this.validationErrorDialogStore.set("show",!1),r.enter(a.GOTO_PREVIOUS_LOCATION_OR_STAY_IN_DESIGNER_STATE,t)}}),e.exports=n});