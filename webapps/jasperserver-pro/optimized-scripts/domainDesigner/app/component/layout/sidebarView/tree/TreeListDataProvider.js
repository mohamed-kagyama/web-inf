/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","../../../../util/uriUtil"],function(e,t,s){var i=e("underscore"),r=e("../../../../util/uriUtil"),o=function(e){this.initialize(e)};i.extend(o.prototype,{initialize:function(e){i.bindAll(this,"getData"),this.cachedList=[],this.nestedTreeModel=e.nestedTreeModel,this.schemaToNestedTreeModelConverter=e.schemaToNestedTreeModelConverter},setState:function(e){this.dataStore=e.dataStore,this.setNeedToConvert(!0)},getData:function(e){var t;return t=this._getTreeModelElementsAsAList(e),{items:t.slice(e.offset,e.offset+e.limit),total:t.length}},setNeedToConvert:function(e){this.needToConvertSchema=e},_convertSchemaToTreeStructureIfNecessary:function(){var e;e=this.schemaToNestedTreeModelConverter.convert({schema:this.dataStore}),this.nestedTreeModel.reset(e),this.setNeedToConvert(!1)},_getTreeModelElementsAsAList:function(){if(!this.needToConvertSchema)return this.cachedList;this._convertSchemaToTreeStructureIfNecessary();var e=r.getSeparator(),t=this.nestedTreeModel.visit([],{accept:function(t,s,i){var r=e+s.join(e),o=e+s.slice(0,s.length-1).join(e);return t.expanded&&i.paths[o]&&(i.paths[r]=!0),i.paths[o]},visit:function(e,t,s){s.list.push(i.omit(e,"elements"))}},{list:[],paths:{"/":!0}}).list;return this.cachedList=t,t}}),s.exports=o});