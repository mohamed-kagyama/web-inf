/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","backbone","../../../enum/saveMethodEnum","../../../../common/util/storeChangeEventCallbackExecutorUtil","../../../validation/state/enum/validationStateNameEnum"],function(t,e,n){var o=t("underscore"),i=t("backbone"),s=t("../../../enum/saveMethodEnum"),a=t("../../../../common/util/storeChangeEventCallbackExecutorUtil"),h=t("../../../validation/state/enum/validationStateNameEnum"),l=function(t){this.initialize(t)};o.extend(l.prototype,i.Events,{initialize:function(t){this.clientDomainSchemaService=t.clientDomainSchemaService,this.applicationDispatcherEventBus=t.applicationDispatcherEventBus,this.applicationCrossComponentEventBus=t.applicationCrossComponentEventBus,this.storeChangeEventBus=t.storeChangeEventBus,this.historyModel=t.historyModel,this.menuEventBus=t.menuEventBus,this.menuStore=t.menuStore,this.validationStateFactory=t.validationStateFactory,this.schemaIsIntegralAndCompleteSpecification=t.schemaIsIntegralAndCompleteSpecification,this._initEvents()},_initEvents:function(){var t=a.getExecutor(this);this.listenTo(this.storeChangeEventBus,"change",t),this.listenTo(this.storeChangeEventBus,"change",this._onSchemaChange),this.listenTo(this.menuEventBus,"save",this._onSave),this.listenTo(this.menuEventBus,"saveAs",this._onSaveAs),this.listenTo(this.menuEventBus,"downloadSchemaJson",this._onDownloadSchemaJson),this.listenTo(this.menuEventBus,"downloadSchemaXml",this._onDownloadSchemaXml),this.listenTo(this.menuEventBus,"uploadSchema",this._onUploadSchema),this.listenTo(this.menuEventBus,"redo",this._onRedo),this.listenTo(this.menuEventBus,"undo",this._onUndo),this.listenTo(this.menuEventBus,"undo:all",this._onUndoAll)},_onDownloadSchemaJson:function(){this.applicationCrossComponentEventBus.trigger("schema:json:download")},_onDownloadSchemaXml:function(){this.applicationCrossComponentEventBus.trigger("schema:xml:download")},_onUploadSchema:function(){this.applicationCrossComponentEventBus.trigger("schema:upload")},_onSave:function(){this.validationStateFactory.enter(h.SAVE_DOMAIN_INITIAL_VALIDATION_STATE,{saveMethod:s.SAVE})},_onSaveAs:function(){this.validationStateFactory.enter(h.SAVE_DOMAIN_INITIAL_VALIDATION_STATE,{saveMethod:s.SAVE_AS})},_onUndo:function(){this.historyModel.undo()},_onUndoAll:function(){this.historyModel.undoAll()},_onRedo:function(){this.historyModel.redo()},_onSchemaChange:function(){this.menuStore.set({undo:this.historyModel.isUndoAvailable(),redo:this.historyModel.isRedoAvailable(),isSaveEnabled:this.schemaIsIntegralAndCompleteSpecification.isSatisfied()})}}),n.exports=l});