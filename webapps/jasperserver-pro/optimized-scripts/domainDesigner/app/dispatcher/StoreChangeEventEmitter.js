/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore"],function(e,t,i){var n=e("underscore"),r=function(e){n.bindAll(this,"emitStoreChange"),this.storeChangeEventBus=e.storeChangeEventBus,this.viewState=e.viewState,this.resourceProperties=e.resourceProperties,this.dataStoreProvider=e.dataStoreProvider,this.applicationStateActionsEnum=e.applicationStateActionsEnum};n.extend(r.prototype,{emitStoreChange:function(e,t,i){var n=this._getStateByAction(i),r=this._getEmitEventNameByAction(i);this._emitChangeByAction(r,n,t),this._emitParticularStoreChangeEvents(i,n,t),this._emitChangeStoreEvent(n,t,r)},_emitChangeByAction:function(e,t,i){this.storeChangeEventBus.trigger(e,t,i)},_emitChangeStoreEvent:function(e,t,i){this.storeChangeEventBus.trigger("change",e,t,i)},_emitParticularStoreChangeEvents:function(e,t,i){var n=this.applicationStateActionsEnum[e];n.changes.schema&&this.storeChangeEventBus.trigger("change:schema",t,i),n.changes.viewState&&this.storeChangeEventBus.trigger("change:viewState",t,i),n.changes.resourceProperties&&this.storeChangeEventBus.trigger("change:resourceProperties",t,i)},_getEmitEventNameByAction:function(e){var t=this.applicationStateActionsEnum[e];return t.emitEvent||t.event},_getStateByAction:function(e){return{dataStore:this._getDataStore(),viewState:this._cloneViewState(),resourceProperties:this._cloneResourceProperties()}},_getDataStore:function(){return this.dataStoreProvider.getDataStore()},_cloneViewState:function(){return this.viewState.clone()},_cloneResourceProperties:function(){return n.cloneDeep(this.resourceProperties.toJSON())}}),i.exports=r});