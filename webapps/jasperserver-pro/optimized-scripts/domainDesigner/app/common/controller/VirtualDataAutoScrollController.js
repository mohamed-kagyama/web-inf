/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","jquery","underscore","backbone"],function(t,o,e){function s(t){return l.throttle(function(t){var o,e=this.store.get("scrollPos"),s=this.store.get("height")-this.store.get("canvasHeight");t===n.UP&&(o=e-this.autoScrollStep,o<0&&(o=0),this.store.set("scrollPos",o)),t===n.DOWN&&(o=e+this.autoScrollStep,o>s&&(o=s),this.store.set("scrollPos",o))},t)}var r=t("jquery"),l=t("underscore"),i=t("backbone"),n={UP:"up",DOWN:"down"},a=function(t){this.initialize(t)};l.extend(a.prototype,{initialize:function(t){this.body=t.body||r("body"),this.autoScrollAreaTopOffset=t.autoScrollAreaTopOffset,this.autoScrollAreaBottomOffset=t.autoScrollAreaBottomOffset,this.autoScrollStep=t.autoScrollStep,this.autoScrollTimeout=t.autoScrollTimeout,this.autoScrollIntervalID=null,this.store=t.store,this._scroll=s(t.autoScrollThrottle),this.eventBus=t.eventBus,this.dragEvent=t.dragEvent,this.dragStopEvent=t.dragStopEvent,this._initEvents()},_initEvents:function(){this.listenTo(this.eventBus,this.dragEvent,this._onCanvasDrag),this.listenTo(this.eventBus,this.dragStopEvent,this._onCanvasDragStop)},_onCanvasDrag:function(t){var o,e,s=t.clientY,r=this,l=this.body.height();s<this.autoScrollAreaTopOffset?(o=!0,e=n.UP):s>l-this.autoScrollAreaBottomOffset&&(o=!0,e=n.DOWN),o?this.autoScrollIntervalID||(this.autoScrollIntervalID=setInterval(function(){r._scroll(e)},this.autoScrollTimeout)):this._clearInterval()},_onCanvasDragStop:function(){this._clearInterval()},_clearInterval:function(){this.autoScrollIntervalID&&clearInterval(this.autoScrollIntervalID),this.autoScrollIntervalID=null}},i.Events),e.exports=a});