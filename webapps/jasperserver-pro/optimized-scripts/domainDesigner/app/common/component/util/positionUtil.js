/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","jquery","underscore","../enum/placementsEnum","../enum/placementToOppositePlacementByHeightEnum","../enum/placementToOppositePlacementByWidthEnum","runtime_dependencies/js-sdk/src/common/util/domUtil"],function(t,e,n){function r(t){var e=t[0],n="BODY"===e.tagName,r=e.getBoundingClientRect(),o=window.SVGElement&&e instanceof window.SVGElement,c=n?{top:0,left:0}:o?null:t.offset(),u={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},i=n?{width:d(window).width(),height:d(window).height()}:null;return h.extend({},r,u,i,c)}function o(t,e){var n=t.top-e.top,r=t.left-e.left;return h.extend({},t,{top:n,left:r})}function c(t){var e=t.placement,n=d(t.parentEl),c=d(t.sourceEl),u=d(t.targetEl),i=v.getMargins(c),l=v.getPaddings(c),a=r(n),f=o(r(u),a),p=o(r(c),a),s=f.top-p.top,g=f.left-p.left,m=M[e],h=m.call(null,{targetRect:f,sourceRect:p,sourceMargins:i,sourcePaddings:l,targetSourceTopDifference:s,targetSourceLeftDifference:g});return{top:h.top,left:h.left,sourceRect:p,parentRect:a,targetRect:f}}function u(t){var e=t.placement,n=c(t),r=h.extend(p(n),{placement:e}),o=a(n)?i(e):r.placement;return r=c(h.extend(t,{placement:o})),o=f(r)?l(o):o||r.placement,r=c(h.extend(t,{placement:o})),{top:r.top,left:r.left,placement:o}}function i(t){return T[t]}function l(t){return w[t]}function a(t){var e=t.parentRect,n=t.top,r=t.sourceRect;return e.height<n+r.height||n-r.height<0}function f(t){var e=t.parentRect,n=t.left;return n<e.left||n>e.width}function p(t){return{top:Math.floor(t.top),left:Math.floor(t.left)}}function s(t){var e=t.targetRect,n=t.sourceRect,r=t.sourceMargins;return e.left-r.left+e.width/2-n.width/2}function g(t){var e=t.targetRect,n=t.sourceRect,r=t.sourceMargins;return e.top-r.top+e.height/2-n.height/2}function m(t){var e=t.targetRect,n=t.sourceMargins;return e.top+e.height-n.top}var d=t("jquery"),h=t("underscore"),R=t("../enum/placementsEnum"),T=t("../enum/placementToOppositePlacementByHeightEnum"),w=t("../enum/placementToOppositePlacementByWidthEnum"),v=t("runtime_dependencies/js-sdk/src/common/util/domUtil"),M={};M[R.TOP]=function(t){var e=t.targetRect,n=t.sourceRect;return{top:e.top-n.height,left:s(t)}},M[R.BOTTOM]=function(t){return{top:m(t),left:s(t)}},M[R.LEFT]=function(t){var e=t.sourceRect,n=t.targetRect,r=t.sourceMargins;return{top:g(t),left:n.left-e.width-r.left}},M[R.RIGHT]=function(t){var e=t.targetRect,n=t.sourceMargins;return{top:g(t),left:e.left+e.width-n.left}},M[R.RIGHT_TOP]=function(t){var e=t.targetRect,n=t.sourceMargins;return{top:e.top,left:e.left+e.width-n.left}},M[R.TOP_LEFT]=function(t){var e=t.targetRect,n=t.sourceRect,r=t.sourceMargins;return{top:e.top-n.height-r.top,left:e.left-r.left}},M[R.TOP_RIGHT]=function(t){var e=t.targetRect,n=t.sourceRect,r=t.sourceMargins;return{top:e.top-n.height-r.top,left:e.left+e.width-r.left-n.width}},M[R.BOTTOM_LEFT]=function(t){var e=t.targetRect,n=t.sourceMargins;return{top:m(t),left:e.left-n.left}},M[R.BOTTOM_RIGHT]=function(t){var e=t.targetRect,n=t.sourceRect,r=t.sourceMargins;return{top:m(t),left:e.left+e.width-n.width-r.left}},n.exports={getPlacementWithPosition:u}});