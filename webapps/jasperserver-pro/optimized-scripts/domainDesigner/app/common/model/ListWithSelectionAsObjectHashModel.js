/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","runtime_dependencies/js-sdk/src/components/scalableList/model/trait/addToSelectionModelTrait","runtime_dependencies/js-sdk/src/components/scalableList/model/ListWithSelectionAsObjectHashModel"],function(e,t,s){var i=e("underscore"),o=e("runtime_dependencies/js-sdk/src/components/scalableList/model/trait/addToSelectionModelTrait"),r=e("runtime_dependencies/js-sdk/src/components/scalableList/model/ListWithSelectionAsObjectHashModel");s.exports=r.extend(o).extend({fetch:function(e){if(e=i.extend({top:this.get("bufferStartIndex")||0,bottom:this.get("bufferEndIndex")||this.bufferSize-1},e),e.force||this._isBufferReloadNecessary(e.top,e.bottom)){if(e.top!==this.attributes.bufferStartIndex||e.bottom!==this.attributes.bufferEndIndex){var t=e.top+Math.floor((e.bottom-e.top)/2),s=Math.floor(this.bufferSize/2);this.attributes.bufferStartIndex=Math.max(0,t-s)}this.attributes.bufferEndIndex=this.attributes.bufferStartIndex+this.bufferSize-1,this.getData({offset:this.get("bufferStartIndex"),limit:this.get("bufferEndIndex")-this.get("bufferStartIndex")+1}).done(this._fetchComplete).fail(this.fetchFailed)}else this.afterFetchComplete&&this.afterFetchComplete(this.get("items"),this.get("total"))}})});