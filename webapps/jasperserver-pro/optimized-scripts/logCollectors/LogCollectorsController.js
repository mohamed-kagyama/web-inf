/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","jquery","bundle!all","runtime_dependencies/js-sdk/src/jrs.configs","backbone.marionette","runtime_dependencies/js-sdk/src/common/component/dialog/LoadingDialog","./view/CreateLogCollectorView","./collectionView/LogCollectorCollectionView"],function(e,o,i){var l=e("jquery"),t=e("bundle!all"),n=e("runtime_dependencies/js-sdk/src/jrs.configs"),r=e("backbone.marionette"),c=e("runtime_dependencies/js-sdk/src/common/component/dialog/LoadingDialog"),s=e("./view/CreateLogCollectorView"),a=e("./collectionView/LogCollectorCollectionView");i.exports=r.Application.extend({initialize:function(e){this.options=e,this.$el=l(this.options.container),this.addRegions({LogCollectorRegion:r.Region.extend({el:this.$el})}),this.loadingDialog=new c({content:t["dialog.overlay.loading"]}),this.createLogCollectorView=new s(null,this.options),this.listenTo(this.createLogCollectorView,"logCollectorHasBeenCreated",this.logCollectorHasBeenCreated),this.listenTo(this.createLogCollectorView,"cancelButtonClick",this.creatingFormCancelButtonClick),this.logCollectorCollectionView=new a([],this.options),this.listenTo(this.logCollectorCollectionView,"createNewCollectorClick",this.createNewCollectorClick),this.logCollectorCollectionView.render(),this.LogCollectorRegion.show(this.logCollectorCollectionView,{preventDestroy:!0}),this.logCollectorCollectionView.refreshListOfCollectors()},createNewCollectorClick:function(){this.createLogCollectorView.prepareNewModel(),this.createLogCollectorView.render(),this.LogCollectorRegion.show(this.createLogCollectorView,{preventDestroy:!0}),this.logCollectorCollectionView.removeOverClassOnButtons()},logCollectorHasBeenCreated:function(e){this.logCollectorCollectionView.appendNewlyCreatedLogCollector(e),this.openLoadingDialog();var o=this;this.logCollectorCollectionView.refreshListOfCollectors().done(function(){o.closeLoadingDialog()}),this.LogCollectorRegion.show(this.logCollectorCollectionView,{preventDestroy:!0})},creatingFormCancelButtonClick:function(){this.LogCollectorRegion.show(this.logCollectorCollectionView,{preventDestroy:!0})},setTitle:function(e){l(n.logCollectors.initParams.container+" div.content .title").text(e)},openLoadingDialog:function(e){if(!0!==this.loadingDialogIsOpened){e=e||250;var o=this;this.loadingDialogTimerHandler=setTimeout(function(){o.loadingDialogIsOpened=!0,o.loadingDialog.open()},e)}},closeLoadingDialog:function(){this.loadingDialogTimerHandler&&(clearTimeout(this.loadingDialogTimerHandler),this.loadingDialogTimerHandler=!1),!1!==this.loadingDialogIsOpened&&(this.loadingDialog.close(),this.loadingDialogIsOpened=!1)}})});