/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define("runtime_dependencies/js-sdk/src/common/util/datetime/RelativeDate",["require","exports","module","underscore"],function(e,t,i){var n=e("underscore"),r=function(e,t,i){this.setKeyword(e),this.setSign(t),this.setNumber(i)};r.prototype.setKeyword=function(e){this.keyword=e.toUpperCase()},r.prototype.setSign=function(e){this.sign=e},r.prototype.setNumber=function(e){if(n.isNumber(e))this.number=e;else{var t=parseInt(e,10);isNaN(t)?this.number=0:this.number=t}},r.prototype.toString=function(){return n.isNumber(this.number)&&!isNaN(this.number)&&this.number>0&&("+"===this.sign||"-"===this.sign)&&this.keyword in r.PATTERNS?this.keyword+this.sign+this.number.toString():this.keyword in r.PATTERNS?this.keyword:""},r.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},r.parse=function(e){if(r.isValid(e))for(var t in r.PATTERNS){var i=r.PATTERNS[t].exec(e);if(null!==i&&n.isArray(i)&&5===i.length)return new r(i[1],i[3],i[4])}},r.isValid=function(e){if(e instanceof r)return""!==e.toString();if(n.isString(e))for(var t in r.PATTERNS)if(r.PATTERNS[t].test(e))return!0;return!1},i.exports=r}),define("runtime_dependencies/js-sdk/src/common/util/datetime/RelativeTimestamp",["require","exports","module","./RelativeDate","underscore"],function(e,t,i){var n=e("./RelativeDate"),r=e("underscore"),a=function(){n.apply(this,arguments)},o=function(){};o.prototype=n.prototype,a.prototype=new o,a.prototype.constructor=a,a.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},a.parse=function(e){if(a.isValid(e))for(var t in a.PATTERNS){var i=a.PATTERNS[t].exec(e);if(null!==i&&r.isArray(i)&&5===i.length)return new a(i[1],i[3],i[4])}},a.isValid=function(e){if(e instanceof a)return""!==e.toString();if(r.isString(e))for(var t in a.PATTERNS)if(a.PATTERNS[t].test(e))return!0;return!1},i.exports=a}),define("runtime_dependencies/js-sdk/src/common/util/parse/date",["require","exports","module","momentExtension","../../../jrs.configs","underscore","../datetime/RelativeDate","../datetime/RelativeTimestamp"],function(e,t,i){function n(e){var t=e;return t=e.indexOf("yy")>-1?t.replace("yy","YYYY"):t.replace("y","YY"),e.indexOf("mm")>-1?t=t.replace("mm","MM"):e.indexOf("MM")>-1?t=t.replace("MM","MMMM"):e.indexOf("m")>-1?t=t.replace("m","M"):e.indexOf("M")>-1&&(t=t.replace("M","MMM")),e.indexOf("dd")>-1?t=t.replace("dd","DD"):e.indexOf("DD")>-1?t=t.replace("DD","dddd"):e.indexOf("d")>-1?t=t.replace("d","D"):e.indexOf("D")>-1&&(t=t.replace("D","ddd")),t}function r(e){return e.toUpperCase()}function a(e){return e.toLowerCase().replace("hh","HH")}function o(e){return e.replace("aaa","a")}function s(e,t,i){var r=n(e),o=a(t);return r+(null!=i?i:" ")+o}function d(e,t,i){i=void 0!==i&&i,t=t||" ";var s=e.split(t),d=s[0],l=s.length>1?s[1]:null,u=i?r:n,c=i?o:a;(d.indexOf("h")>0||d.indexOf("H")>0||d.indexOf("s")>0)&&(l=d,d=null);var m="";return d&&(m+=u(d)),l&&(m&&(m+=t),m+=c(l)),m}function l(e){return H(e,n(z.dateFormat),!0)}function u(e){return H(e,s(z.dateFormat,z.timeFormat,z.timestampSeparator),!0)}function c(e){return j.isValid(e)}function m(e){return U.isValid(e)}function h(e){return V.isDate(e)&&H(e).isValid()||V.isString(e)&&""!==e&&l(e).isValid()}function p(e){return V.isDate(e)&&H(e).isValid()||V.isString(e)&&""!==e&&u(e).isValid()}function f(e){return H(e,Q,!0).isValid()}function _(e,t){if(h(e)&&h(t)){return T(V.isDate(e)?H(e):l(e),V.isDate(t)?H(t):l(t))}}function g(e,t){if(p(e)&&p(t)){return T(V.isDate(e)?H(e):u(e),V.isDate(t)?H(t):u(t))}}function T(e,t){return e.isBefore(t)?-1:e.isAfter(t)?1:0}function v(e){var t=H(e);if(V.isDate(e)&&t.isValid())return t.format(Q)}function I(e){var t=H(e,Q,!0);if(t.isValid())return t.toDate()}function N(e){return A(e,s(z.dateFormat,z.timeFormat,z.timestampSeparator),Q)}function b(e){return A(e,Q,s(z.dateFormat,z.timeFormat,z.timestampSeparator))}function y(e){return A(e,n(z.dateFormat),B)}function D(e){return A(e,B,n(z.dateFormat))}function E(e){return A(e,a(z.timeFormat),$)}function C(e){return A(e,$,a(z.timeFormat))}function A(e,t,i){if(j.isValid(e))return e;var n=H(e,t,!0);return n.isValid()?n.format(i):e}function F(e){return H(e,B,!0)}function S(e){return e.format(B)}function M(e){return e.format(n(z.dateFormat))}function O(e,t){var i;return i=t?H.tz(e,t).tz(G):H.utc(e).tz(G),i.format(n(z.dateFormat))}function x(e,t){var i=H.duration(e),n=H.utc();return t&&n.tz(t),n.hours(i.hours()),n.minutes(i.minutes()),n.seconds(i.seconds()),n.tz(G).format(a(z.timeFormat))}function L(e,t){var i;return i=t?H.tz(e,t).tz(G):H.utc(e).tz(G),i.format(s(z.dateFormat,z.timeFormat,z.timestampSeparator))}function w(e,t){e=y(e);var i=H.tz(e,G);return i=t?i.tz(t):i.utc(),i.format(B)}function R(e,t){var i=H.duration(e),n=H.utc(),r=n.tz(G);r.hours(i.hours()),r.minutes(i.minutes()),r.seconds(i.seconds());var a;return a=t?r.tz(t):r.utc(),a.format($)}function P(e,t){e=N(e);var i=H.tz(e,G);return i=t?i.tz(t):i.utc(),i.format(Q)}var H=e("momentExtension"),k=e("../../../jrs.configs"),V=e("underscore"),j=e("../datetime/RelativeDate"),U=e("../datetime/RelativeTimestamp"),z=k.localeSettings,G=k.userTimezone,Q="YYYY-MM-DD[T]HH:mm:ss",B="YYYY-MM-DD",$="HH:mm:ss";i.exports={isRelativeDate:c,isRelativeTimestamp:m,isDate:h,isTimestamp:p,isIso8601Timestamp:f,compareDates:_,compareTimestamps:g,iso8601DateToMoment:F,momentToIso8601Date:S,momentToLocalizedDate:M,dateObjectToIso8601Timestamp:v,iso8601TimestampToDateObject:I,localizedTimestampToIsoTimestamp:N,isoTimestampToLocalizedTimestamp:b,localizedDateToIsoDate:y,isoDateToLocalizedDate:D,localizedTimeToIsoTime:E,isoTimeToLocalizedTime:C,toMomentDateOrTimeOrTimestampPattern:d,isoDateToLocalizedDateByTimezone:O,localizedDateToIsoDateByTimezone:w,isoTimeToLocalizedTimeByTimezone:x,localizedTimeToIsoTimeByTimezone:R,isoTimestampToLocalizedTimestampByTimezone:L,localizedTimestampToIsoTimestampByTimezone:P}}),define("runtime_dependencies/js-sdk/src/common/util/parse/NumberUtils",["require","exports","module","underscore"],function(e,t,i){var n=e("underscore"),r=function(e){function t(e){return"."===e?e="\\.":" "===e&&(e="\\s"),e}e=e||{},this.DECIMAL_SEPARATOR=e.decimalSeparator||".",this.GROUPING_SEPARATOR=e.groupingSeparator||",",this.decimalSeparator=t(this.DECIMAL_SEPARATOR),this.groupingSeparator=t(this.GROUPING_SEPARATOR),this.DECIMAL_NUMBER_PATTERN=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+this.groupingSeparator+"[0-9]{3})*("+this.decimalSeparator+"[0-9]+)?|[1-9]{1}[0-9]{0,}("+this.decimalSeparator+"[0-9]+)?|0("+this.decimalSeparator+"[0-9]+)?)$"),this.INTEGER_NUMBER_PATTERN=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+this.groupingSeparator+"[0-9]{3})*|[1-9]{1}[0-9]{0,}|0)$")},a=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER+1:9007199254740992,o=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER-1:-9007199254740992;r.prototype.number_format=function(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,a=isFinite(+t)?Math.abs(t):0,o=void 0===n?",":n,s=void 0===i?".":i,d=(a?function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)}(r,a):""+Math.round(r)).split(".");return d[0].length>3&&(d[0]=d[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,o)),(d[1]||"").length<a&&(d[1]=d[1]||"",d[1]+=new Array(a-d[1].length+1).join("0")),d.join(s)},r.prototype.isInt=function(e){return this.isNumberInt(e)||this.isStringInt(e)},r.prototype.isNumberInt=function(e){return n.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY&&(e===+e&&e===(0|e)||e%1==0)},r.prototype.isStringInt=function(e){return n.isString(e)&&this.INTEGER_NUMBER_PATTERN.test(e)},r.prototype.isInt32=function(e){return this.isInt(e)&&this.parseNumber(e)>=-2147483648&&this.parseNumber(e)<=2147483647},r.prototype.isDecimal=function(e){return n.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY||n.isString(e)&&this.DECIMAL_NUMBER_PATTERN.test(e)},r.prototype.parseNumber=function(e){if(n.isNumber(e))return e;if(n.isString(e)&&this.DECIMAL_NUMBER_PATTERN.test(e)){e=e.replace(new RegExp(this.groupingSeparator,"g"),"").replace(new RegExp(this.decimalSeparator,"g"),".");var t=1*e;return t>=a||t<=o?(window.console&&window.console.warn(e+" is out of the ["+(o+1)+", "+(a-1)+"] bounds. Parsing results may be corrupted. Use string representation instead. For more details see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number."),!1):t}},r.prototype.formatNumber=function(e,t){t=t||{};var i=e.toString().split(".")[1],r=i?i.length:0;n.isUndefined(t.decimalPlacesAmount)||(r=t.decimalPlacesAmount);try{return this.number_format(e,r,t.decimalSeparator||this.DECIMAL_SEPARATOR,t.groupingSeparator||this.GROUPING_SEPARATOR)}catch(t){return e.toString()}},r.prototype.MaxRange=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER+1:9007199254740992,r.prototype.MinRange=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER-1:-9007199254740992,i.exports=r}),define("dataChooser/domain.base",["require","exports","module","prototype","underscore","runtime_dependencies/jrs-ui/src/util/utils.common","runtime_dependencies/jrs-ui/src/core/core.ajax","../core/core.ajax.utils","runtime_dependencies/jrs-ui/src/core/core.events.bis","runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils","runtime_dependencies/js-sdk/src/common/util/xssUtil","runtime_dependencies/js-sdk/src/common/util/parse/date","momentExtension","runtime_dependencies/js-sdk/src/common/util/parse/NumberUtils"],function(e,t,i){var n=e("prototype"),r=n.$,a=n.Template,o=n.$break,s=n.$$,d=e("underscore"),l=e("runtime_dependencies/jrs-ui/src/util/utils.common"),u=l.buildActionUrl,c=l.matchAny,m=l.isSupportsTouch,h=l.deepClone,p=e("runtime_dependencies/jrs-ui/src/core/core.ajax"),f=p.AjaxRequester,_=p.ajaxTargettedUpdate,g=e("../core/core.ajax.utils"),T=g.baseErrorHandler,v=e("runtime_dependencies/jrs-ui/src/core/core.events.bis"),I=e("runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils"),N=e("runtime_dependencies/js-sdk/src/common/util/xssUtil"),b=e("runtime_dependencies/js-sdk/src/common/util/parse/date"),y=e("momentExtension"),D=e("runtime_dependencies/js-sdk/src/common/util/parse/NumberUtils"),E=new D,C={PROPAGATE_EVENT:"propagateEvent",_messages:{},disabledFolderTooltip:"disabledFolderTooltip",attributesPattern:new RegExp("\\s*attribute\\s*\\(\\s*'[^\\/'\\s][^\\/']*'(?:\\s*,\\s*'[^\\/'\\s][^\\/']*')*\\s*\\)\\s*"),getMessage:function(e,t){var i=this._messages[e];return i?new a(i).evaluate(t||{}):""},setMessage:function(e,t){this._messages[e]=t},treeErrorHandler:function(){throw"exception while loading tree"},submitForm:function(e,t,i){if(t){var n=u(t);i&&i(),r(e).writeAttribute("method","post").writeAttribute("action",n),r(e).submit()}},sendAjaxRequest:function(e,t,i,n){var r=u(e),a={postData:Object.toQueryString(t),callback:i,errorHandler:this._serverErrorHandler,mode:f.prototype.EVAL_JSON};n&&Object.extend(a,n),_(r,a)},_serverErrorHandler:function(e,t){return T(e)},elementClicked:function(e,t){return!(!e||!t)&&c(e,[t],!0)},basicClickHandler:function(e,t,i){var n=null;return t.any(function(t){if(n=C.elementClicked(e,t.key))return Object.isFunction(t.value)?t.value(n):Object.isFunction(i)&&i(t.value),!0})},registerClickHandlers:function(e,t,i){if(C._bodyClickEventHandlers)return void(i?Array.prototype.unshift:Array.prototype.push).apply(C._bodyClickEventHandlers,e);C._bodyClickEventHandlers=e,s(t||"body")[0].observe(m()?"touchstart":"click",function(e){var t=e.element();C._bodyClickEventHandlers&&C._bodyClickEventHandlers.each(function(i){var n=i(t);if(n)throw n!==C.PROPAGATE_EVENT&&Event.stop(e),o})})},enableButton:function(e,t){"string"==typeof e&&(e=r(e)),e.disabled=t,t?v.enable(e):v.disable(e)},setOptionsToSelect:function(e,t){if(e&&(e.update(""),t))return t.each(function(t){var i={value:t.value,title:t.label};t.selected&&(i.selected="selected");var n=new Element("option",i);n.appendChild(document.createTextNode(t.label)),e.appendChild(n)}),e},getDataIslandId:function(e,t){var i=I.trees[e.getTreeId()].getRootNode();return function e(t,n){return null===t.parent||t.parent===i?t.param.extra[n]:e(t.parent,n)}(e,t)},areNodesFromSameIsland:function(e,t){return!!e.any(function(e){return e.param.extra.isConstant})||(!(1!==e.pluck("parent").uniq().length)||1===e.map(function(e){return C.getDataIslandId(e,t||"itemId")}).uniq().length)},NumberFormat:function(e,t){var i="."===e,n=new RegExp("["+e.gsub(/\s/,"\\s")+"]+"),r=new RegExp("["+t.gsub(/\s/,"\\s")+"]+"),a=new RegExp("^-|\\"+t+"?\\d+|\\"+t+"$|\\"+e+"+","g");return{toNumber:function(e){return!e||!i&&/[.]/.test(e)?NaN:Number(e.gsub(r,"").gsub(n,"."))||C.attributesPattern.test(e)},normalizeNumberEntry:function(i){var n=i.strip(),r=n.match(C.attributesPattern)||n.match(a);if(!r)return"";for(var o=!1,s=0;s<r.length;s++)r[s].startsWith(e)?o?delete r[s]:(r[s]=e,o=!0):r[s].startsWith(t)&&o&&(r[s]=r[s].substring(1));return r.join("")},isInteger:function(e){return n.test(e)}}},baseValidator:function(e,t){var i=!0,n="";return e()&&(n=t,i=!1),{isValid:i,errorMessage:n}},maxLengthValidator:function(e,t,i){return C.baseValidator(function(e,t){return e.length>t}.curry(e,t),i)},minLengthValidator:function(e,t,i){return C.baseValidator(function(e,t){return e.length<t}.curry(e,t),i)},valueNotEmptyValidator:function(e,t){return C.baseValidator(function(e){return Object.isArray(e)&&0===e.length||!e||!String(e).strip()}.curry(e),t)},stringIdValidator:function(e,t){return C.baseValidator(function(e){return!/^[^0-9() .,'"=!+-\/><\/\/:][^() .,'"=!+-\/><\/\/:]*$/.test(e)}.curry(e),t)},numberValidator:function(e,t,i){return C.baseValidator(isNaN.curry(t.toNumber(e)),i)},numberBoundsValidator:function(e,t,i){return C.baseValidator(function(e,t){return e===E.MinRange||e===E.MaxRange||!(e<=t.max&&e>=t.min)}.curry(e,t),i)},rangeValidator:function(e,t,i){return C.baseValidator(function(e,t){return!(e<t)}.curry(e,t),i)},dateValidator:function(e,t,i,n){return C.baseValidator(function(){var n=b.toMomentDateOrTimeOrTimestampPattern(t,i);return!y(e,n,!0).isValid()&&!C.attributesPattern.test(e)},n)},unescapeTree:function e(t){t.hasChilds()&&d.each(t.childs,function(t){e(t)}),t.name=N.unescape(t.name)}};C.NodeCopyMoveController=function(){},C.NodeCopyMoveController.addMethod("copy",function(e,t,i){if(e&&e.length>0&&t){var n=I.trees[t.getTreeId()],r=e.collect(function(e){var r=e.param.id,a=this._copyParentStructure(e,n);return a?this._mergeToDestTree(a,t,r,i):null}.bind(this));return t.isloaded=!0,r.without(null)}}),C.NodeCopyMoveController.addMethod("copySelected",function(e,t){if(window.sourceTree&&t)return this.copy(window.sourceTree.selectedNodes,t)}),C.NodeCopyMoveController.addMethod("move",function(e,t){if(e&&t){var i=this.copy(e,t);return this.hide(e),i}}),C.NodeCopyMoveController.addMethod("moveSelected",function(e,t){if(e&&t)return this.move(e.selectedNodes,t)}),C.NodeCopyMoveController.addMethod("hide",function(e,t,i){if(e&&e.length>0){t||(t=this._getVisibleChildrenCount),i||(i=function(e,t){e.hide(t)});var n=I.trees[e[0].getTreeId()];e.collect(function(e){return e.id}).each(function(e){var r=I.nodes[e];i(r,!0);for(var a=r.parent;a&&a!=n.getRootNode()&&!(t(a)>0);)i(a,!1),a.refreshStyle(),a=a.parent}.bind(this))}}),C.NodeCopyMoveController.addMethod("_handleDuplicatedNode",function(e,t){return e.param.id}),C.NodeCopyMoveController.addMethod("_markAsLoaded",function(e){e.isloaded=!0,e.isParent()&&e.childs.each(function(e){this._markAsLoaded(e)}.bind(this))}),C.NodeCopyMoveController.addMethod("_mergeToDestTree",function(e,t,i,n){if(t){var r=I.trees[t.getTreeId()];if(n)return i=this._handleDuplicatedNode(e,t),r.findNodeById(i,e);var a=r.findNodeChildByMetaName(t,e.param.id);return null!=a?(a.isHidden()&&a.show(),e.hasChilds()&&(a.disabled&&a.enable(e.tooltip),e.childs.each(function(e){this._mergeToDestTree(e,a)}.bind(this))),r.findNodeById(i,a)):(t.addChild(e),this._markAsLoaded(e),r.findNodeById(i,e))}}),C.NodeCopyMoveController.addMethod("_copyParentStructure",function(e,t){if(e&&t){var i=I.trees[e.getTreeId()];if(e.disabled)return null;for(var n=this._copyNode(e,t,!0),r=e.parent,a=null;r&&r!=i.getRootNode();)a=this._copyNode(r,t,!1),a.addChild(n),n=a,r=r.parent;return n}}),C.NodeCopyMoveController.addMethod("_buildMetanode",function(e){return h(e.param)}),C.NodeCopyMoveController.addMethod("_copyNode",function(e,t,i){if(e&&t){var n=t.processNode(this._buildMetanode(e));i&&(e.hasChilds()?e.childs.each(function(e){if(!e.disabled){var e=this._copyNode(e,t,i);e&&n.addChild(e)}}.bind(this)):n.setHasChilds(!1));var r=e.childs.findAll(function(e){return e.disabled});return e.childs.length>0&&r.length==e.childs.length?null:n}}),C.NodeCopyMoveController.addMethod("_delete",function(e){e&&e.collect(function(e){return e.id}).each(function(e){var t=I.nodes[e];t&&t.parent.removeChild(t)})}),C.NodeCopyMoveController.addMethod("_getVisibleChildrenCount",function(e){var t=e.childs.findAll(function(e){return e.isHidden()});return e.childs.length-t.length}),C.resetTreeSelectionHandler={_COMMON_ELEMENTS_TO_SAVE_SELECTION:["#pageDimmer","#detail","#standardConfirm"],_getTrees:null,_elementIds:null,_callback:null,_validator:null,init:function(e,t,i,n){C.resetTreeSelectionHandler._init.bind(C.resetTreeSelectionHandler,e,t,i,n)()},_init:function(e,t,i,n){this._getTrees=t,this._callback=i,this._validator=n,this._elementIds=this._COMMON_ELEMENTS_TO_SAVE_SELECTION.concat(e),C.registerClickHandlers([this._removeTreeSelectionClickEventHandler.bind(this)],null,!0)},_removeTreeSelectionClickEventHandler:function(e){if(!c(e,this._elementIds,!0)){var t=!1;return this._getTrees().each(function(e){if(e.selectedNodes&&e.selectedNodes.first())throw t=!0,o}),t?!(!this._validator||this._validator())||(this._getTrees().each(function(e){e._deselectAllNodes()}),this._callback&&this._callback(),!1):!1}}},C.NodeChangeOrderController=function(){},C.NodeChangeOrderController.addMethod("findNodeWithSpecificOrder",function(e,t,i){for(var n=e.length-1;n>=0;n--)if(e[n].isSelected()==i&&e[n].orderNumber===t)return e[n];return null}),C.NodeChangeOrderController.addMethod("findMaxSiblingNode",function(e,t,i){var n=null,r=null;return e.each(function(e){e.isSelected()==t&&(null!==n&&i!=e.orderNumber<n||(n=e.orderNumber,r=e))}),r}),C.NodeChangeOrderController.addMethod("moveNode",function(e,t,i,n){var r=e.orderNumber,a=e.parent.childs,o=null,s=null;i?(o=this.findMaxSiblingNode(a,!1,t,e.param.type),s=o?o.orderNumber:-1,a.each(function(i){i.param.id!==e.param.id&&(t==i.orderNumber>s&&t==i.orderNumber<r||i.orderNumber==s)&&(i.orderNumber=t?i.orderNumber+1:i.orderNumber-1,n&&n(i,i.orderNumber))}),n&&n(e,s),e.orderNumber=s):(s=t?e.orderNumber-1:e.orderNumber+1,(o=this.findNodeWithSpecificOrder(a,s,!1))&&(n&&n(e,s),n&&n(o,r),e.orderNumber=s,o.orderNumber=r))}),C.NodeChangeOrderController.addMethod("nodeAscSorter",function(e,t){return e.orderNumber-t.orderNumber}),C.NodeChangeOrderController.addMethod("nodeDescSorter",function(e,t){return t.orderNumber-e.orderNumber}),C.DisplayNodeChangeOrderController=function(){C.NodeChangeOrderController.call()},C.DisplayNodeChangeOrderController.prototype=h(C.NodeChangeOrderController.prototype),C.DisplayNodeChangeOrderController.addMethod("findMaxSiblingNode",function(e,t,i,n){var r=null,a=null;return e.each(function(e){e.isSelected()==t&&(null!==r&&i!=e.orderNumber<r||n&&e.param.type!==n||(r=e.orderNumber,a=e))}),a}),i.exports=C}),define("dataChooser/domain.chooser",["require","exports","module","prototype","underscore","jquery","runtime_dependencies/js-sdk/src/jrs.configs","./domain.base"],function(e,t,i){var n=e("prototype"),r=n.$,a=n.$break,o=n.$H,s=e("underscore"),d=e("jquery"),l=e("runtime_dependencies/js-sdk/src/jrs.configs"),u=e("./domain.base"),c=new RegExp("[\\?&]reportType=([^&#]*)");u.chooser={FLOW_ID:"adhocFlow",FIELDS:"dataChooserFields",DISPLAY:"dataChooserDisplay",SAVE_AS_TOPIC:"dataChooserSaveAsTopic",PRE_FILTERS:"dataChooserPreFilters",submitFormId:"stepDisplayForm",currentPage:null,flowExecutionKey:null,unsavedChangesPresent:!1,initialize:function(e){var t=c.exec(location.search);if(this.reportType=null==t?"":decodeURIComponent(t[1].replace(/\+/g," ")),window.localContext.rsInitOptions){var i=window.localContext.rsInitOptions;this.currentPage=r(document.body).identify(),this.flowExecutionKey=i.flowExecutionKey,this.unsavedChangesPresent=i.unsavedChangesPresent;var n=this.pageInitFactory[this.currentPage]();i=s.extend({},i,e),this.initModule(n,i),u.registerClickHandlers([this.getFlowControlsClickEventHandler()])}},initModule:function(e,t){e&&(e.fillForm&&(m.fillForm=e.fillForm.bind(e)),e.getFlowControlsClickEventHandler&&(m.getFlowControlsClickEventHandler=e.getFlowControlsClickEventHandler.bind(e)),e.init.bind(e)(t))},fillForm:function(){},getFlowControlsClickEventHandler:function(){return m.flowControlsClickEventHandler.bind(m)},flowControlsClickEventHandler:function(e){var t=!1;return this.flowControlsEventMap.each(function(i){if(u.elementClicked(e,i.key)){if(t=!0,i.value.returnOnPage&&this.currentPage===i.value.returnOnPage)throw a;if(i.value.confirmLeave&&!this.confirmAndLeave())throw a;throw delete i.value.returnOnPage,i.value.flowId=this.FLOW_ID,i.value.flowExecutionKey=this.flowExecutionKey,i.value.reportType=this.reportType,l.initAdditionalUIComponents||(i.value.decorate="no"),"cancelRedirect"===i.value.eventId&&d(document).trigger("adhocDesigner:cancel"),u.submitForm(this.submitFormId,i.value,this.fillForm),a}}.bind(this)),t}};var m=u.chooser;m.confirmAndLeave=function(){return!m.unsavedChangesPresent||confirm(u.getMessage("exitMessage"))},m.setUnsavedChangesPresent=function(e){m.unsavedChangesPresent=!!e},m.isUnsavedChangesPresent=function(){return m.unsavedChangesPresent},m.pageInitFactory={dataChooserFields:function(){return u.chooser.fields},dataChooserPreFilters:function(){return u.chooser.preFilters},dataChooserDisplay:function(){return u.chooser.display},dataChooserSaveAsTopic:function(){return u.chooser.saveAsTopic}},m.flowControlsEventMap=o({"#fieldsTab":{returnOnPage:u.chooser.FIELDS,eventId:"fields"},"#filtersTab":{returnOnPage:u.chooser.PRE_FILTERS,eventId:"preFilters"},"#displayTab":{returnOnPage:u.chooser.DISPLAY,eventId:"display"},"#saveTopicTab":{returnOnPage:u.chooser.SAVE_AS_TOPIC,eventId:"saveAsTopic"},"#goToDesigner":{eventId:"done",reportType:m.reportType},"#cancel":{eventId:"cancelRedirect",confirmLeave:!0}}),window.domain=window.domain||{},window.domain.chooser={confirmAndLeave:m.confirmAndLeave},i.exports=m}),define("dataChooser/domain.components",["require","exports","module","prototype","underscore","jquery","./domain.base","runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils","runtime_dependencies/jrs-ui/src/components/list.base","runtime_dependencies/jrs-ui/src/util/utils.common","runtime_dependencies/jrs-ui/src/core/core.layout","runtime_dependencies/jrs-ui/src/core/core.events.bis","runtime_dependencies/js-sdk/src/common/util/xssUtil","runtime_dependencies/jrs-ui/src/components/components.dialogs"],function(e,t,i){var n=e("prototype"),r=n.$,a=n.$$,o=e("underscore"),s=e("jquery"),d=e("./domain.base"),l=e("runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils"),u=e("runtime_dependencies/jrs-ui/src/components/list.base"),c=u.dynamicList,m=e("runtime_dependencies/jrs-ui/src/util/utils.common"),h=m.deepClone,p=e("runtime_dependencies/jrs-ui/src/core/core.layout"),f=e("runtime_dependencies/jrs-ui/src/core/core.events.bis"),_=e("runtime_dependencies/js-sdk/src/common/util/xssUtil"),g=e("runtime_dependencies/jrs-ui/src/components/components.dialogs");d.ItemNode=function(e){l.TreeNode.call(this,e),this.Types={Folder:new l.TreeNode.Type("ItemGroupType"),Leaf:new l.TreeNode.Type("ItemType")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_fields:fields",this._hidden=!1,this.disabled=!1},d.ItemNode.prototype=h(l.TreeNode.prototype),d.ItemNode.addMethod("hide",function(e){if(e&&this.hasChilds())for(var t=0;t<this.getChildCount();t++)this.childs[t].hide(!0);var i=(this.childs.findAll(function(e){return e.disabled}).length,this.childs.findAll(function(e){return e.isHidden()}).length),n=this.childs.length-i;this.disabled||0!==n?this.getType()===this.Types.Leaf&&(this.deselect(),this.disable(d.getMessage(d.disabledFolderTooltip))):(this._hidden=!0,this.deselect(),this.refreshStyle())}),d.ItemNode.addMethod("show",function(){this._hidden=!1,this._getElement()&&this.refreshStyle(this._getElement())}),d.ItemNode.addMethod("disable",function(e){e&&(this.tooltip=e),this.disabled=!0,this._getElement()&&this.refreshStyle(this._getElement())}),d.ItemNode.addMethod("enable",function(e){e&&(this.tooltip=e),this.disabled=!1,this._getElement()&&this.refreshStyle(this._getElement())}),d.ItemNode.addMethod("refreshStyle",function(e){if(e||(e=this._getElement())){l.TreeNode.prototype.refreshStyle.call(this,e),this.isHidden()?e.addClassName(p.HIDDEN_CLASS):e.removeClassName(p.HIDDEN_CLASS);var t=e.select("p").first();t&&(this.tooltip?t.title=this.tooltip:t.title="",this.disabled?(f.disable(t),f.disable(e)):(f.enable(t),f.enable(e)))}}),d.ItemNode.addMethod("isHidden",function(){return this._hidden}),d.ItemNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,label:this.name,type:this.param.type};return e&&(t.labelId=e.labelId||"",t.descr=e.descr,t.descrId=e.descrId||"",t.dataType=e.dataType||"",t.resourceId=e.resourceId),this.isParent()&&(t.children=o.chain(this.childs).filter(function(e){return!e.isHidden()}).invoke("toJSON").value()),t}),d.ItemNode.addMethod("hasVisibleChilds",function(){return this.hasChilds()&&!!this.childs.find(function(e){return!e.isHidden()})}),d.ItemNode.addMethod("hasEnabledChilds",function(){return this.hasChilds()&&!!this.childs.find(function(e){return!e.disabled})}),d.ItemNode.addMethod("removeChilds",function(){this.hasChilds()&&this.childs.each(function(e){this.removeChild(e)}.bind(this))}),d.FieldsCopyMoveController=function(){d.NodeCopyMoveController(this)},d.FieldsCopyMoveController.prototype=h(d.NodeCopyMoveController.prototype),d.FieldsCopyMoveController.addMethod("_buildMetanode",function(e){var t=h(e.param);return t.label=e.name,t.order=e.orderNumber,t.tooltip=e.tooltip,t}),d.TwoColumnNode=function(e){l.TreeNode.call(this,e),this.Types={Folder:new l.TreeNode.Type("ItemGroupType",{}),Leaf:new l.TreeNode.Type("ItemType",{})},this.nodeHeaderTemplateDomId="list_responsive:twoColumn"},d.TwoColumnNode.prototype=h(l.TreeNode.prototype),d.TwoColumnNode.addMethod("_createNode",function(){var e=this.id,t=(l.trees[this.getTreeId()],this._getHeaderTemplateElement());t.id=this.NODE_ID_PREFIX+e,this.refreshStyle(t),t.treeNode=this;var i=t.childElements()[0];this.tooltip&&(i.title=this.tooltip),i.childElements()[0].id=this.HANDLER_ID_PREFIX+e;var n=i.childElements()[1],r=this.param.extra&&this.param.extra.label?this.param.extra.label:this.name;n.insert(_.hardEscape(r)),i.childElements()[2].insert(_.hardEscape(this.name)),this._element=t}),d.TwoColumnNode.addMethod("_getTitle",function(){var e=this._getElement().childElements()[0].childElements()[2];return e.cleanWhitespace(),0===e.childNodes.length&&e.appendChild(document.createTextNode("")),e.childNodes[0]}),d.TwoColumnNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,label:this.name,type:this.param.type,order:this.orderNumber.toString()};return e&&(t.labelId=e.labelId||"",t.dataType=e.dataType||"",t.resourceId=e.resourceId),this.isParent()&&(t.children=o.invoke(this.childs,"toJSON")),t}),d.TwoColumnNode.addMethod("expandAllChilds",function(){var e=l.trees[this.getTreeId()];this.isParent()&&!this.isOpen()&&(e.writeStates(this.id,l.TreeNode.State.OPEN),this.refreshNode()),this.hasChilds()&&this.childs.each(function(e){e.expandAllChilds()})}),d.TablesNode=function(e){l.TreeNode.call(this,e),this.Types={Folder:new l.TreeNode.Type("level"),Leaf:new l.TreeNode.Type("item")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_type_tables:tables"},d.TablesNode.prototype=h(d.ItemNode.prototype),d.TablesNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,label:this.name,type:this.param.type};return e&&(t.originalId=e.originalId,t.datasourceId=e.datasourceId,t.repoId=e.repoId,t.itemId=e.itemId,t.dataSource=e.dataSource,t.table=e.table,this.isParent()?(t.query=e.query,t.dataSetType=e.dataSetType):(t.expression=e.expression,t.islandId=e.islandId,t.isConstant=e.isConstant,t.JavaType=e.JavaType,t.JdbcType=e.JdbcType),e.fieldDbName&&(t.fieldDbName=e.fieldDbName)),this.isParent()&&(t.children=o.chain(this.childs).filter(function(e){return!e.isHidden()}).invoke("toJSON").value()),t}),d.TablesNode.addVar("CONSTANT_TABLE_ID","constant_fields_level"),d.TablesNode.addVar("CROSSTABLES_FIELDS_TABLE_ID","crossTablesFieldsLevel"),d.TablesNode.addVar("INVALID_NODE_CLASS","invalid"),d.TablesNode.addVar("DATA_ISLAND_CLASS","dataIsland"),d.TablesNode.addVar("DERIVED_TABLE_CLASS","table derived"),d.TablesNode.addVar("CONSTANT_TABLE_CLASS","table constant"),d.TablesNode.addVar("CALCULATED_FIELD_CLASS","field calculated"),d.TablesNode.addMethod("refreshStyle",function(e){(e||(e=this._getElement()))&&(d.ItemNode.prototype.refreshStyle.call(this,e),this.param.extra&&"true"===this.param.extra.isInvalid?e.addClassName(this.INVALID_NODE_CLASS):e.removeClassName(this.INVALID_NODE_CLASS),this.param.extra&&this.param.extra.expression&&e.addClassName(this.CALCULATED_FIELD_CLASS),this.param.extra&&this.param.extra.query&&e.addClassName(this.DERIVED_TABLE_CLASS),this.param.id===this.CONSTANT_TABLE_ID&&e.addClassName(this.CONSTANT_TABLE_CLASS),this.param.extra&&this.param.extra.isIsland&&e.addClassName(this.DATA_ISLAND_CLASS))}),d.TablesNode.addMethod("edit",function(e){e&&"dblclick"!==e.type||d.ItemNode.prototype.edit.call(this,e)}),d.TablesCustomNode=function(e){d.TablesNode.call(this,e),this.nodeHeaderTemplateDomId=e.param.type===this.Types.Folder.name?"list_responsive_collapsible_type_tables:tables":"list_responsive_collapsible_type_tables:fields"},d.TablesCustomNode.prototype=h(d.TablesNode.prototype),d.TablesCopyMoveController=function(){d.NodeCopyMoveController(this)},d.TablesCopyMoveController.prototype=h(d.NodeCopyMoveController.prototype),d.TablesCopyMoveController.addMethod("_buildMetanode",function(e){var t={id:e.param.id,label:e.name,type:e.param.type,uri:e.param.uri};return e.param.extra&&(t.extra={originalId:e.param.extra.originalId,table:e.param.extra.table,itemId:e.param.extra.itemId,datasourceId:e.param.extra.datasourceId,repoId:e.param.extra.repoId,dataSource:e.param.extra.dataSource,dataSetType:e.param.extra.dataSetType,query:e.param.extra.query},e.param.extra.expression&&(t.extra.expression=e.param.extra.expression),e.param.extra.fieldDbName&&(t.extra.fieldDbName=e.param.extra.fieldDbName),e.isParent()||(t.extra.JavaType=e.param.extra.JavaType,t.extra.JdbcType=e.param.extra.JdbcType,t.extra.sourceItem=e.parent.param.extra.originalId)),t}),d.TablesCopyMoveController.addMethod("_handleDuplicatedNode",function(e,t){if(e.isParent()){for(var i=1,n=e.param.extra.datasourceId+"."+e.param.extra.itemId+i,r=l.trees[t.getTreeId()];r.findNodeChildByMetaName(t,n);)i++,n=e.param.extra.datasourceId+"."+e.param.extra.itemId+i;return e.param.id=n,e.param.extra.itemId+=i,e.name=e.param.extra.itemId,e.param.extra.originalId=e.param.extra.itemId,t.addChild(e),e.isloaded=!0,e.hasChilds()&&e.childs.each(function(t){this._handleDuplicatedNode(t,e)}.bind(this)),n}e.param.id=e.parent.param.id+"."+e.param.extra.itemId,e.param.extra.originalId=e.parent.param.extra.originalId+"."+e.param.extra.itemId}),d.DerivedTablesNode=function(e){d.TablesNode.call(this,e),e.param.type===this.Types.Folder.name&&e.param.extra&&e.param.extra.query&&(this.isSelectable=!0)},
d.DerivedTablesNode.prototype=h(d.TablesNode.prototype),d.JoinsList=function(e,t){c.List.call(this,e,t)},d.JoinsList.prototype=h(c.List.prototype),d.JoinsList.addMethod("_changeHandler",function(e){var t=this.getItemByEvent(e);t&&(t._respondOnItemEvents&&!e.isInvoked&&this.fire("item:change",{targetEvent:e,item:t}),e.isInvoked=!0)}),d.JoinsList.addMethod("_initEvents",function(){c.List.prototype._initEvents.call(this);var e=this._getElement();s(e).off("change").on("change","select",o.bind(this._changeHandler,this))}),d.JoinsListItem=function(e){c.ListItem.call(this,e),this._hidden=!1},d.JoinsListItem.prototype=h(c.ListItem.prototype),d.JoinsListItem.addMethod("hide",function(e){this._hidden=!!e,this.refreshStyle()}),d.JoinsListItem.addMethod("refreshStyle",function(){c.ListItem.prototype.refreshStyle.call(this),this._getElement()&&(this._hidden?this._getElement().addClassName(p.HIDDEN_CLASS):this._getElement().removeClassName(p.HIDDEN_CLASS))}),d.JoinsListItem.addMethod("processTemplate",function(e){var t=e.childElements()[0];t.cleanWhitespace();var i=t.childElements()[1],n=t.childElements()[2],r=t.childElements()[3],a=r.childElements()[0],o=a.childElements();return i.update(_.hardEscape(this._value.left.table.label+":"+this._value.left.label)),n.update(_.hardEscape(this._value.right.table.label+":"+this._value.right.label)),o.each(function(e){e.selected=e.value===this._value.type}.bind(this)),e}),d.JoinsListItem.addMethod("setJoinType",function(e){this.getValue().type=e;var t=this._getElement();if(t){var i=t.childElements()[0].childElements()[3].childElements()[0];r(i).value=e}}),d.JoinsListItem.addMethod("toJSON",function(){return{left:this._value.left.id,right:this._value.right.id,type:this._value.type}}),d.DisplayNode=function(e){d.ItemNode.call(this,e),this.Types={Folder:new l.TreeNode.Type("ItemGroupType"),Leaf:new l.TreeNode.Type("ItemType")},this.nodeHeaderTemplateDomId="list_responsive_collapsible_type_sets:sets"},d.DisplayNode.prototype=h(d.ItemNode.prototype),d.DisplayNode.addMethod("toJSON",function(){var e=this.param.extra,t={id:this.param.id,type:this.param.type};return e&&(t.itemId=e.itemId,t.descr=e.descr,t.labelId=e.labelId||"",t.descrId=e.descrId||"",t.resourceId=e.resourceId||""),e&&e.label&&(t.label=e.label),this.isParent()?t.children=o.chain(this.childs).filter(function(e){return!e.isHidden()&&!e._markAsDeleted}).invoke("toJSON").value():(t.dataType=e.dataType,t.dimensionOrMeasure=e.dimensionOrMeasure,t.defaultMask=e.defaultMask,t.defaultAgg=e.defaultAgg),t}),d.DisplayNode.addVar("INVALID_NODE_CLASS","invalid"),d.DisplayNode.addMethod("refreshStyle",function(e){(e||(e=this._getElement()))&&(d.ItemNode.prototype.refreshStyle.call(this,e),this.param.extra&&"true"===this.param.extra.isInvalid?e.addClassName(this.INVALID_NODE_CLASS):e.removeClassName(this.INVALID_NODE_CLASS))}),d.genericTreeParams={rootUri:"/",showRoot:!1,nodeClass:d.ItemNode,treeClassName:"",multiSelectEnabled:!0},d.createItemsTree=function(e){return e=Object.extend(h(d.genericTreeParams),e),new l.TreeSupport(e.treeId,e)},d.confirmDialog={MODE_OK_CANCEL:"okCancel",MODE_YES_NO:"yesNo",_CONFIRM_DIALOG_DOM_ID:"standardConfirm",_CONFIRM_DIALOG_BODY_DOM_PATTERN:"#standardConfirm > .content > .body",_CONFIRM_DIALOG_OK_BUTTON_ID:"#confirmYes",_CONFIRM_DIALOG_CANCEL_BUTTON_ID:"#confirmNo",_CONFIRM_DIALOG_OK_PATTERN:"#confirmYes > span",_CONFIRM_DIALOG_CANCEL_PATTERN:"#confirmNo > span",_yesMessageHolder:null,_noMessageHolder:null,_dialog:null,_onOk:null,_onCancel:null,_customEventHandler:null,_templateDomId:null,_visible:!1,init:function(){d.confirmDialog._init.bind(d.confirmDialog)()},show:function(e,t,i,n,r){d.confirmDialog._show.bind(d.confirmDialog,e,t,i,n,r)()},hideForDetails:function(){g.popup.hide(d.confirmDialog._dialog)},showFromDetails:function(){g.popup.show(d.confirmDialog._dialog,!0)},visible:function(){return d.confirmDialog._visible},_init:function(){this._dialog=r(this._CONFIRM_DIALOG_DOM_ID),this._yesMessageHolder=a(this._CONFIRM_DIALOG_OK_PATTERN).first(),this._noMessageHolder=a(this._CONFIRM_DIALOG_CANCEL_PATTERN).first(),d.registerClickHandlers([this._clickEventHandler.bind(this)])},_show:function(e,t,i,n,a){this._onOk=t,this._onCancel=i,this._customEventHandler=n,this._templateDomId=e,a&&a==this.MODE_YES_NO?(this._yesMessageHolder.update(d.getMessage("yes")),this._noMessageHolder.update(d.getMessage("no"))):(this._yesMessageHolder.update(d.getMessage("ok")),this._noMessageHolder.update(d.getMessage("cancel"))),r(this._templateDomId).removeClassName(p.HIDDEN_CLASS),g.popup.show(this._dialog,!0),this._visible=!0},_hide:function(e){r(this._templateDomId).addClassName(p.HIDDEN_CLASS),g.popup.hide(this._dialog),this._visible=!1,e&&e()},_clickEventHandler:function(e){return d.elementClicked(e,this._CONFIRM_DIALOG_OK_BUTTON_ID)?(this._hide(this._onOk),!0):d.elementClicked(e,this._CONFIRM_DIALOG_CANCEL_BUTTON_ID)?(this._hide(this._onCancel),!0):this._customEventHandler?this._customEventHandler(e):void 0}},d.detailsDialog={_DETAIL_DIALOG_DOM_ID:"detail",_DETAIL_DIALOG_CLOSE_BUTTON_ID:"#close",_DETAIL_DIALOG_LIST_DOM_ID:"detailsList",_DETAIL_DIALOG_TEXT_DOM_ID:"detailsText",_LIST_TEMPLATE:"defaultListTemplate",_LIST_ITEM_TEMPLATE:"dynamicListItemTemplate",_dialog:null,_showConfirmAfterClose:!1,_list:null,_listItems:null,init:function(){d.detailsDialog._init.bind(d.detailsDialog)()},show:function(e){d.detailsDialog._show.bind(d.detailsDialog,e)()},_init:function(){this._dialog=r(this._DETAIL_DIALOG_DOM_ID),d.registerClickHandlers([this._clickEventHandler.bind(this)])},_show:function(e){d.confirmDialog.visible()?(d.confirmDialog.hideForDetails(),this._showConfirmAfterClose=!0):this._showConfirmAfterClose=!1,this._createMessage(e),g.popup.show(this._dialog,!0),r(this._DETAIL_DIALOG_LIST_DOM_ID).parentNode.scrollTop=0},_createMessage:function(e){"string"==typeof e?(r(this._DETAIL_DIALOG_LIST_DOM_ID).addClassName(p.HIDDEN_CLASS),r(this._DETAIL_DIALOG_TEXT_DOM_ID).removeClassName(p.HIDDEN_CLASS).update(e)):(r(this._DETAIL_DIALOG_TEXT_DOM_ID).addClassName(p.HIDDEN_CLASS),r(this._DETAIL_DIALOG_LIST_DOM_ID).removeClassName(p.HIDDEN_CLASS),this._items&&(this._list.removeItems(this._items),this._items=null,this._list=null),this._items=e.collect(function(e){return new c.ListItem({label:e})}),this._list=new c.List(this._DETAIL_DIALOG_LIST_DOM_ID,{listTemplateDomId:this._LIST_TEMPLATE,itemTemplateDomId:this._LIST_ITEM_TEMPLATE,items:this._items}),this._list.show())},_close:function(){g.popup.hide(this._dialog),this._showConfirmAfterClose&&d.confirmDialog.showFromDetails()},_clickEventHandler:function(e){if(d.elementClicked(e,this._DETAIL_DIALOG_CLOSE_BUTTON_ID))return this._close(),!0}},i.exports=d}),define("dataChooser/domain.chooser.saveAsTopic",["require","exports","module","prototype","underscore","jquery","./domain.chooser","./domain.components","runtime_dependencies/jrs-ui/src/components/components.dialogs","runtime_dependencies/jrs-ui/src/core/core.events.bis","runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils","runtime_dependencies/jrs-ui/src/util/utils.common"],function(e,t,i){var n=e("prototype"),r=n.$,a=n.$H,o=n.$$,s=n.$break,d=n.$F,l=e("underscore"),u=e("jquery"),c=e("./domain.chooser"),m=e("./domain.components"),h=e("runtime_dependencies/jrs-ui/src/components/components.dialogs"),p=e("runtime_dependencies/jrs-ui/src/core/core.events.bis"),f=e("runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils"),_=e("runtime_dependencies/jrs-ui/src/util/utils.common"),g=_.ValidationModule;c.saveAsTopic={RESOURCE_DOESNT_EXISTS_RESPONSE:"resource doesnt exist",RESOURCE_ALREADY_EXISTS_RESPONSE:"resource already exists",RESOURCE_OF_OTHER_TYPE_EXISTS_RESPONSE:"resource of other type already exists",ID_TOPIC_NAME:"topicName",ID_TOPIC_LOCATION:"topicLocation",ID_TOPIC_DESCRIPTION:"topicDesc",ID_DATA_LIFETIME:"dataStrategy_dataLifetimeMinutes",ID_STAGED:"dataStrategy_staged",ID_MAX_ROWS:"dataStrategy_maxRows",ID_HIDDEN_TOPIC_NAME:"slTopicLabel",ID_HIDDEN_TOPIC_LOCATION:"slTopicLocation",ID_HIDDEN_TOPIC_DESCRIPTION:"slTopicDesc",ID_SAVE_AS_TOPIC_CONFIRM:"standardConfirm",SAVE_TOPIC_BUTTONS:["#goToDesigner"],ID_ENABLE_STAGING:"#dataStrategy_staged",ID_STAGING_QUERY_TIMEOUT:"#dataStrategy_dataLifetimeMinutes",ID_SAVE_AS_TOPIC_INPUTS:"#saveAsTopicInputs",EDIT_MODE:"editMode",CREATE_MODE:"createMode",ID_MIN_MAX_STAGING_QUERY_TIMEOUT_CHANGED:"#minMaxTimeNote",CLASS_LIFETIME_INFO:".lifeTimeInfo",idToAttrMap:{dataStrategy_dataLifetimeMinutes:"stagingQueryTimeOut",topicDesc:"description",topicName:"name",topicLocation:"location"},defaultStagingTimeout:{min:10,max:10080},minutesIn:{day:1440,hour:60},fillForm:function(){r("slTopicLabel").writeAttribute("value",this.saveAsTopicModel.get("name")),r("slTopicLocation").writeAttribute("value",this.saveAsTopicModel.get("location")),r("slTopicDesc").writeAttribute("value",this.saveAsTopicModel.get("description")),"true"===this.params.stagingEnabled&&(r("slDataStrategy_staged").writeAttribute("value",this.saveAsTopicModel.get("stagingEnabled").toString()),r("slDataStrategy_dataLifetimeMinutes").writeAttribute("value",this.saveAsTopicModel.get("stagingQueryTimeOut")))},getFlowControlsClickEventHandler:function(){return this._flowControlsClickEventHandlerWrapper.bind(this)},init:function(e){var t=this;this.params=e,this.organizationId=e.organizationId,this.storedTopicLocationPath=e.folderURI,this.ORGANIZATIONS_FOLDER_URI=e.organizationsFolderUri,this.ORGANIZATION_MATCHER="^#{org}(/[^/]+#{org})*$".interpolate({org:c.saveAsTopic.ORGANIZATIONS_FOLDER_URI});var i=e.maxTopicDescription,n=e.maxTopicName;this.minStagingQueryTimeOut=e.minStagingTopicMinutes||this.defaultStagingTimeout.min,this.maxStagingQueryTimeOut=e.maxStagingTopicMinutes||this.defaultStagingTimeout.max,this.topicStagingEnabled=JSON.parse(""!==e.topicStagingEnabled&&e.topicStagingEnabled),this.enableStaging=u(this.ID_ENABLE_STAGING),this.stagingQueryTimeOut=u(this.ID_STAGING_QUERY_TIMEOUT),this.minMaxQueryTimeoutNote=u(this.ID_MIN_MAX_STAGING_QUERY_TIMEOUT_CHANGED),this.lifeTimeInfo=u(this.CLASS_LIFETIME_INFO),this.goToDesignerButton=u("#goToDesigner"),this.saveAsTopicInputs=u(this.ID_SAVE_AS_TOPIC_INPUTS),this.name=u("#"+this.ID_TOPIC_NAME),this.description=u("#"+this.ID_TOPIC_DESCRIPTION),this.topicLocation=r(this.ID_TOPIC_LOCATION),this.saveTopicBtn=null,this.saveAsTopicConfirm=r(this.ID_SAVE_AS_TOPIC_CONFIRM),this._clickHandlersHash=this._clickHandlersFactory(),m.registerClickHandlers([this._flowControlsClickEventHandlerWrapper.bind(this),this._clickHandler.bind(this)]),this.setUpStagingQueryTimeOutValue(this.params.topicStagingQueryCacheTimeout||this.minStagingQueryTimeOut),this.initDataLifetimeInputs(),this.initSaveAsTopicModel({name:t.params.topicName||"",description:t.params.topicDescription||"",location:t.params.folderURI,stagingQueryTimeOut:t.stagingQueryTimeOutValue,stagingEnabled:t.topicStagingEnabled},{customValidationValues:{maxNameLength:n,maxDescLength:i,minStagingQueryTimeOut:t.minStagingQueryTimeOut,maxStagingQueryTimeOut:t.maxStagingQueryTimeOut,i18n:{maxStagingQueryTimeOut:t.stagingQueryTimeOutDDHHMM.max,minStagingQueryTimeOut:t.stagingQueryTimeOutDDHHMM.min}}}),this.initEvents()},initEvents:function(){var e=this;this.enableStaging.change(function(){e.toggleStaging()}),this.saveAsTopicModel.bind("attr:invalid",function(e,t,i,n){var r=u(n.el),a=!l.isUndefined(n.silent)&&n.silent;i&&!a&&(r.is("input")||r.is("textarea")?(r.parent().addClass("error"),r.siblings(".message.warning").text(i)):(r.addClass("error"),r.find(".message.warning").text(i)))}),this.saveAsTopicModel.bind("attr:valid",function(e,t,i,n){var r=u(n.el);r.is("input")||r.is("textarea")?(r.parent().removeClass("error"),r.siblings(".message.warning").text("")):(r.removeClass("error"),r.find(".message.warning").text(""))}),this.saveAsTopicInputs.on("keyup","input, textarea",function(t){var i=e.idToAttrMap[this.id],n=this;i&&(e.saveAsTopicModel.set(i,n.value),e.saveAsTopicModel.validateAttr(i,n.value,{el:n,silent:!0}))})},setUpStagingQueryTimeOutValue:function(e){this.stagingQueryTimeOutValue=e,e>this.maxStagingQueryTimeOut&&(this.stagingQueryTimeOutValue=this.maxStagingQueryTimeOut,this.minMaxQueryTimeoutNote.find("span").text(m._messages["page.saveAsTopic.dataLifetime.max.was.changed"]),this.minMaxQueryTimeoutNote.show()),e<this.minStagingQueryTimeOut&&(this.stagingQueryTimeOutValue=this.minStagingQueryTimeOut,this.minMaxQueryTimeoutNote.find("span").text(m._messages["page.saveAsTopic.dataLifetime.min.was.changed"]),this.minMaxQueryTimeoutNote.show())},initSaveAsTopicModel:function(e,t){this.saveAsTopicModel=new this.params.model(e,t)},initDataLifetimeInputs:function(){var e=this;this.stagingQueryTimeOutDDHHMM={max:this.convertToDDHHMM(e.maxStagingQueryTimeOut).stringFormat,min:this.convertToDDHHMM(e.minStagingQueryTimeOut).stringFormat},this.daysInput=this.stagingQueryTimeOut.find("input.days"),this.hoursInput=this.stagingQueryTimeOut.find("input.hours"),this.minutesInput=this.stagingQueryTimeOut.find("input.minutes"),this.setDataLifetimeInfo(),this.setDataLifetimeInputsValues(this.convertToDDHHMM(this.stagingQueryTimeOutValue).values),this.stagingQueryTimeOut.on("keydown","input",function(e){var t=e.which?e.which:event.keyCode;46!=t&&t>31&&(t<48||t>57)&&(t<96||t>105)&&!e.ctrlKey&&!e.shiftKey&&37!=t&&39!=t&&e.preventDefault()}),this.stagingQueryTimeOut.on("keyup","input",function(t){e.validateDataLifetimeInputs(this);var i=e.convertToMinutes(e.daysInput.val()||0,e.hoursInput.val()||0,e.minutesInput.val()||0);e.saveAsTopicModel.set("stagingQueryTimeOut",i),e.saveAsTopicModel.validateAttr("stagingQueryTimeOut",i,{el:e.stagingQueryTimeOut,silent:!0})})},setDataLifetimeInputsValues:function(e){this.daysInput.val(e.days.value),this.hoursInput.val(e.hours.value),this.minutesInput.val(e.minutes.value)},setDataLifetimeInfo:function(){this.lifeTimeInfo.find(".minimumLifetime").text(m._messages["page.saveAsTopic.dataLifetime.minimum"].replace("{0}",this.stagingQueryTimeOutDDHHMM.min)),this.lifeTimeInfo.find(".maximumLifetime").text(m._messages["page.saveAsTopic.dataLifetime.maximum"].replace("{0}",this.stagingQueryTimeOutDDHHMM.max))},validateDataLifetimeInputs:function(e){var t=parseInt(e.getAttribute("max"))>=0?parseInt(e.getAttribute("max")):"",i=parseInt(e.value,10)||0;e.value!=i&&(e.value=i),i>t&&(e.value=t)},convertToMinutes:function(e,t,i){return e*this.minutesIn.day+t*this.minutesIn.hour+1*i},convertToDDHHMM:function(e){var t=e,i=Math.floor(e/this.minutesIn.day);e%=this.minutesIn.day;var n=Math.floor(e/this.minutesIn.hour);e%=this.minutesIn.hour;var r=e,a=function(e){return e.value?e.value+" "+e.units+" ":""},o={days:{value:i||"",units:1!==i?m._messages["page.saveAsTopic.dataLifetime.units.days"]:m._messages["page.saveAsTopic.dataLifetime.units.day"]},hours:{value:n||"",units:1!==n?m._messages["page.saveAsTopic.dataLifetime.units.hours"]:m._messages["page.saveAsTopic.dataLifetime.units.hour"]},minutes:{value:r||"",units:1!==r?m._messages["page.saveAsTopic.dataLifetime.units.minutes"]:m._messages["page.saveAsTopic.dataLifetime.units.minute"]},originalValue:t};return{stringFormat:u.trim(a(o.days)+a(o.hours)+a(o.minutes)),values:o}},toggleStaging:function(){this.enableStaging.prop("checked")?(this.saveAsTopicModel.set("stagingEnabled",!0),this.stagingQueryTimeOut.find("input").removeAttr("disabled")):(this.saveAsTopicModel.set("stagingEnabled",!1),this.stagingQueryTimeOut.find("input").attr("disabled","disabled"),this.saveAsTopicModel.set("stagingQueryTimeOut",this.minStagingQueryTimeOut),this.saveAsTopicModel.validateAttr("stagingQueryTimeOut",this.minStagingQueryTimeOut,{el:this.stagingQueryTimeOut}),this.saveAsTopicModel.validateAttr("name",this.saveAsTopicModel.get("name"),{el:this.name}))},_changeEventIdForSaveButtons:function(){this.SAVE_TOPIC_BUTTONS.each(function(e){c.flowControlsEventMap.get(e).eventId="save"})},_isDataValid:function(){var e=this;return l.each(this.saveAsTopicModel.attributes,function(t,i){e.saveAsTopicModel.validateAttr(i,t,{el:e[i]})}),this.saveAsTopicModel.isValid(!0)},_flowControlsClickEventHandlerWrapper:function(e){function t(e,t){if(!e)return!0;var i=!0;return l.each(e,function(e,n){e?(i=!1,g.showError(t[n],e)):g.hideError(t[n])}),i}var i=!1;return this.SAVE_TOPIC_BUTTONS.each(function(n){if(m.elementClicked(e,n)){if(i=!0,this.saveTopicBtn=o(n).first(),!c.saveAsTopic._isDataValid())throw s;var a=this._formToParams();if(!a[this.ID_HIDDEN_TOPIC_NAME])throw c.flowControlsClickEventHandler(e),s;throw this.checkIfTopicExists(a,function(e){if(g.hideError(r(this.ID_TOPIC_NAME)),!e)throw"malformed server response";t(e.validation,{topicLocation:this.topicLocation})&&(e.topicExists&&"no"!=e.topicExists?"nameBusy"==e.topicExists?g.showError(r(this.ID_TOPIC_NAME),m._messages.resource_of_other_type_exists):"yes"==e.topicExists&&this.showConfirmDialog().then(function(){this.saveTopic()}.bind(this)):this.saveTopic())}.bind(this)),s}},this),i||c.flowControlsClickEventHandler(e)},_clickHandler:function(e){m.basicClickHandler(e,this._clickHandlersHash)},_clickHandlersFactory:function(){return a({"#browser_button":function(){var e=this.repositoryBrowser;return e.isInitialized?(h.popup.show(e.browseRepositoryDialog),e.saveAsTree.selectFolder(r("topicLocation").getValue())):(e.init(this.params,this.saveAsTopicModel),h.popup.show(e.browseRepositoryDialog)),!0}.bind(this)})},checkIfTopicExists:function(e,t){m.sendAjaxRequest({flowExecutionKey:c.flowExecutionKey,eventId:"checkIfExists"},e,t)},saveTopic:function(){this._changeEventIdForSaveButtons(),c.flowControlsClickEventHandler(this.saveTopicBtn)},showConfirmDialog:function(){return h.popupConfirm.show(this.saveAsTopicConfirm,null,{okButtonSelector:"#saveAsTopicOverwriteButtonId",cancelButtonSelector:"#saveAsTopicOverwriteCancelButtonId"})},_formToParams:function(){var e={};return e[this.ID_HIDDEN_TOPIC_NAME]=d(this.ID_TOPIC_NAME)||this.params.topicName,e[this.ID_HIDDEN_TOPIC_LOCATION]=d(this.ID_TOPIC_LOCATION)||this.params.topicLocation,e[this.ID_HIDDEN_TOPIC_DESCRIPTION]=d(this.ID_TOPIC_DESCRIPTION)||this.params.topicDescription,void 0!==r(this.ID_DATA_LIFETIME)&&null!=r(this.ID_DATA_LIFETIME)&&(e[this.ID_DATA_LIFETIME]=this.saveAsTopicModel.get("stagingQueryTimeOut"),e[this.ID_STAGED]=r(this.ID_STAGED).checked),e}},c.saveAsTopic.repositoryBrowser={isInitialized:!1,init:function(e,t){this.browseRepositoryDialog=r("selectFromRepository"),this.selectFromRepoButton=r("selectFromRepoBtnSelect"),this.saveAsTree=this.createRepositoryTree(e),this.saveAsTopicModel=t,this._clickHandlersHash=this._createClickHandlersFactory(),m.registerClickHandlers([function(e){m.basicClickHandler(e,this._clickHandlersHash)}.bind(this)]),this.isInitialized=!0},createRepositoryTree:function(e){var t=e.folderURI?e.folderURI:"/",i=new f.createRepositoryTree("addFileTreeRepoLocation",{providerId:"repositoryTreeFoldersProvider",organizationId:e.organizationId,publicFolderUri:e.publicFolderUri});return i.getTreeId=function(){return"addFileTreeRepoLocation"},i.selectFolder=function(e){i.openAndSelectNode(e)},i.getSelectedFolderUri=function(){var e=i.getSelectedNode();return e&&e.param.uri},i.observe("server:error",function(){window.console&&console.log("Server internal error occurred on repo tree loading.")}),i.observe("childredPrefetched:loaded",function(){i.openAndSelectNode(t)}),i.observe("tree:loaded",function(){i.openAndSelectNode(t)}),i.observe("node:selected",function(e){this._refreshSelectButtonState(e.memo.node)}.bind(this)),i.showTreePrefetchNodes(t),i},_refreshSelectButtonState:function(e){if(e){var t=!!e.param.uri.match(c.saveAsTopic.ORGANIZATION_MATCHER);e.param.extra.isWritable&&!t?p.enable(this.selectFromRepoButton):p.disable(this.selectFromRepoButton)}},_createClickHandlersFactory:function(){return a({"#selectFromRepoBtnCancel":function(){h.popup.hide(this.browseRepositoryDialog)}.bind(this),"#selectFromRepoBtnSelect":function(){var e=this.saveAsTree.getSelectedFolderUri();this.saveAsTopicModel.set("location",e),r("topicLocation").value=e,h.popup.hide(this.browseRepositoryDialog)}.bind(this)})}},void 0===e&&document.observe("dom:loaded",c.initialize.bind(c)),i.exports=m}),function(e){"object"==typeof exports?module.exports=e(require("backbone"),require("underscore")):"function"==typeof define&&define.amd&&define("backbone-validation",["backbone","underscore"],e)}(function(e,t){return e.Validation=function(t){"use strict";var i={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},n={formatLabel:function(e,t){return l[i.labelFormatter](e,t)},format:function(){var e=Array.prototype.slice.call(arguments);return e.shift().replace(/\{(\d+)\}/g,function(t,i){return void 0!==e[i]?e[i]:t})}},r=function(i,n,a){return n=n||{},a=a||"",t.each(i,function(t,o){i.hasOwnProperty(o)&&(t&&"object"==typeof t&&!(t instanceof Array||t instanceof Date||t instanceof RegExp||t instanceof e.Model||t instanceof e.Collection)?r(t,n,a+o+"."):n[a+o]=t)}),n},a=function(){var e=function(e){return t.reduce(t.keys(t.result(e,"validation")||{}),function(e,t){return e[t]=void 0,e},{})},a=function(e,i){var n=e.validation?t.result(e,"validation")[i]||{}:{};return(t.isFunction(n)||t.isString(n))&&(n={fn:n}),t.isArray(n)||(n=[n]),t.reduce(n,function(e,i){return t.each(t.without(t.keys(i),"msg"),function(t){e.push({fn:u[t],val:i[t],msg:i.msg})}),e},[])},s=function(e,i,r,o){return t.reduce(a(e,i),function(a,s){var d=t.extend({},n,u),l=s.fn.call(d,r,i,s.val,e,o);return!1!==l&&!1!==a&&(l&&!a?t.result(s,"msg")||l:a)},"")},d=function(e,i){var n,a={},o=!0,d=t.clone(i),l=r(i);return t.each(l,function(t,i){(n=s(e,i,t,d))&&(a[i]=n,o=!1)}),{invalidAttrs:a,isValid:o}},l=function(i,n){return{preValidate:function(e,i){var n,r=this,a={};return t.isObject(e)?(t.each(e,function(e,t){(n=r.preValidate(t,e))&&(a[t]=n)}),t.isEmpty(a)?void 0:a):s(this,e,i,t.extend({},this.attributes))},isValid:function(e){var i=r(this.attributes);return t.isString(e)?!s(this,e,i[e],t.extend({},this.attributes)):t.isArray(e)?t.reduce(e,function(e,n){return e&&!s(this,n,i[n],t.extend({},this.attributes))},!0,this):(!0===e&&this.validate(),!this.validation||this._isValid)},validate:function(a,o){var s=this,l=!a,u=t.extend({},n,o),c=e(s),m=t.extend({},c,s.attributes,a),h=r(a||m),p=d(s,m);if(s._isValid=p.isValid,t.each(c,function(e,t){p.invalidAttrs.hasOwnProperty(t)||u.valid(i,t,u.selector)}),t.each(c,function(e,t){var n=p.invalidAttrs.hasOwnProperty(t),r=h.hasOwnProperty(t);n&&(r||l)&&u.invalid(i,t,p.invalidAttrs[t],u.selector)}),t.defer(function(){s.trigger("validated",s._isValid,s,p.invalidAttrs),s.trigger("validated:"+(s._isValid?"valid":"invalid"),s,p.invalidAttrs)}),!u.forceUpdate&&t.intersection(t.keys(p.invalidAttrs),t.keys(h)).length>0)return p.invalidAttrs}}},c=function(e,i,n){t.extend(i,l(e,n))},m=function(e){delete e.validate,delete e.preValidate,delete e.isValid},h=function(e){c(this.view,e,this.options)},p=function(e){m(e)};return{version:"0.9.1",configure:function(e){t.extend(i,e)},bind:function(e,n){n=t.extend({},i,o,n);var r=n.model||e.model,a=n.collection||e.collection;if(void 0===r&&void 0===a)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";r?c(e,r,n):a&&(a.each(function(t){c(e,t,n)}),a.bind("add",h,{view:e,options:n}),a.bind("remove",p))},unbind:function(e,i){i=t.extend({},i);var n=i.model||e.model,r=i.collection||e.collection;n?m(n):r&&(r.each(function(e){m(e)}),r.unbind("add",h),r.unbind("remove",p))},mixin:l(null,i)}}(),o=a.callbacks={valid:function(e,t,i){e.$("["+i+'~="'+t+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(e,t,i,n){e.$("["+n+'~="'+t+'"]').addClass("invalid").attr("data-error",i)}},s=a.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},d=a.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",digits:"{0} must only contain digits",number:"{0} must be a number",email:"{0} must be a valid email",url:"{0} must be a valid url",inlinePattern:"{0} is invalid"},l=a.labelFormatters={none:function(e){return e},sentenceCase:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toUpperCase():" "+e.toLowerCase()}).replace(/_/g," ")},label:function(e,t){return t.labels&&t.labels[e]||l.sentenceCase(e,t)}},u=a.validators=function(){var e=String.prototype.trim?function(e){return null===e?"":String.prototype.trim.call(e)}:function(e){var t=/^\s+/,i=/\s+$/;return null===e?"":e.toString().replace(t,"").replace(i,"")},i=function(e){return t.isNumber(e)||t.isString(e)&&e.match(s.number)},n=function(i){return!(t.isNull(i)||t.isUndefined(i)||t.isString(i)&&""===e(i)||t.isArray(i)&&t.isEmpty(i))};return{fn:function(e,i,n,r,a){return t.isString(n)&&(n=r[n]),n.call(r,e,i,a)},required:function(e,i,r,a,o){var s=t.isFunction(r)?r.call(a,e,i,o):r;return!(!s&&!n(e))&&(s&&!n(e)?this.format(d.required,this.formatLabel(i,a)):void 0)},acceptance:function(e,i,n,r){if("true"!==e&&(!t.isBoolean(e)||!1===e))return this.format(d.acceptance,this.formatLabel(i,r))},min:function(e,t,n,r){if(!i(e)||e<n)return this.format(d.min,this.formatLabel(t,r),n)},max:function(e,t,n,r){if(!i(e)||e>n)return this.format(d.max,this.formatLabel(t,r),n)},range:function(e,t,n,r){if(!i(e)||e<n[0]||e>n[1])return this.format(d.range,this.formatLabel(t,r),n[0],n[1])},length:function(e,i,n,r){if(!t.isString(e)||e.length!==n)return this.format(d.length,this.formatLabel(i,r),n)},minLength:function(e,i,n,r){if(!t.isString(e)||e.length<n)return this.format(d.minLength,this.formatLabel(i,r),n)},maxLength:function(e,i,n,r){if(!t.isString(e)||e.length>n)return this.format(d.maxLength,this.formatLabel(i,r),n)},rangeLength:function(e,i,n,r){if(!t.isString(e)||e.length<n[0]||e.length>n[1])return this.format(d.rangeLength,this.formatLabel(i,r),n[0],n[1])},oneOf:function(e,i,n,r){if(!t.include(n,e))return this.format(d.oneOf,this.formatLabel(i,r),n.join(", "))},equalTo:function(e,t,i,n,r){if(e!==r[i])return this.format(d.equalTo,this.formatLabel(t,n),this.formatLabel(i,n))},pattern:function(e,t,i,r){if(!n(e)||!e.toString().match(s[i]||i))return this.format(d[i]||d.inlinePattern,this.formatLabel(t,r),i)}}}();return t.each(u,function(e,i){u[i]=t.bind(u[i],t.extend({},n,u))}),a}(t),e.Validation}),define("runtime_dependencies/js-sdk/src/common/extension/backboneValidationExtension",["require","exports","module","backbone-validation","underscore","../util/parse/NumberUtils"],function(e,t,i){var n=e("backbone-validation"),r=e("underscore"),a=e("../util/parse/NumberUtils"),o=new a,s=n.mixin.validate;n.mixin.validate=function(e,t){t||(t={});var i=this;return s.call(this,e,r.extend({valid:function(e,t){i.trigger("validate:"+t,i,t)},invalid:function(e,t,n){i.trigger("validate:"+t,i,t,n)}},t))},r.extend(n.validators,{doesNotContainSymbols:function(e,t,i){if(new RegExp("["+i+"]","g").test(e))return"Attribute '"+t+"' contains forbidden symbols"},integerNumber:function(e){if(!o.isNumberInt(e))return"Value is not a valid integer number"},type:function(e,t,i){function n(e){var t;return"string"==e?t=r.isString:"number"===e?t=r.isNumber:"object"===e?t=r.isObject:"boolean"===e?t=r.isBoolean:"null"===e?t=r.isNull:"undefined"===e&&(t=r.isUndefined),t}if(r.isArray(i)||(i=[i]),!i.some(function(t){return n(t)(e)}))return"'{attr}' is not {type}".replace("{attr}",t).replace("'{type}'",i.join(" "))},url:function(e){if(!/(http|https):\/\/.*\..*./.test(e))return"Value is not a valid url"},hexColor:function(e){if(!/^#[0-9a-f]{3,6}$/i.test(e))return"Value is not a valid hex color"},xRegExpPattern:function(e,t,i,n){if(!i.test(e))return"Value does not match pattern"},startsWithLetter:function(e,t,i,n){if(!e.substr(0,1).match(/[A-Za-z]/))return"Value should start with letter"},containsOnlyWordCharacters:function(e,t,i,n){if(e.search(/\W/)>=0)return"Value should contain only word characters (letters, digits and underscore)"},arrayMinLength:function(e,t,i,n){if(r.isArray(e)&&e.length<i)return"Array length is less than "+i}}),i.exports=n}),define("domainTopic/model/SaveAsTopicModel",["require","exports","module","underscore","backbone","bundle!DomainTopicBundle","runtime_dependencies/js-sdk/src/common/extension/backboneValidationExtension"],function(e,t,i){var n=e("underscore"),r=e("backbone"),a=e("bundle!DomainTopicBundle"),o=e("runtime_dependencies/js-sdk/src/common/extension/backboneValidationExtension"),s=r.Model.extend({defaults:{stagingQueryTimeOut:0,name:"",location:"/",description:"",stagingEnabled:!1},validationPattern:function(e){return{name:[{fn:function(e,t,i){if(i.stagingEnabled&&!e)return!0},msg:a["error.name.is.required"]},{maxLength:e.maxNameLength||100,msg:a["error.name.is.too.long"].replace("{0}",e.maxNameLength||100)}],description:[{maxLength:e.maxDescLength||300,msg:a["error.description.is.too.long"].replace("{0}",e.maxDescLength||300)}],stagingQueryTimeOut:[{fn:function(e,t,i){if(!/^[-+]?\d+$/.test(e))return!0},msg:a["error.staging.query.time.out.only.integers.above.zero"]},{min:e.minStagingQueryTimeOut||10,msg:a["error.min.staging.query.time.out.units"].replace("{0}",e.i18n.minStagingQueryTimeOut||"10 "+a["min.staging.query.time.out.units"])},{max:e.maxStagingQueryTimeOut||10080,msg:a["error.max.staging.query.time.out.units"].replace("{0}",e.i18n.maxStagingQueryTimeOut||"7 "+a["max.staging.query.time.out.units"])}]}},initialize:function(e,t){
this.setValidationRules(t&&t.customValidationValues||{i18n:{}})},setValidationRules:function(e){this.validation=this.validationPattern(e)},validateAttr:function(e,t,i){var n=o.mixin.preValidate.call(this,e,t),r={};return r[e]=t,n?this.trigger("attr:invalid",this,r,n,i):this.trigger("attr:valid",this,r,n,i),!n}});n.extend(s.prototype,o.mixin),i.exports=s}),define("dataChooser/dataChooserSaveAsTopicMain",["require","exports","module","requirejs-domready","./domain.chooser.saveAsTopic","../domainTopic/model/SaveAsTopicModel","runtime_dependencies/js-sdk/src/jrs.configs","underscore","runtime_dependencies/js-sdk/src/common/component/dialog/AlertDialog"],function(e,t,i){var n=e("requirejs-domready"),r=e("./domain.chooser.saveAsTopic"),a=e("../domainTopic/model/SaveAsTopicModel"),o=e("runtime_dependencies/js-sdk/src/jrs.configs"),s=e("underscore"),d=e("runtime_dependencies/js-sdk/src/common/component/dialog/AlertDialog");n(function(){if(s.extend(r._messages,o.dataChooser.domain._messages),s.extend(window.localContext,o.dataChooser.localContext),o.dataChooser.errorMessage){var e=new d;e.setMessage(o.dataChooser.errorMessage),e.open()}r.chooser.initialize({model:a}),window.dispatchEvent(new Event("dataChooserSaveAsTopicMainReady"))})});