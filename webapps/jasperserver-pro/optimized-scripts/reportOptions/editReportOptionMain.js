/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define("runtime_dependencies/jrs-ui/src/controls/rest/InputControlsService",["require","exports","module","runtime_dependencies/js-sdk/src/jrs.configs","request"],function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=e("runtime_dependencies/js-sdk/src/jrs.configs"),l=e("request"),c=function(){function e(t){n(this,e),r(this,"request",void 0),this.request=t.request||l}return o(e,[{key:"getInputControlsSelectedValues",value:function(e){return this.request({type:"GET",url:"".concat(a.urlContext,"/rest_v2/reports").concat(e,"/inputControls/selectedValues"),headers:{Accept:"application/json"}})}},{key:"getInputControlsMetadata",value:function(e){return this.request({type:"GET",url:"".concat(a.urlContext,"/rest_v2/reports").concat(e,"/inputControls?exclude=state"),headers:{Accept:"application/json"}})}},{key:"getInputControlsValues",value:function(e,t){return this.request({type:"GET",url:"".concat(a.urlContext,"/rest_v2/reports").concat(e,"/inputControls/").concat(t.join(";"),"/values"),headers:{Accept:"application/json"}})}},{key:"getInputControlsPaginatedValues",value:function(e,t){var i=t.map(function(e){return e.name}).join(";");return this.request({type:"POST",url:"".concat(a.urlContext,"/rest_v2/reports").concat(e,"/inputControls/").concat(i,"/values/pagination"),data:JSON.stringify({reportParameter:t}),headers:{Accept:"application/json","Content-Type":"application/json"}})}}]),e}();i.exports=c}),define("runtime_dependencies/jrs-ui/src/controls/rest/InputControlsServiceWithCache",["require","exports","module","jquery","underscore"],function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=e("jquery"),l=e("underscore"),c=function(e,t){return l.sortBy(t,"name").reduce(function(e,t){var i=t.name,n=t.offset,s=t.limit,o=[i,n,s].concat(t.criteria||[]).concat(t.value||[]).concat(t.select||[]);return"".concat(e," ").concat(JSON.stringify(o))},"".concat(e))},u=function(){function e(t){n(this,e),r(this,"inputControlsService",void 0),r(this,"cache",void 0),this.cache={},this.inputControlsService=t.inputControlsService}return o(e,[{key:"getInputControlsSelectedValues",value:function(e){return this.inputControlsService.getInputControlsSelectedValues(e)}},{key:"getInputControlsMetadata",value:function(e){return this.inputControlsService.getInputControlsMetadata(e)}},{key:"getInputControlsValues",value:function(e,t){return this.inputControlsService.getInputControlsValues(e,t)}},{key:"getInputControlsPaginatedValues",value:function(e,t){var i=this,n=c(e,t),s=this.cache[n],o=a.Deferred();return s?o.resolve(s):this.inputControlsService.getInputControlsPaginatedValues(e,t).then(function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var r=t[0];i.cache[n]=r,o.resolve(r)},function(){o.reject.apply(o,arguments)}),o}},{key:"setCacheValueForControlPaginatedValues",value:function(e,t,i){var n=c(e,t);this.cache[n]=i}},{key:"clearCache",value:function(){this.cache={}}}]),e}();i.exports=u}),define("runtime_dependencies/jrs-ui/src/controls/converter/inputControlsToViewModelConverter",["require","exports","module"],function(e,t,i){function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}i.exports={metadataToViewModelConverter:function(e){return e.inputControl.map(function(e){return n({},e,{uri:e.uri.replace("repo:","")})})}}}),define("runtime_dependencies/jrs-ui/src/controls/enum/inputControlTypeEnum",["require","exports","module"],function(e,t,i){var n;!function(e){e.BOOL="bool",e.SINGLE_VALUE_TEXT="singleValueText",e.SINGLE_VALUE_NUMBER="singleValueNumber",e.SINGLE_VALUE_DATE="singleValueDate",e.SINGLE_VALUE_DATE_TIME="singleValueDatetime",e.SINGLE_VALUE_TIME="singleValueTime",e.SINGLE_SELECT="singleSelect",e.SINGLE_SELECT_RADIO="singleSelectRadio",e.MULTI_SELECT="multiSelect",e.MULTI_SELECT_CHECKBOX="multiSelectCheckbox"}(n||(n={})),i.exports=n}),define("runtime_dependencies/jrs-ui/src/controls/converter/getControlPaginationOptionsByControlIdAndType",["require","exports","module","underscore","../enum/inputControlTypeEnum"],function(e,t,i){function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(i,!0).forEach(function(t){o(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var r,a=e("underscore"),l=e("../enum/inputControlTypeEnum"),c=function(e){return a.omit(e,["limit"])},u=(r={},o(r,l.SINGLE_SELECT_RADIO,function(e){return c(e)}),o(r,l.MULTI_SELECT_CHECKBOX,function(e){return c(e)}),r);i.exports=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=s({name:e,offset:0,limit:100},i),o=u[t];return o?o(n):n}}),define("runtime_dependencies/jrs-ui/src/controls/rest/enum/restParamsEnum",["require","exports","module"],function(e,t,i){var n;!function(e){e.SELECTED_VALUES="selectedValues",e.NOTHING_SUBSTITUTION_VALUE="~NOTHING~"}(n||(n={})),i.exports=n}),define("runtime_dependencies/jrs-ui/src/controls/predicate/isQueryControl",["require","exports","module","../enum/inputControlTypeEnum"],function(e,t,i){var n=e("../enum/inputControlTypeEnum"),s=[n.SINGLE_SELECT,n.MULTI_SELECT,n.SINGLE_SELECT_RADIO,n.MULTI_SELECT_CHECKBOX];i.exports=function(e){return s.indexOf(e.type)>-1}}),define("runtime_dependencies/jrs-ui/src/controls/converter/getControlsPaginationOptionsByControlId",["require","exports","module","underscore","./getControlPaginationOptionsByControlIdAndType"],function(e,t,i){function n(e){return r(e)||o(e)||s()}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function r(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(i,!0).forEach(function(t){c(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},u.apply(this,arguments)}var h=e("underscore"),d=e("./getControlPaginationOptionsByControlIdAndType"),p=function(e,t){return e.isAddedMap[t]?e:u({},e,{isAddedMap:l(c({},t,!0),e.isAddedMap),result:e.result.concat(t),immediateChildren:e.immediateChildren.concat(e.controls[t].slaveDependencies||[])})},m=function(e,t){for(var i=e.slaveDependencies||[],n={isAddedMap:{},result:[],immediateChildren:[],controls:t};i.length>0;)n.immediateChildren=[],n=i.reduce(p,n),i=n.immediateChildren;return{immediateAndTransitiveChildren:n.result,immediateAndTransitiveChildrenMap:n.isAddedMap}},f=function(e,t,i,n){var s,o={isAddedMap:{},result:[]};return e.length>0?s=e:(s=[i],o.result.push(i),o.isAddedMap[i]=!0),s.reduce(function(e,i){var s=n[i].masterDependencies||[];return s.length>0?s.reduce(function(e,i){return t[i]||e.isAddedMap[i]?e:u({},e,{isAddedMap:l(c({},i,!0),e.isAddedMap),result:e.result.concat(i)})},e):e},o).result};i.exports=function(e){var t=e.controlId,i=e.controls,s=i[t],o=m(s,i),r=o.immediateAndTransitiveChildren,a=o.immediateAndTransitiveChildrenMap;return[].concat(n(f(r,a,t,i).map(function(e){return l({},d(e,i[e].type,h.pick(i[e],["value"])))})),n(r.map(function(e){return l({},d(e,i[e].type,h.pick(i[e],["select"])))})))}}),define("runtime_dependencies/jrs-ui/src/controls/service/InputControlsReportViewerService",["require","exports","module","jquery","underscore","../converter/inputControlsToViewModelConverter","../converter/getControlPaginationOptionsByControlIdAndType","../rest/enum/restParamsEnum","../predicate/isQueryControl","../converter/getControlsPaginationOptionsByControlId"],function(e,t,i){function n(e,t){return r(e)||o(e,t)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],n=!0,s=!1,o=void 0;try{for(var r,a=e[Symbol.iterator]();!(n=(r=a.next()).done)&&(i.push(r.value),!t||i.length!==t);n=!0);}catch(e){s=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(s)throw o}}return i}}function r(e){if(Array.isArray(e))return e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),e}function u(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function h(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?u(i,!0).forEach(function(t){d(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):u(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var p=e("jquery"),m=e("underscore"),f=e("../converter/inputControlsToViewModelConverter"),g=e("../converter/getControlPaginationOptionsByControlIdAndType"),v=e("../rest/enum/restParamsEnum"),b=e("../predicate/isQueryControl"),C=e("../converter/getControlsPaginationOptionsByControlId"),S=function(e,t,i,n){return e.reduce(function(e,s){if(b(s)){var o=h({},e,d({},s.id,C({controlId:s.id,controls:t}).map(i)));return void 0!==n&&n(o[s.id]),o}return e},{})},_=function(e){var t=e.controlId,i=e.value,n=e.controls,s=e.selection,o=m.reduce(n,function(e,n){var o={};return o=n.id===t?{value:i.length>0?i:[v.NOTHING_SUBSTITUTION_VALUE]}:{value:s[n.id]||[],select:v.SELECTED_VALUES},h({},e,d({},n.id,h({masterDependencies:n.masterDependencies||[],slaveDependencies:n.slaveDependencies||[]},o)))},{});return C({controlId:t,controls:o})},w=function(){function e(t){a(this,e),d(this,"inputControlsService",void 0),d(this,"requestedSelectionParams",void 0),this.inputControlsService=t.inputControlsService,this.requestedSelectionParams={}}return c(e,[{key:"fetchInputControlsInitialState",value:function(e,t){var i=this;return this.inputControlsService.getInputControlsMetadata(e).then(function(n){if(n){var s=f.metadataToViewModelConverter(n);return i.fetchRequestParamsThroughURL(s,t),i.fetchInitialInputControlsValuesByUriAndStructure(e,s)}return p.Deferred().resolve(n)})}},{key:"fetchRequestParamsThroughURL",value:function(e,t){var i=this,n=m.pluck(e,"id"),s=m.keys(t),o=m.intersection(n,s);o.length>0&&o.forEach(function(e){i.requestedSelectionParams[e]=t[e]})}},{key:"fetchInitialInputControlsValuesByUri",value:function(e,t){return this.fetchInitialInputControlsValuesByUriAndStructure(e,t)}},{key:"fetchInputControlsOptionsBySelectionAndUri",value:function(e,t,i){var n=i.reduce(function(e,t){return h({},e,d({},t.id,t))},{}),s=m.map(e,function(t,i){return g(i,n[i].type,{value:t&&0===t.length?[v.NOTHING_SUBSTITUTION_VALUE]:e[i]||[]})}),o=S(i,n,function(t){return h({},t,{value:e[t.name]||[]})});return this.fetchInputControlsOptionsByPaginatedValuesOptionsAndUri({paginationOptions:s,paginationOptionsPerControl:o,uri:t}).then(function(e){return p.Deferred().resolve(e,s,o)})}},{key:"fetchInputControlsValuesOnControlSelectionChange",value:function(e){var t=e.controlId,i=e.value,n=e.uri,s=e.structure,o=e.selection,r=e.initialSelectedValues,a=i.reduce(function(e,t){return h({},e,d({},t,!0))},{}),l=s.reduce(function(e,t){return h({},e,d({},t.id,t))},{}),c=_({controlId:t,value:i,selection:o,controls:l}),u=r[t]&&r[t].every(function(e){return a[e.value]});return this.fetchInputControlsOptionsByPaginatedValuesOptionsAndUri({paginationOptions:c,uri:n}).then(function(e){var t=e.inputControlState,i=c.reduce(function(e,i){if(i.select===v.SELECTED_VALUES){var n=[];if(u&&r[i.name])n=r[i.name].map(function(e){return e.value});else{var s=t.find(function(e){return e.id===i.name});if(s){var o=s.options.find(function(e){return e.selected});n=o?[o.value]:[]}}return h({},e,d({},i.name,n))}return e},{});return p.Deferred().resolve(e,i,c)})}},{key:"fetchInitialInputControlsValuesByUriAndStructure",value:function(e,t){var i=this,s=t.map(function(e){return g(e.id,e.type,i.requestedSelectionParams[e.id]?{value:i.requestedSelectionParams[e.id]}:{select:v.SELECTED_VALUES})}),o=this.inputControlsService.getInputControlsPaginatedValues(e,s),r=this.inputControlsService.getInputControlsSelectedValues(e);return p.when(o,r).then(function(s,o){var r=n(o,1),a=r[0],l=s instanceof Array?s[0]:s,c={};c=m.isEmpty(i.requestedSelectionParams)?a?a.selectedValue.reduce(function(e,t){return h({},e,d({},t.id,t.options||[]))},{}):{}:l.inputControlState.reduce(function(e,t){var i=t.options?t.options.filter(function(e){return e.selected}).map(function(e){return m.omit(e,"selected")}):[{label:t.value,value:t.value}];return h({},e,d({},t.id,i||[]))},{});var u=t.reduce(function(e,t){return h({},e,d({},t.id,i.requestedSelectionParams[t.id]?h({},t,{value:i.requestedSelectionParams[t.id]}):h({},t,{select:v.SELECTED_VALUES})))},{}),f=S(t,u,function(e){return i.requestedSelectionParams[e.name]?h({},e,{value:i.requestedSelectionParams[e.name]}):h({},e,{select:v.SELECTED_VALUES})},function(t){i.inputControlsService.setCacheValueForControlPaginatedValues(e,t,l)});return p.Deferred().resolve({structure:t,selection:c,paginationOptionsPerControl:f,paginatedValuesResponse:l})})}},{key:"fetchInputControlsOptionsByPaginatedValuesOptionsAndUri",value:function(e){var t=this,i=e.paginationOptions,n=e.paginationOptionsPerControl,s=void 0===n?{}:n,o=e.uri;return this.inputControlsService.clearCache(),this.inputControlsService.getInputControlsPaginatedValues(o,i).then(function(e){return i.forEach(function(i){var n=i.name;s[n]&&t.inputControlsService.setCacheValueForControlPaginatedValues(o,s[n],e)}),e})}}]),e}();i.exports=w}),define("runtime_dependencies/jrs-ui/src/controls/controls.logging",["require","exports","module","../namespace/namespace"],function(e,t,i){var n=e("../namespace/namespace"),s=n.JRS;s.Log=function(e){window.console||(window.console={log:function(){},debug:function(){},error:function(){}})}(),i.exports=s.Log}),define("runtime_dependencies/jrs-ui/src/controls/controls.core",["require","exports","module","prototype","../namespace/namespace","../core/core.ajax","underscore","../components/components.dialogs","jquery","./controls.logging"],function(e,t,i){var n=e("prototype"),s=n.$,o=e("../namespace/namespace"),r=o.JRS,a=e("../core/core.ajax"),l=a.ajax,c=e("underscore"),u=e("../components/components.dialogs"),h=e("jquery");e("./controls.logging"),r.Controls=function(e,t,i){function n(e){return function(i){return t.template(e)(t.defaults({data:void 0,uuid:void 0,message:void 0,description:void 0},i))}}var o=navigator.userAgent.toLowerCase().indexOf("msie")>-1;return{Base:t.extend(function(){},{extend:function(e,i){var n,s=this;n=e&&t.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},t.extend(n,s,i);var o=function(){this.constructor=n};return o.prototype=s.prototype,n.prototype=new o,e&&t.extend(n.prototype,e),n.__super__=s.prototype,n}}),TemplateEngine:{render:function(e,i,s){if(!s)return n(e)(i);if(s==this.STD_PLACEHOLDERS){var o=String(e);return t.each(i,function(e,t){var i=new RegExp("\\{"+t+"\\}");o=o.replace(i,e)}),o}},renderUrl:function(e,i,n){var s=t.template(e)(i);return o&&!n&&(s=encodeURI(s)),s},getTemplateText:function(t){return e("#"+t).html()},createTemplate:function(t){var i=e("#"+t),s=i.html();if(s&&s.length>0)return n(s)},createTemplateSection:function(e,t){var i="\x3c!--#val--\x3e(\\s|\\S)*\x3c!--/val--\x3e",s=i.replace(/val/g,e),o=new RegExp(s,"g");return n(this.getTemplateText(t).match(o)[0])},STD_PLACEHOLDERS:"std_placeholder"},Utils:{LOADING_DIALOG_DELAY:800,INPUT_CONTROLS_COMPONENT_ID:"input-controls",isElementInDom:function(e){var t=e.nextSibling,i=e.parentNode&&11!==e.parentNode.nodeType;return t||i},setInnerHtml:function(i,n,s){var r,a,l;if(this.isElementInDom(i)&&(r=i.nextSibling,a=i.parentNode,l=i.style.display,i.style.display="none",a.removeChild(i)),e(i).html(""),o&&"SELECT"==i.tagName){var c=document.createDocumentFragment();t.each(s.data,function(i){var n=document.createElement("OPTION");n.value=t.isUndefined(i.value)?i.id:i.value,e(n).html(i.label),i.selected&&n.setAttribute("selected","selected"),c.appendChild(n)}),i.appendChild(c)}else e(i).html(n(s));if(r?a.insertBefore(i,r):a.appendChild(i),i.style.display=l,o&&"SELECT"==i.tagName){var u=i.getAttribute("style");i.removeAttribute("style"),i.setAttribute("style",u)}},wait:function(t){return e.Deferred(function(e){setTimeout(e.resolve,t)})},showLoadingDialogOn:function(n,o,r){this.wait(o||this.LOADING_DIALOG_DELAY).then(t.bind(function(){"pending"==n.state()&&(i.popup.showShared(s(l.LOADING_ID),r,{focus:!1,owner:this.INPUT_CONTROLS_COMPONENT_ID}),e.when(n).always(t.bind(function(){var e=this.INPUT_CONTROLS_COMPONENT_ID;this.wait(500).then(function(){window.viewer&&window.viewer.loading?window.viewer.loaded&&i.popup.hideShared(s(l.LOADING_ID),e):i.popup.hideShared(s(l.LOADING_ID),e)})},this)))},this))},createTimer:function(t){var i=new e.Deferred;return i.done(function(e){var i=(new Date).getTime(),n=i-e;console.log(t+" took time: "+n+" msec.")}),{start:function(){return this.startTime=(new Date).getTime(),this},stop:function(){return i.resolve(this.startTime),this}}}},listen:function(i,n){t.each(i,function(i,n){e(document).on(n,t.bind(i,this))},n||this)},ignore:function(t,i){e(document).off(t,i)}}}(h,c,u),window.Controls=r.Controls,i.exports=r.Controls}),define("runtime_dependencies/jrs-ui/src/controls/controls.dataconverter",["require","exports","module","../namespace/namespace","underscore","./controls.core"],function(e,t,i){var n=e("../namespace/namespace"),s=n.JRS,o=e("underscore");e("./controls.core"),function(e,t,i){var n=i.Base.extend({structureFormater:function(e){if(!e)return e;var i=t.map(e.inputControl,function(e){return e.readOnly="true"==String(e.readOnly),e.uri=e.uri.replace("repo:",""),e}),n=t.map(i,function(e){return e.state});return n=t.compact(n),t.each(i,function(e){delete e.state}),t.extend({structure:i},this.convertResponseToControlsState(n))},convertResponseToControlsState:function(e){var i={},n=e.inputControlState?e.inputControlState:e,s=function(e){var t={value:e.value,label:e.label};return"true"==String(e.selected)&&(t.selected=!0),t},o=function(e){return t.isArray(e)?t.map(e,s):[]},r=function(e){return t.isUndefined(e.value)||t.isNull(e.value)?o(e.options):e.value};return t.each(n,function(e){e&&e.uri&&(i[e.id]={error:t.isUndefined(e.error)?null:e.error,values:r(e)})}),{state:i}}});e.DataConverter=n}(s.Controls,o,s.Controls),i.exports=s.Controls}),define("runtime_dependencies/jrs-ui/src/controls/controls.datatransfer",["require","exports","module","../namespace/namespace","runtime_dependencies/js-sdk/src/jrs.configs","../components/components.dialogs","underscore","jquery","./controls.core","./controls.dataconverter"],function(e,t,i){var n=e("../namespace/namespace"),s=n.JRS,o=e("runtime_dependencies/js-sdk/src/jrs.configs"),r=e("../components/components.dialogs"),a=e("underscore"),l=e("jquery");e("./controls.core"),e("./controls.dataconverter"),s.Controls=function(e,t,i,n){function s(t){var s;try{try{s=e.parse(t.responseText)}catch(e){}if(s&&s.error)i.each(s.error,function(e){var t=n.getViewModel(),i=e.inputControlUri.replace("repo:",""),s=t.find({uri:i});e.errorCode?s.set({error:e.errorCode}):e.defaultMessage&&s.set({error:e.defaultMessage})});else if(t.getResponseHeader("LoginRequested")||401===t.status)document.location=o.urlContext;else if([400,500].indexOf(t.status)>=0||t.getResponseHeader("JasperServerError")&&!t.getResponseHeader("SuppressError")){var a="";if(s){var l=s.message||"Unknown error";if(s.parameters&&s.parameters.length>0){var c=i.template("<div><b>{{-message}}</b></div><p>{{ if (parameters) for (var i = 0; i < parameters.length; i++) { }}<div>{{-parameters[i]}}</div>{{ } }}</p>");a=c({message:l,parameters:s.parameters})}else a=l}else a=window.statusText;r.errorPopup.show(a)}}catch(e){}}return i.extend(n,{DataTransfer:n.Base.extend({CONTROLS_STRUCTURE_TEMPLATE_URI:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}",INITIAL_CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/values",CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values",constructor:function(e){this.dataConverter=e.dataConverter,this.initialize(e)},initialize:function(e){},setReportUri:function(e){this.currentReportUri=e},buildUrl:function(e,t,s){return t=i.isArray(t)?t.join(";"):t||"",n.TemplateEngine.renderUrl(s,{reportUri:e,controlIds:t})},sendRequest:function(n,r,a){var l={url:n,type:"GET",dataType:"json",cache:!1};i.isEmpty(r)||i.extend(l,{type:"POST",processData:!1,data:e.stringify(r),contentType:"application/json"});var c=i.defaults(a||{},l);return c.headers||(c.headers={}),i.defaults(c.headers,{"X-Suppress-Basic":"true","Accept-Language":o.userLocale.replace(/_/g,"-")}),t.ajax(c).fail(s)},fetchControlsStructure:function(e,t){var s=this.buildUrl(this.currentReportUri,e,this.CONTROLS_STRUCTURE_TEMPLATE_URI),o=this.sendRequest(s,t).then(i.bind(this.dataConverter.structureFormater,this.dataConverter));return n.Utils.showLoadingDialogOn(o,null,!0),o},updateControlsStructure:function(e,t){var n=this.buildUrl(t||this.currentReportUri,null,this.CONTROLS_STRUCTURE_TEMPLATE_URI);return this.sendRequest(n,e,{type:"PUT"}).then(i.bind(this.dataConverter.structureFormater,this.dataConverter))},fetchInitialControlValues:function(e,t){var i=this.buildUrl(e,null,this.INITIAL_CONTROLS_VALUES_TEMPLATE_URL),s=this.sendRequest(i,t).then(this.dataConverter.convertResponseToControlsState);return n.Utils.showLoadingDialogOn(s,null,!0),s},fetchControlsUpdatedValues:function(e,s){var o=this.buildUrl(this.currentReportUri,e,this.CONTROLS_VALUES_TEMPLATE_URL),r=this.dataConverter;this.fullUpdateDeferred&&"pending"==this.fullUpdateDeferred.state()&&this.fullUpdateDeferred.reject();var a=new t.Deferred,l=n.Utils.wait(n.DataTransfer.FREQUENT_CHANGES_MIN_DELAY);return l.done(i.bind(function(){this.sendRequest(o,s).then(r.convertResponseToControlsState).done(function(e){"pending"==a.state()&&a.resolve(e)}).fail(function(){a.reject(this,arguments)})},this)),a.fail(function(){l.reject()}),n.Utils.showLoadingDialogOn(a,null,!0),this.fullUpdateDeferred=a,a}},{CONTROLS_STRUCTURE_TEMPLATE_URI:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}",INITIAL_CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/values",CONTROLS_VALUES_TEMPLATE_URL:o.contextPath+"/rest_v2/reports{{=reportUri}}/inputControls/{{=controlIds}}/values",FREQUENT_CHANGES_MIN_DELAY:400})})}(JSON,l,a,s.Controls),i.exports=s.Controls}),define("runtime_dependencies/jrs-ui/src/controls/predicate/isControlInCascade",["require","exports","module"],function(e,t,i){i.exports=function(e){var t=e.slaveDependencies;return!!t&&t.length>0}}),define("runtime_dependencies/jrs-ui/src/controls/controls.basecontrol",["require","exports","module","../namespace/namespace","underscore","jquery","./controls.core"],function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=e("../namespace/namespace"),o=s.JRS,r=e("underscore"),a=e("jquery");e("./controls.core"),o.Controls=function(e,t,i){return t.extend(i,{BaseControl:i.Base.extend({id:null,elem:null,error:null,templateChunks:{},constructor:function(e){this.initialize.apply(this,arguments)},getElem:function(){return this.elem},setElem:function(e){this.elem=e},bindCustomEventListeners:function(){},isSingleSelect:function(){return!t.isArray(this.get("selection"))},isSingleValue:function(){return!t.isArray(this.get("values"))},getTemplateSection:function(e){return this.templateChunks[this.type+"_"+e]||(this.templateChunks[this.type+"_"+e]=i.TemplateEngine.createTemplateSection(e,this.type)),this.templateChunks[this.type+"_"+e]},initialize:function(){this.baseRender.apply(this,arguments),this.isVisible.apply(this,arguments)&&this.bindCustomEventListeners()},fireControlSelectionChangeEvent:function(t){e(document).trigger(i.CHANGE_CONTROL,{control:this,selection:t})},baseRender:function(n){n&&t.extend(this,n);var s=i.TemplateEngine.createTemplate(this.type);if(s){var o=e(s(this));this.setElem(o)}},setValue:function(e){},fetch:function(e){},render:function(){},get:function(e){return this[e]},isValid:function(){return null===this.error||this.error&&this.error instanceof String&&0===this.error.length},isVisible:function(e){return!e||void 0===e.visible||!0===e.visible},updateWarningMessage:function(){var e=null!=this.error?this.error:"";this.getElem()&&this.getElem().find(".warning").text(e)},reset:function(e){this.set(e);var t=this.get("values");this.isVisible(this)&&void 0===t&&this.setValue(t)},set:function(e,i){if(t.extend(this,e),void 0!==e.values){var n=e.values;this.isVisible(this)&&this.setValue(n),this.isSingleValue()?this.selection=n:this.isSingleSelect()?this.selection=n[0]:this.selection=n}if(void 0!==e.selection&&(this.isSingleValue()&&(this.values=e.selection),!i&&this.fireControlSelectionChangeEvent(e.selection)),void 0!==e.disabled&&!this.get("readOnly")){var s=e.disabled;i||(s?this.disable():this.enable())}void 0!==e.error&&(this.updateWarningMessage(),this.mandatory&&void 0===this.selection&&(this.selection=[]))},find:function(e){if(void 0!==e&&e&&"object"==n(e)){var i=t.keys(e)[0],s=t.values(e)[0];return t.find(this.get("values"),function(e){return e[i]===s})}},enable:function(){this.getElem().find("input").prop("disabled",!1),this.getElem().find("select").prop("disabled",!1)},disable:function(){this.getElem().find("input").prop("disabled",!0),this.getElem().find("select").prop("disabled",!0)}},{merge:function(e,i){return t.isNull(e)||t.isUndefined(e)?i:t.isNull(i)||t.isUndefined(i)?e:t.isArray(i)?t.map(e,function(e){return void 0!==t.find(i,function(t){return t===e.value})?e.selected=!0:delete e.selected,e}):this.merge(e,[i])}}),CHANGE_CONTROL:"changed:control"})}(a,r,o.Controls),i.exports=o.Controls}),function(e){"function"==typeof define&&define.amd?define("jquery-ui/ui/widgets/sortable",["jquery","./mouse","../data","../ie","../scroll-parent","../version","../widget"],e):e(jQuery)}(function(e){return e.widget("ui.sortable",e.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,i){return e>=t&&e<t+i},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),e.each(this.items,function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,i){var n=null,s=!1,o=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(t),e(t.target).parents().each(function(){if(e.data(this,o.widgetName+"-item")===o)return n=e(this),!1}),e.data(t.target,o.widgetName+"-item")===o&&(n=e(t.target)),!!n&&(!(this.options.handle&&!i&&(e(this.options.handle,n).find("*").addBack().each(function(){this===t.target&&(s=!0)}),!s))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(t,i,n){var s,o,r=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",r.cursor),this.storedStylesheet=e("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(o)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),
this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var i,n,s,o,r=this.options,a=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<r.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+r.scrollSpeed:t.pageY-this.overflowOffset.top<r.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-r.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<r.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+r.scrollSpeed:t.pageX-this.overflowOffset.left<r.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-r.scrollSpeed)):(t.pageY-this.document.scrollTop()<r.scrollSensitivity?a=this.document.scrollTop(this.document.scrollTop()-r.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<r.scrollSensitivity&&(a=this.document.scrollTop(this.document.scrollTop()+r.scrollSpeed)),t.pageX-this.document.scrollLeft()<r.scrollSensitivity?a=this.document.scrollLeft(this.document.scrollLeft()-r.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<r.scrollSensitivity&&(a=this.document.scrollLeft(this.document.scrollLeft()+r.scrollSpeed))),!1!==a&&e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],s=n.item[0],(o=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&!(s===this.currentItem[0]||this.placeholder[1===o?"next":"prev"]()[0]===s||e.contains(this.placeholder[0],s)||"semi-dynamic"===this.options.type&&e.contains(this.element[0],s))){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var n=this,s=this.placeholder.offset(),o=this.options.axis,r={};o&&"x"!==o||(r.left=s.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(r.top=s.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(r,parseInt(this.options.revert,10)||500,function(){n._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new e.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e(i).each(function(){var i=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);i&&n.push((t.key||i[1]+"[]")+"="+(t.key&&t.expression?i[1]:i[2]))}),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var i=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},i.each(function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")}),n},_intersectsWith:function(e){var t=this.positionAbs.left,i=t+this.helperProportions.width,n=this.positionAbs.top,s=n+this.helperProportions.height,o=e.left,r=o+e.width,a=e.top,l=a+e.height,c=this.offset.click.top,u=this.offset.click.left,h="x"===this.options.axis||n+c>a&&n+c<l,d="y"===this.options.axis||t+u>o&&t+u<r,p=h&&d;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:o<t+this.helperProportions.width/2&&i-this.helperProportions.width/2<r&&a<n+this.helperProportions.height/2&&s-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t,i,n="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),s="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);return!(!n||!s)&&(t=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection(),this.floating?"right"===i||"down"===t?2:1:t&&("down"===t?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return this.floating&&s?"right"===s&&i||"left"===s&&!i:n&&("down"===n&&t||"up"===n&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function i(){a.push(this)}var n,s,o,r,a=[],l=[],c=this._connectWith();if(c&&t)for(n=c.length-1;n>=0;n--)for(o=e(c[n],this.document[0]),s=o.length-1;s>=0;s--)(r=e.data(o[s],this.widgetFullName))&&r!==this&&!r.options.disabled&&l.push([e.isFunction(r.options.items)?r.options.items.call(r.element):e(r.options.items,r.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),r]);for(l.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return e(a)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var i=0;i<t.length;i++)if(t[i]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var i,n,s,o,r,a,l,c,u=this.items,h=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],d=this._connectWith();if(d&&this.ready)for(i=d.length-1;i>=0;i--)for(s=e(d[i],this.document[0]),n=s.length-1;n>=0;n--)(o=e.data(s[n],this.widgetFullName))&&o!==this&&!o.options.disabled&&(h.push([e.isFunction(o.options.items)?o.options.items.call(o.element[0],t,{item:this.currentItem}):e(o.options.items,o.element),o]),this.containers.push(o));for(i=h.length-1;i>=0;i--)for(r=h[i][1],a=h[i][0],n=0,c=a.length;n<c;n++)l=e(a[n]),l.data(this.widgetName+"-item",r),u.push({item:l,instance:r,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,s,o;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(s=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item,t||(n.width=s.outerWidth(),n.height=s.outerHeight()),o=s.offset(),n.left=o.left,n.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)o=this.containers[i].element.offset(),this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var i,n=t.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=t.currentItem[0].nodeName.toLowerCase(),s=e("<"+n+">",t.document[0]);return t._addClass(s,"ui-sortable-placeholder",i||t.currentItem[0].className)._removeClass(s,"ui-sortable-helper"),"tbody"===n?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(s)):"tr"===n?t._createTrPlaceholder(t.currentItem,s):"img"===n&&s.attr("src",t.currentItem.attr("src")),i||s.css("visibility","hidden"),s},update:function(e,s){i&&!n.forcePlaceholderSize||(s.height()||s.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),s.width()||s.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(n.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),n.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,i){var n=this;t.children().each(function(){e("<td>&#160;</td>",n.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(t){var i,n,s,o,r,a,l,c,u,h,d=null,p=null;for(i=this.containers.length-1;i>=0;i--)if(!e.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&e.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],p=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",t,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(s=1e4,o=null,u=d.floating||this._isFloating(this.currentItem),r=u?"left":"top",a=u?"width":"height",h=u?"pageX":"pageY",n=this.items.length-1;n>=0;n--)e.contains(this.containers[p].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[r],c=!1,t[h]-l>this.items[n][a]/2&&(c=!0),Math.abs(t[h]-l)<s&&(s=Math.abs(t[h]-l),o=this.items[n],this.direction=c?"up":"down"));if(!o&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return void(this.currentContainer.containerCache.over||(this.containers[p]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));o?this._rearrange(t,o,null,!0):this._rearrange(t,null,this.containers[p].element,!0),this._trigger("change",t,this._uiHash()),this.containers[p]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",t,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(t){var i=this.options,n=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||e("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),n[0].style.width&&!i.forceHelperSize||n.width(this.currentItem.width()),n[0].style.height&&!i.forceHelperSize||n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,n,s=this.options;"parent"===s.containment&&(s.containment=this.helper[0].parentNode),"document"!==s.containment&&"window"!==s.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===s.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===s.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(s.containment)||(t=e(s.containment)[0],i=e(s.containment).offset(),n="hidden"!==e(t).css("overflow"),this.containment=[i.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var n="absolute"===t?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(s[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:s.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:s.scrollLeft())*n}},_generatePosition:function(t){var i,n,s=this.options,o=t.pageX,r=t.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),s.grid&&(i=this.originalPageY+Math.round((r-this.originalPageY)/s.grid[1])*s.grid[1],r=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-s.grid[1]:i+s.grid[1]:i,n=this.originalPageX+Math.round((o-this.originalPageX)/s.grid[0])*s.grid[0],o=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-s.grid[0]:n+s.grid[0]:n)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:a.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:a.scrollLeft())}},_rearrange:function(e,t,i,n){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this.counter;this._delay(function(){s===this.counter&&this.refreshPositions(!n)})},_clear:function(e,t){function i(e,t,i){return function(n){i._trigger(e,n,t._uiHash(t))}}this.reverting=!1;var n,s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)"auto"!==this._storedCSS[n]&&"static"!==this._storedCSS[n]||(this._storedCSS[n]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&s.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||s.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(s.push(function(e){this._trigger("remove",e,this._uiHash())}),s.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)t||s.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(s.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(n=0;n<s.length;n++)s[n].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||e([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}),define("runtime_dependencies/jrs-ui/src/controls/controls.viewmodel",["require","exports","module","../namespace/namespace","underscore","jquery","runtime_dependencies/js-sdk/src/common/util/browserDetection","./rest/enum/restParamsEnum","./predicate/isControlInCascade","./controls.core","./controls.basecontrol","jquery-ui/ui/widgets/sortable"],function(e,t,i){var n=e("../namespace/namespace"),s=n.JRS,o=e("underscore"),r=e("jquery"),a=e("runtime_dependencies/js-sdk/src/common/util/browserDetection"),l=(e("./rest/enum/restParamsEnum"),e("./predicate/isControlInCascade"));e("./controls.core"),e("./controls.basecontrol"),e("jquery-ui/ui/widgets/sortable"),s.Controls=function(e,t,i){var n=a.isIE(),s=function(){var t,i=(new Date).getTime();return function(){var n=(new Date).getTime(),s=this;n-i>400&&(i=n,e(this).trigger("scrollstart")),clearTimeout(t),t=setTimeout(function(){e(s).trigger("scrollstop")},300)}}(),o=i.Base.extend({constructor:function(e){this.containerSelector=e&&e.containerSelector||i.ViewModel.DEFAULT_CONTAINER,this.controls={},i.getViewModel=t.bind(function(){return this},this),t.bindAll(this,"registerEvents","onControlChange"),this.registerEvents()},registerEvents:function(){i.ignore("changed:control",this.onControlChange),i.listen({"changed:control":this.onControlChange})},onControlChange:function(t,n){var s=n.control,o=n.selection,r=l(s);e(document).trigger(i.ViewModel.CHANGE_SELECTION,[s.id,o,r]),r||e(document).trigger(i.ViewModel.CHANGE_VALUES,[this.state])}},{DEFAULT_CONTAINER:"#inputControlsContainer",CHANGE_VALUES:"viewmodel:values:changed",CHANGE_SELECTION:"viewmodel:selection:changed",CHANGE_ORDER:"viewmodel:order:changed",isSelectionChanged:function(e,i){var n=e?t(e).keys():[],s=i?t(i).keys():[];if(t.union(n,s).length===n.length){var o=e?t.flatten(t(e).values()):[],r=i?t.flatten(t(i).values()):[];return t.difference(o,r).length>0||t.difference(r,o).length>0}return!0}}),r={getControls:function(){return this.controls},instantiate:function(e,t){var i=this;this.controls={};var n=t.dataUri,s=t.inputControlsService,o=t.initialSelectedValues,r=t.paginatedValuesOptions;e.forEach(function(e){var t=e.id;i.createControl(e,{dataUri:n,inputControlsService:s,initialSelectedValues:o[t]||[],paginatedValuesOptions:r[t]||[]})})},createControl:function(e,t){var n=function(e){for(var t in i)if(e.toLowerCase()===t.toLowerCase())return i[t]}(e.type);if(!n)throw new Error("Can not find implementation of the control type: "+e.type);return this.controls[e.id]=new n(e,t),this.controls[e.id]},removeControl:function(e){delete this.controls[e]},reorderControl:function(t,n){if(1!=this.structure.length){for(var s,o=t<n?1:-1,r=t<n?Math.min(t,n):Math.max(t,n),a=t<n?Math.max(t,n):Math.min(t,n),l=r;l!=a;l+=o)s=this.structure[l],this.structure[l]=this.structure[l+o],this.structure[l+o]=s;e(document).trigger(i.ViewModel.CHANGE_ORDER,[this.structure])}},set:function(n,s){if(n){t.extend(this,n);var o=n.structure,r=n.controlsOptions||{},a=r.initialSelectedValues;o&&(this.instantiate(o,n.controlsOptions),this.draw(o)),a&&(this.update(a),!s&&e(document).trigger(i.ViewModel.CHANGE_VALUES,a))}},get:function(e){if(e){if("selection"===e){var i={};return t.each(this.getControls(),function(e){var n=e.get("selection");n instanceof Array?i[e.id]=n:t.isUndefined(n)||(i[e.id]=[n])}),i}return this[e]}},findControl:function(e){var i=t.keys(e)[0],n=t.values(e)[0];return t.find(this.getControls(),function(e){return e[i]===n})},pluck:function(e){return t.pluck(this.getControls(),e)}},c={draw:function(e){var t=this,i=this.getContainer();if(i.empty(),n&&(i.attr("js-stdnav","false"),i.attr("js-navtype","none")),e.forEach(function(e){if(e.visible){var n=t.findControl({id:e.id});n.render(),i.append(n.getElem())}}),window.Report&&window.Report.icReorderEnabled){var s=window.Controls.layouts.LAYOUT_TOP_OF_PAGE===Report.reportControlsLayout;/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)||this._initSortable({container:i,horizontalLayout:s})}},update:function(e){var i=this;t.each(e,function(e,t){i.findControl({id:t}).set({values:e.map(function(e){return e.value}),error:null})})},getContainer:function(){return this.container&&1==this.container.length?this.container:(this.container=e(this.containerSelector),this.container)},removeValidationMessages:function(){t.each(this.getControls(),function(e){e.set({error:null})})},areAllControlsValid:function(){return t.isEmpty(t.filter(this.getControls(),function(e){return!e.isValid()}))},setContainer:function(t){this.container=e(t)},reloadContainer:function(){return this.container=e(this.containerSelector),this.container},disable:function(){t.each(this.getControls(),function(e){e.set({disabled:!0})})},enable:function(){t.each(this.getControls(),function(e){e.set({disabled:!1})})},_initSortable:function(i){var o=i.container,r=i.horizontalLayout,a=!1,l=this,c=e(o).sortable({delay:200,placeholder:r?"verticalPlaceholder":"horizontalPlaceholder",axis:r?"x":"y",items:"> .leaf",cancel:"input,textarea,button,select,option,.list.inputSet,.jr-mSizer",start:function(e,t){t.item.data("oldIndex",t.item.index()),a=!0},stop:t.bind(function(e,t){var i=t.item.data("oldIndex"),n=t.item.index();i!=n&&this.reorderControl(i,n),a=!1},this)});if(n){var u=i.parent||c.parent();u.off("scroll",s),u.off("scrollstart"),u.off("scrollstop"),u.on("scroll",s),u.on("scrollstart",function(){if(!a)try{c.sortable("destroy")}catch(e){}}),u.on("scrollstop",function(){!a&&l._initSortable({parent:u,container:o,horizontalLayout:r})})}}};return t.extend(o.prototype,r,c),t.extend(i,{ViewModel:o})}(r,o,s.Controls),i.exports=s.Controls}),define("runtime_dependencies/jrs-ui/src/controls/controls.base",["require","exports","module","prototype","../core/core.layout","../util/utils.common","../components/components.dialogs","jquery","underscore"],function(e,t,i){var n=e("prototype"),s=n.$,o=n.$$,r=n.Template,a=n.$break,l=e("../core/core.layout"),c=e("../util/utils.common"),u=c.matchAny,h=e("../components/components.dialogs"),d=e("jquery"),p=e("underscore"),m={INPUT_CONTROLS_FORM:"inputControlsForm",INPUT_CONTROLS_CONTAINER:"inputControlsContainer",INPUT_CONTROLS_DIALOG:"inputControls",SAVE_REPORT_OPTIONS_DIALOG:"saveValues",REPORT_OPTIONS_SELECTOR:"savedValues",TOOLBAR_CONTROLS_BUTTON:"ICDialog",DEFAULT_OPTION_TEXT:"Options",NULL_SUBSTITUTION_VALUE:null,NULL_SUBSTITUTION_LABEL:null,NOTHING_SUBSTITUTION_VALUE:null,_BUTTON_OK:"ok",_BUTTON_SAVE:"save",_BUTTON_REMOVE:"remove",_BUTTON_APPLY:"apply",_BUTTON_CANCEL:"cancel",TEMP_REPORT_CONTAINER:"tempReportContainer",WRAPPER_ERROR_FLAG_PREFIX_SELECTOR:"div[id^=error_]",WRAPPERS_ERRORS_DIV:"wrappersErrors",EVAL_SCRIPT_ELEMENT_NAME:"_evalScript",CONTROL_OPTIONS_TEXT:"Saved Values:",CALENDAR_ICON_SPAN:'<span class="button picker calTriggerWrapper" ></span>',_messages:{},getMessage:function(e,t){var i=this._messages[e];return i?new r(i).evaluate(t||{}):""},setControlError:function(e,t){e&&(e=s(e),t?(e.up().addClassName(l.ERROR_CLASS),e.nextSiblings()[0].update(t)):(e.up().removeClassName(l.ERROR_CLASS),e.nextSiblings()[0].update("")))},setControlsErrors:function(e){var t=o(m.WRAPPER_ERROR_FLAG_PREFIX_SELECTOR),i=0,n=-1;t.each(function(t){var s=!1;e&&e.each(function(e){if(t.id.indexOf(e[0])>-1)throw m.setControlError(t,e[1]),n<0&&(d("#inputControlsForm .leaf").each(function(e,t){e<i&&(n+=t.clientHeight)}),d(".groupBox .content .body")[0].scrollTop=n),s=!0,a;i++}),s||m.setControlError(t,"")})},buildParams:function(e){var t="";if(p.isObject(e)&&!p.isEmpty(e)){var i=function(e){return e.length>0&&"&"!=e[e.length-1]&&(e+="&"),e};p.each(e,function(e,n){t=i(t),p.isArray(e)?p.each(e,function(e){t=i(t),t+=n+"="+encodeURIComponent(e)}):t+=n+"="+encodeURIComponent(e)})}return t},buildSelectedDataUri:function(e,t){var i=m.buildParams(e);if(p.isObject(t)&&!p.isEmpty(t)){return i+"&"+m.buildParams(t)}return i}},f=function(e){var t=this;this._dom=s(m.INPUT_CONTROLS_DIALOG),this.buttonActions=e,d("#"+m.INPUT_CONTROLS_DIALOG).on("mouseup touchend","button",function(e){if(this.id&&!this.id.empty()&&!this.disabled){var i=t.buttonActions["button#"+this.id];i&&i()}})};f.addMethod("_dialogClickHandler",function(e){var t=e.element();for(var i in this.buttonActions)if(u(t,[i],!0))return this.buttonActions[i](),void e.stop()}),f.addMethod("show",function(){h.popup.show(this._dom)}),f.addMethod("hide",function(){h.popup.hide(this._dom)});var g=function(e){this._dom=s(m.SAVE_REPORT_OPTIONS_DIALOG),this.input=this._dom.select("input#savedValuesName")[0],this.overwrite=!1,this.buttonActions=e,this._dialogClickHandler=this._dialogClickHandler.bindAsEventListener(this),this._dom.observe("click",this._dialogClickHandler)};g.addMethod("remove",function(){this._dom.stopObserving("click",this._dialogClickHandler)}),g.addMethod("_dialogClickHandler",function(e){var t=e.element();for(var i in this.buttonActions)if(u(t,[i],!0))return this.buttonActions[i](),void e.stop()}),g.addMethod("show",function(){this.input.setValue(m.DEFAULT_OPTION_TEXT),h.popup.show(this._dom)}),g.addMethod("hide",function(){h.popup.hide(this._dom),this.hideWarning()}),g.addMethod("showWarning",function(e){var t=d("#"+m.SAVE_REPORT_OPTIONS_DIALOG).find(".warning");e&&t.text(e),t.show()}),g.addMethod("hideWarning",function(){var e=d("#"+m.SAVE_REPORT_OPTIONS_DIALOG).find(".warning");e.text(""),e.hide()}),t.ControlsBase=m,t.OptionsDialog=g,t.ControlDialog=f}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/listWithNavigationModelTrait",["require","exports","module","underscore"],function(e,t,i){var n=e("underscore"),s={activate:function(e,t){if("number"!=typeof e)return void this.setActive(n.extend({},t));if(t=t||{},e>=this.get("bufferStartIndex")&&e<=this.get("bufferEndIndex")){var i=this.get("items")[e-this.get("bufferStartIndex")];i&&this.setActive(n.extend(t,{index:e,item:i}))}else{var s=this;this.getData({offset:e,limit:1}).done(function(i){s.setActive(n.extend(t,{index:e,item:i.data[0]}))}).fail(this.fetchFailed)}},setActive:function(e){this.active&&e.index===this.active.index&&e.item.value===this.active.value||(this.active=e&&"number"==typeof e.index?{index:e.index,value:e.item.value,label:e.item.label}:void 0,e&&e.silent||(this.trigger("change"),this.trigger("active:changed",this.active)))},getActive:function(){return this.active}};i.exports=s}),define("runtime_dependencies/js-sdk/src/components/singleSelect/manager/KeyboardManager",["require","exports","module","underscore"],function(e,t,i){var n=e("underscore"),s=function(e){return this.initialize(e),this};n.extend(s.prototype,{systemKeyCodes:[16,17,18,91],keydownHandlers:{38:"onUpKey",40:"onDownKey",13:"onEnterKey",27:"onEscKey",36:"onHomeKey",35:"onEndKey",9:"onTabKey",33:"onPageUpKey",34:"onPageDownKey"},preventKeydownHandlers:{
33:"onPageUpKey",34:"onPageDownKey"},initialize:function(e){n.bindAll(this,"onKeydown"),e.keydownHandlers&&(this.keydownHandlers=e.keydownHandlers),this.stopPropagation=e.stopPropagation,this.keydownTimeout=e.keydownTimeout||200,this.context=e.context,this.deferredKeydownHandler=e.deferredKeydownHandler,this.immediateHandleCondition=e.immediateHandleCondition,this.immediateKeydownHandler=e.immediateKeydownHandler},onKeydown:function(e){this._isSystemKeyPressed(e)||(this._canImmediatelyHandleKeyboardEvent(e)?this._immediatelyHandleKeyboardEvent(e):this.deferredHandleKeyboardEvent(e),this.stopPropagation&&e.stopPropagation())},deferredHandleKeyboardEvent:function(e){this.deferredKeydownHandler&&(this.keydownTimeout>0?(clearTimeout(this.deferredTimeout),this.deferredTimeout=setTimeout(n.bind(this.deferredKeydownHandler,this.context,e),this.keydownTimeout)):this.deferredKeydownHandler.call(this.context,e))},_isSystemKeyPressed:function(e){return n.indexOf(this.systemKeyCodes,e.which)>-1},_immediateHandleCondition:function(e){return this.immediateHandleCondition&&this.immediateHandleCondition.call(this.context,e)},_canImmediatelyHandleKeyboardEvent:function(e){var t=this.keydownHandlers[""+e.which];return t&&"function"==typeof this.context[t]||this._immediateHandleCondition(e)},_immediatelyHandleKeyboardEvent:function(e){var t=this.keydownHandlers[""+e.which];t&&"function"==typeof this.context[t]?(this.context[t].call(this.context,e),this._immediatePreventdefaultHandler(e)):this._immediateHandleCondition(e)&&this.immediateKeydownHandler&&this.immediateKeydownHandler.call(this.context,e)},_immediatePreventdefaultHandler:function(e){this.preventKeydownHandlers[""+e.which]&&e.preventDefault()}}),i.exports=s}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/ScalableListModel",["require","exports","module","backbone","underscore"],function(e,t,i){var n=e("backbone"),s=e("underscore"),o=n.Model.extend({initialize:function(e){e=e||{},s.bindAll(this,"_fetchComplete","fetchFailed","afterFetchComplete","fetch"),this.set({items:[]},{silent:!0}),this.getData=e.getData,this.bufferSize=e.bufferSize||100,this.loadFactor=e.loadFactor||.95},_fetchComplete:function(e){this.attributes.total=e.total,this.set({items:e.data},{silent:!0}),this.attributes.bufferEndIndex=Math.max(0,Math.min(this.attributes.bufferStartIndex+this.bufferSize-1,this.attributes.bufferStartIndex+e.data.length-1)),this.attributes.bufferEndIndex<this.attributes.bufferStartIndex+this.bufferSize-1&&(this.attributes.total=Math.min(e.total,this.attributes.bufferEndIndex+1)),this.afterFetchComplete&&this.afterFetchComplete(e.data,this.attributes.total),this.trigger("change",this)},_isBufferReloadNecessary:function(e,t){if(void 0===this.get("bufferStartIndex")||void 0===this.get("bufferEndIndex"))return!0;if(e>=0&&e<this.get("bufferStartIndex")||t<this.get("total")&&t>this.get("bufferEndIndex"))return!0;if(e===this.get("bufferStartIndex")&&t===this.get("bufferEndIndex"))return!1;var i=1-(e-this.get("bufferStartIndex"))/this.bufferSize,n=1-(this.get("bufferEndIndex")-t)/this.bufferSize;return this.get("bufferStartIndex")>0&&i>=this.loadFactor||this.get("bufferEndIndex")<this.get("total")&&n>=this.loadFactor},afterFetchComplete:function(e,t){},fetchFailed:function(e,t){this.trigger("fetchFailed",e,t)},fetch:function(e){if(e=s.extend({top:this.get("bufferStartIndex")||0,bottom:this.get("bufferEndIndex")||this.bufferSize-1},e),e.force||this._isBufferReloadNecessary(e.top,e.bottom)){if(e.top!==this.attributes.bufferStartIndex||e.bottom!==this.attributes.bufferEndIndex||e.force){var t=e.top+Math.floor((e.bottom-e.top)/2),i=Math.floor(this.bufferSize/2);this.attributes.bufferStartIndex=Math.max(0,t-i),this.get("total")&&!e.force?this.attributes.bufferEndIndex=Math.min(this.get("total"),this.attributes.bufferStartIndex+this.bufferSize)-1:this.attributes.bufferEndIndex=this.attributes.bufferStartIndex+this.bufferSize-1}this.getData({offset:this.get("bufferStartIndex"),limit:this.get("bufferEndIndex")-this.get("bufferStartIndex")+1}).done(this._fetchComplete).fail(this.fetchFailed)}else this.afterFetchComplete&&this.afterFetchComplete(this.get("items"),this.get("total"))},reset:function(e){this.attributes={},this.set({items:[]},{silent:!0}),e&&e.silent||this.trigger("change",this)}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/BaseListWithSelectionModel",["require","exports","module","underscore","./ScalableListModel"],function(e,t,i){var n=e("underscore"),s=e("./ScalableListModel"),o=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.select(e.value,{silent:!0})},_addToSelection:function(e,t){throw"Not implemented"},_removeFromSelection:function(e,t){throw"Not implemented"},_clearSelection:function(){throw"Not implemented"},_selectionContains:function(e,t){throw"Not implemented"},_getSelection:function(){throw"Not implemented"},_triggerSelectionChange:function(e){e&&e.silent||this.trigger("change"),this.trigger("selection:change")},_addRangeToSelection:function(e,t,i){for(var n=0;n<e.length;n++)this._addToSelection(e[n].value,n+t);this.trigger("selection:addRange",{start:t,end:i,selection:this.getSelection()})},_fetchAllDataAndModifySelection:function(e,t){return this.getData().done(function(i){for(var n=0;n<i.data.length;n++)e(i.data[n].value,n);t&&t()}).fail(this.fetchFailed),this},addValueToSelection:function(e,t){return this.selectionStartIndex=t,this._addToSelection(e,t),this.trigger("selection:add",{value:e,index:t})},addRangeToSelection:function(e,t){if(void 0===this.selectionStartIndex)return void this.addValueToSelection(e,t);if(this.selectionStartIndex!==t){var i=Math.min(this.selectionStartIndex,t),n=Math.max(this.selectionStartIndex,t);if(this.selectionStartIndex=t,i>=this.get("bufferStartIndex")&&n<=this.get("bufferEndIndex")){var s=Array.prototype.slice.call(this.get("items"),i-this.get("bufferStartIndex"),n-this.get("bufferStartIndex")+1);this._addRangeToSelection(s,i,n)}else{var o=this;this.getData({offset:i,limit:n-i+1}).done(function(e){o._addRangeToSelection(e.data,i,n)}).fail(this.fetchFailed)}}},removeValueFromSelection:function(e,t){this._removeFromSelection(e,t),this.trigger("selection:remove",{value:e,index:t})},toggleSelection:function(e,t){this.selectionContains(e,t)?this.removeValueFromSelection(e,t):this.addValueToSelection(e,t)},selectionContains:function(e,t){return this._selectionContains(e,t)},clearSelection:function(){return this._clearSelection(),this.trigger("selection:clear")},getSelection:function(){return this._getSelection()},select:function(e,t){throw"Not implemented"},selectAll:function(){var e=this,t=!0;this._fetchAllDataAndModifySelection(function(i,n){t&&(e._clearSelection(),t=!1),e._addToSelection(i,n)},n.bind(this._triggerSelectionChange,this))},invertSelection:function(){var e=this;this._fetchAllDataAndModifySelection(function(t,i){e._selectionContains(t,i)?e._removeFromSelection(t,i):e._addToSelection(t,i)},n.bind(this._triggerSelectionChange,this))}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/ListWithSelectionModel",["require","exports","module","underscore","./BaseListWithSelectionModel"],function(e,t,i){var n=e("underscore"),s=e("./BaseListWithSelectionModel"),o=s.extend({_addToSelection:function(e,t){this.selection[t]=e},_removeFromSelection:function(e,t){this.selection[t]=void 0},_clearSelection:function(){this.selection=[]},_selectionContains:function(e,t){return this.selection[t]===e},_getSelection:function(){return this.selection},_isSelectionEmpty:function(e){if(!e)return!0;if(n.isArray(e)&&0===e.length)return!0;if(n.isArray(e)||"string"==typeof e)return!1;for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t])return!1;return!0},_selectPendingSelection:function(e,t){if(0===this.get("bufferStartIndex")&&this.get("bufferEndIndex")==this.get("total")-1)this._convertInitialArrayToSelection(this.get("items"),e,t);else{var i=this;this.getData().done(function(n){i._convertInitialArrayToSelection(n.data,e,t)}).fail(this.fetchFailed)}},_convertInitialArrayToSelection:function(e,t,i){for(var n=0;n<e.length;n++)t[e[n].value]&&this._addToSelection(e[n].value,n);this._triggerSelectionChange(i)},_triggerSelectionChange:function(e){this._calcSelectionStartIndex&&this._calcSelectionStartIndex(),s.prototype._triggerSelectionChange.call(this,e)},_calcSelectionStartIndex:function(){if(void 0===this.selectionStartIndex)for(var e in this.selection)if(this.selection.hasOwnProperty(e)&&void 0!==this.selection[e]){this.selectionStartIndex=parseInt(e,10);break}},select:function(e,t){if(this._clearSelection(),this._isSelectionEmpty(e))return void this._triggerSelectionChange(t);if(n.isArray(e)||"string"==typeof e){var i={};if("string"==typeof e)i[e]=!0;else for(var s=0;s<e.length;s++)i[e[s]]=!0;this._selectPendingSelection(i,t)}else{for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];void 0!==r&&this._addToSelection(r,o)}this._triggerSelectionChange(t)}}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/singleSelect/model/SingleSelectListModel",["require","exports","module","underscore","../../scalableList/model/ListWithSelectionModel","../../scalableList/model/listWithNavigationModelTrait"],function(e,t,i){var n=e("underscore"),s=e("../../scalableList/model/ListWithSelectionModel"),o=e("../../scalableList/model/listWithNavigationModelTrait"),r=s.extend(o);r=r.extend({setActive:function(e){o.setActive.call(this,n.extend(e,{silent:!0}));var t={};"number"==typeof e.index&&(t[e.index]=e.item.value),this.select(t)},_convertInitialArrayToSelection:function(e,t,i){for(var n=0;n<e.length;n++)t[e[n].value]&&(this._addToSelection(e[n].value,n),this.getActive()||o.setActive.call(this,{index:n,item:e[n],silent:!0}));this._triggerSelectionChange(i)},_convertSelectionObject:function(e){for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t]){var i=e[t];return{index:parseInt(t,10),value:i}}},_select:s.prototype.select,select:function(e,t){var i,s=!1;if(!e||"string"==typeof e||n.isArray(e))o.setActive.call(this,{silent:!0});else if(i=this._convertSelectionObject(e)){var r=this.getActive();r&&i.value===r.value&&i.index===r.index||(s=!0)}else o.setActive.call(this,{silent:!0});return s?this.activate(i.index):this._select(e,t),this}}),i.exports=r}),define("text!runtime_dependencies/js-sdk/src/components/scalableList/templates/viewPortChunksTemplate.htm",[],function(){return'{{_.each(chunks, function(chunk) { }}\n<div class="jr-jViewPortChunk" style="height: {{- chunk.height}}px">\n\n    <js-templateNonce></js-templateNonce>\n</div>\n{{ }); }}\n'}),define("text!runtime_dependencies/js-sdk/src/components/scalableList/templates/itemsTemplate.htm",[],function(){return'<ul class="jr-mSelectlist jr" style="top: {{- top}}px; position: relative;">\n\n    <js-templateNonce></js-templateNonce>\n    {{_.each(items, function(item) { }}\n    <li class="jr-mSelectlist-item {{ if (item.selected) print(\'jr-isSelected\'); }} {{ if (item.active) print(\' jr-isHovered\'); }} jr" title="{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}" data-index="{{- item.index}}">\n        <div class="jr-mSelectlist-item-wrapper jr">\n            <a class="jr-mSelectlist-item-text jr">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}</a>\n        </div>\n    </li>\n    {{ }); }}\n</ul>'}),define("runtime_dependencies/js-sdk/src/components/scalableList/view/ScalableList",["require","exports","module","jquery","backbone","underscore","../model/ScalableListModel","text!../templates/viewPortChunksTemplate.htm","text!../templates/itemsTemplate.htm"],function(e,t,i){var n=e("jquery"),s=e("backbone"),o=e("underscore"),r=e("../model/ScalableListModel"),a=e("text!../templates/viewPortChunksTemplate.htm"),l=e("text!../templates/itemsTemplate.htm"),c=s.View.extend({ListModel:r,listItemSelector:"li",events:{scroll:"onScroll",touchmove:"onScroll"},attributes:{style:"overflow-y: auto; height: 100px; min-height: 100px;"},initialize:function(e){return o.bindAll(this,"_fetchVisibleData"),this.model=e.model||new this.ListModel(e),this.chunksTemplate=o.template(e.chunksTemplate||a),this.itemsTemplate=o.template(e.itemsTemplate||l),this.defaultChunkHeight=this.chunkHeight=e.chunkHeight||1e6,this.scrollTimeout=void 0!==e.scrollTimeout?e.scrollTimeout:50,this.manualScrollInterval=e.manualScrollInterval||50,this.lazy=e.lazy,this.defaultItemHeight=e.listItemHeight||21,this.listItemSelector=e.listItemSelector||this.listItemSelector,this.render(),this.initListeners(),this.lazy||this.model.fetch(),this},initListeners:function(){this.listenTo(this.model,"change",this.onModelChange,this),this.listenTo(this.model,"fetchFailed",this.onFetchFailed,this)},render:function(){return this},onScroll:function(e){this.scrollTimeout>0?(clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(this._fetchVisibleData,this.scrollTimeout)):this._fetchVisibleData()},onModelChange:function(){this.renderData()},onFetchFailed:function(e,t){this.trigger("listRenderError",e,t)},postProcessChunkModelItem:function(e,t){e.index=this.model.get("bufferStartIndex")+t,void 0===e.label&&(e.label=e.value),e.label=n.trim(e.label)},_renderItems:function(){var e=this.model.get("bufferStartIndex"),t=this.model.get("bufferEndIndex"),i=this.itemsPerChunk?Math.ceil((e+1)/this.itemsPerChunk):1,s=this.itemsPerChunk?Math.ceil((t+1)/this.itemsPerChunk):1,o=this;this.$el.find(".jr-jViewPortChunk").each(function(r,a){var l=n(a),c=o._getChunkModel({index:r+1,firstChunkWithData:i,lastChunkWithData:s,bufferStart:e,bufferEnd:t,total:o.totalItems,itemsPerChunk:o.itemsPerChunk,itemHeight:o.itemHeight,chunkHeight:o.chunkHeight,model:o.model}),u=c?o.itemsTemplate(c):"",h=a.children[0];h&&a.removeChild(h),l.append(u)})},_renderViewChunks:function(e){var t,i=this;(this.totalItems!==this.model.get("total")||e)&&(this.totalItems=this.model.get("total"),t=Array.prototype.slice.call(this.$el[0].children),t.forEach(function(e){i.$el[0].removeChild(e)}),this.$el.append(this.chunksTemplate({_:o,chunks:this._getViewChunksModel()})),this.$firstViewChunk=this.$el.find(".jr-jViewPortChunk:first"))},_getViewChunksModel:function(){for(var e=this.itemsPerChunk?Math.ceil(this.totalItems/this.itemsPerChunk):1,t=e>0?this.itemHeight?this.totalItems*this.itemHeight-(e-1)*this.chunkHeight:this.chunkHeight:1,i=[],n=1;n<e;n++)i.push({height:this.chunkHeight});return i.push({height:t}),i},_calcViewPortConstants:function(){this.viewPortConstantsInitialized||(this.itemHeight=this.defaultItemHeight,this.$firstViewChunk&&(this.itemHeight=this.$el.find(this.listItemSelector+":first").outerHeight(!0),!this.itemHeight||this.itemHeight<=2?(this.itemHeight=this.defaultItemHeight,this.viewPortConstantsInitialized=!1):this.viewPortConstantsInitialized=!0),this._calcViewPortHeight(),this.itemsPerChunk=Math.floor(this.defaultChunkHeight/this.itemHeight),this.chunkHeight=this.itemsPerChunk*this.itemHeight,this._renderViewChunks(!0),this._renderItems())},resizeViewPort:function(e){this.viewPortHeight=e,this.$el.outerHeight(this.viewPortHeight),this.itemsPerView=Math.floor(this.viewPortHeight/this.itemHeight)-1,this.itemsPerChunk=Math.floor(this.defaultChunkHeight/this.itemHeight),this.chunkHeight=this.itemsPerChunk*this.itemHeight,this._renderViewChunks(!0),this._renderItems()},_calcViewPortHeight:function(){this.viewPortHeight=this.$el.height(),this.itemsPerView=Math.floor(this.viewPortHeight/this.itemHeight)-1},_getItemsPerView:function(){return this._calcViewPortConstants(),this.itemsPerView},_getChunkModel:function(e){var t=e.index;if(t<e.firstChunkWithData||t>e.lastChunkWithData)return null;var i=e.itemsPerChunk?Math.max(e.bufferStart,e.itemsPerChunk*(t-1)):e.bufferStart,n=e.itemsPerChunk?Math.min(e.bufferEnd,e.itemsPerChunk*t-1):e.bufferEnd,s=e.itemHeight?i*e.itemHeight-(t-1)*e.chunkHeight:0,r=Array.prototype.slice.call(e.model.get("items"),i-e.bufferStart,n-e.bufferStart+1);return o.each(r,function(t,n){this.postProcessChunkModelItem(t,n+(i-e.bufferStart))},this),{top:s,items:r}},_fetchVisibleData:function(){var e=this._getVisibleItems();this.model.fetch({top:e.top,bottom:e.bottom})},_getVisibleItems:function(){var e=this._getScrollPos(),t=this.model.get("total"),i=Math.min(t-this.itemsPerView,Math.floor(e/this.itemHeight));return{top:i,bottom:Math.min(t-1,i+this.itemsPerView+1)}},_getScrollPos:function(){this._calcViewPortConstants();var e=0;if(this.$firstViewChunk){var t=this.$el.offset(),i=this.$firstViewChunk.offset();t&&i&&(e=t.top-i.top)}return e},renderData:function(){return!this.lazy&&this.model.has("bufferStartIndex")&&this.model.has("bufferEndIndex")?(this.trigger("before:render:data"),this._renderViewChunks(),this._renderItems(),this._calcViewPortConstants(),this.trigger("render:data")):(this.lazy=null,this.model.fetch()),this},resize:function(){if(this.$el.is(":visible")){var e=this.$el.outerHeight();e!==this._componentHeight&&(this._componentHeight=e,this.viewPortConstantsInitialized=!1,this._calcViewPortConstants())}},fetch:function(e,t){this.lazy=!1,t=t||{};var i;t.keepPosition?i=this.$el.get(0).scrollTop:this.reset({silent:!0,lazy:!1}),this.model.once("change",function(){t.keepPosition&&this.$el.scrollTop(i),e&&e.apply(this,arguments)},this).fetch({force:!0})},reset:function(e){e=o.defaults(e||{},{lazy:!0}),this.$el.scrollTop(0),this.lazy=e.lazy,this.model.reset(e)},scrollTo:function(e){if("number"==typeof e){var t=this._getScrollPos();if(this.viewPortConstantsInitialized){this._calcViewPortHeight();var i=null,n=e*this.itemHeight;n<t?i=n:n+this.itemHeight>t+this.viewPortHeight&&(i=n+this.itemHeight-this.viewPortHeight),null!==i&&this.$el.scrollTop(i)}}}});i.exports=c}),define("runtime_dependencies/js-sdk/src/components/scalableList/view/ListWithSelection",["require","exports","module","jquery","underscore","../model/ListWithSelectionModel","./ScalableList"],function(e,t,i){var n=e("jquery"),s=e("underscore"),o=e("../model/ListWithSelectionModel"),r=e("./ScalableList"),a={LEFT:"left",RIGHT:"right"},l=r.extend({ListModel:o,initialize:function(e){return s.bindAll(this,"onGlobalMouseup","onGlobalMousemove","_autoScroll","fetch"),this.eventListenerPattern=e.eventListenerPattern||"li",this.markerClass=e.markerClass?e.markerClass:"",this.selectedClass=e.selectedClass?e.selectedClass:"jr-isSelected",this._initSelection(e.selection),r.prototype.initialize.call(this,e)},delegateEvents:function(){var e=r.prototype.delegateEvents.apply(this,arguments);return this.$el.on("mousedown",this.eventListenerPattern,s.bind(this.onMousedown,this)).on("mousemove",this.eventListenerPattern,s.bind(this.onMousemove,this)).on("dblclick",this.eventListenerPattern,s.bind(this.onMousedblclick,this)).on("contextmenu",this.eventListenerPattern,s.bind(this.onItemEvent,this,this.$el)).on("click",this.eventListenerPattern,s.bind(this.onItemEvent,this,this.$el)).on("mouseout",this.eventListenerPattern,s.bind(this.onItemEvent,this,this.$el)).on("mouseover",this.eventListenerPattern,s.bind(this.onItemEvent,this,this.$el)),e},undelegateEvents:function(){var e=r.prototype.undelegateEvents.apply(this,arguments);return this.$el.off("mouseup").off("mousedown").off("mousemove").off("dblclick").off("contextmenu").off("click").off("mouseout").off("mouseover"),e},_initSelection:function(e){e=s.extend({allowed:{}},e);var t=e.allowed,i=s.isObject(t)?t.left:t;this.selection={allowed:{left:void 0===i||i,right:void 0!==t.right&&t.right},multiple:void 0===e.multiple||e.multiple}},initListeners:function(){r.prototype.initListeners.call(this),this.listenTo(this.model,"selection:clear",this.clearSelection,this),this.listenTo(this.model,"selection:add",this.selectValue,this),this.listenTo(this.model,"selection:addRange",this.selectRange,this),this.listenTo(this.model,"selection:remove",this.deselectValue,this),n("body").on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},postProcessChunkModelItem:function(e,t){r.prototype.postProcessChunkModelItem.call(this,e,t),e.selected=this.model.selectionContains&&this.model.selectionContains(e.value,e.index)},onMousedblclick:function(e){if(!this.selection.multiple&&(this.selection.allowed.left||this.selection.allowed.right)&&!this.getDisabled()){var t=this._getDomItemData(e.currentTarget);this._singleSelect(e,t.value,t.index),this.selectionChanged&&(this._triggerSelectionChanged(),this._triggerDblclicked(),this.selectionChanged=!1)}},getItemByEvent:function(e){return this._getDomItemData(e.currentTarget).item},onItemEvent:function(e,t){var i=t.type,n=this.getItemByEvent(t);this.trigger("list:item:"+i,n,t)},onMousedown:function(e){if(!this.getDisabled()&&(this.selection.allowed.left&&1===e.which||this.selection.allowed.right&&3===e.which)){var t=1===e.which?a.LEFT:a.RIGHT;this.selection.multiple&&(this[t+"MouseButtonPressed"]=!0,this.mouseDownPos=this._getMousePos(e));var i=this._getDomItemData(e.currentTarget);this.selection.multiple?this._multiSelect(e,i.value,i.index):this._singleSelect(e,i.value,i.index)}},onMousemove:function(e){if(this._allowMouseMoveSelection()&&(this._stopAutoScroll(),this._mouseMoved(e,this.mouseDownPos))){this.mouseDownPos=this._getMousePos(e);var t=this._getDomItemData(e.currentTarget);this.model.selectionContains(t.value,t.index)||this.model.addRangeToSelection(t.value,t.index)}},onGlobalMouseup:function(e){var t=this;(this.leftMouseButtonPressed||this.rightMouseButtonPressed)&&(s.each(a,function(e){t[e+"MouseButtonPressed"]=!1}),delete this.mouseDownPos,this._stopAutoScroll(),this.selectionChanged&&(this._triggerSelectionChanged(),this.selectionChanged=!1))},onGlobalMousemove:function(e){this._allowMouseMoveSelection()&&(this.mousePosY=e.clientY,this.scrollInterval||(this.scrollInterval=setInterval(this._autoScroll,this.manualScrollInterval)))},clearSelection:function(){this.$el.find("li."+this.selectedClass+this.markerClass).removeClass(this.selectedClass),this.selectionChanged=!0},selectValue:function(e){this._selectItemByIndex(e.index),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},selectRange:function(e){var t=this,i=Math.max(this.model.get("bufferStartIndex"),e.start),s=Math.min(this.model.get("bufferEndIndex"),e.end);this.$el.find("li"+this.markerClass+":not(."+this.selectedClass+")").each(function(){var e=n(this),o=parseInt(e.attr("data-index"),10);if(o>=i&&o<=s){var r=t.model.get("items")[o-t.model.get("bufferStartIndex")];t.model.selectionContains(r&&r.value,o)&&e.addClass(t.selectedClass)}}),this.selectionChanged=!0},deselectValue:function(e){this._deselectItemByIndex(e.index),this.selection.multiple?this.selectionChanged=!0:this._triggerSelectionChanged()},_selectItemByIndex:function(e){this.$el.find("li"+this.markerClass+"[data-index='"+e+"']:not(."+this.selectedClass+")").addClass(this.selectedClass)},_deselectItemByIndex:function(e){this.$el.find("li[data-index='"+e+"']."+this.selectedClass+this.markerClass).removeClass(this.selectedClass)},_autoScroll:function(){var e,t=this.$el.offset().top,i=this.$el.scrollTop(),n=void 0!==this.scrollTop?this.scrollTop:i,s=!1;this.mousePosY<t?(e=n-3*this.itemHeight,s=e<i):this.mousePosY>t+this.viewPortHeight&&(e=n+3*this.itemHeight,s=e>i),s&&(this.$el.scrollTop(e),this.scrollTop=this.$el.scrollTop(),this._fetchVisibleData()),this._selectRangeOnAutoScroll(n,e)},_selectRangeOnAutoScroll:function(e,t){var i;if(e<t?i=this._getVisibleItems().bottom:e>t&&(i=this._getVisibleItems().top),i){var n=this.model.get("items")[i-this.model.get("bufferStartIndex")];n&&(this.model.selectionContains(n.value,i)||this.model.addRangeToSelection(n.value,i))}},_stopAutoScroll:function(){this.scrollInterval&&(clearInterval(this.scrollInterval),this.scrollInterval=void 0,this.scrollTop=void 0)},_multiSelect:function(e,t,i){e.shiftKey?this.model.addRangeToSelection(t,i):e.ctrlKey||e.metaKey?this._singleSelect(e,t,i):this.model.toggleSelection(t,i)},_singleSelect:function(e,t,i){this.model.clearSelection().addValueToSelection(t,i)},_triggerSelectionChanged:function(){this.trigger("selection:change",this.getValue())},_triggerDblclicked:function(){this.trigger("item:dblclick",this.getValue())},_getDomItemData:function(e){for(var t=n(e),i=t.attr("data-index");void 0===i;)t=t.parent(),i=t.attr("data-index");i=parseInt(i,10);var s=this.model.get("items")[i-this.model.get("bufferStartIndex")];return{item:s,value:s&&s.value,index:i}},_mouseMoved:function(e,t){return Math.abs(t.x-e.clientX)+Math.abs(t.y-e.clientY)>=1},_getMousePos:function(e){return{x:e.clientX,y:e.clientY}},_allowMouseMoveSelection:function(){return(this.selection.allowed.left&&this.leftMouseButtonPressed||this.selection.allowed.right&&this.rightMouseButtonPressed)&&this.selection.multiple&&!this.getDisabled()},getValue:function(){return this.model.getSelection()},setValue:function(e,t){return t=t||{},t&&t.silent||t.modelOptions&&t.modelOptions.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),t=t.modelOptions,this.model.select(e,t),this},selectAll:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.selectAll(),this},selectNone:function(e){return this.setValue({},e)},invertSelection:function(e){return e&&e.silent||this.model.once("selection:change",this._triggerSelectionChanged,this),this.model.invertSelection(),this},setDisabled:function(e){return this.disabled=e,this.disabled?this.$el.addClass("disabled"):this.$el.removeClass("disabled"),this},getDisabled:function(){return this.disabled},remove:function(){return n("body").off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove),r.prototype.remove.call(this)}});i.exports=l}),define("runtime_dependencies/js-sdk/src/components/scalableList/view/ListWithNavigation",["require","exports","module","./ListWithSelection","../model/ListWithSelectionModel","../model/listWithNavigationModelTrait"],function(e,t,i){var n=e("./ListWithSelection"),s=e("../model/ListWithSelectionModel"),o=e("../model/listWithNavigationModelTrait"),r=n.extend({canActivate:!0,initialize:function(e){e=e||{};var t=s.extend(o);e.model=e.model||new t(e),n.prototype.initialize.call(this,e)},onMousemove:function(e){if(n.prototype.onMousemove.call(this,e),!this.mouseMovePos||this._mouseMoved(e,this.mouseMovePos)){this.mouseMovePos=this._getMousePos(e);var t=this._getDomItemData(e.currentTarget);this.activate(t.index)}},setCanActivate:function(e){this.canActivate=e},getCanActivate:function(){return this.canActivate&&!this.getDisabled()},activateFirst:function(){this.activate(0)},activateLast:function(){this.activate(Math.max(0,this.model.get("total")-1))},activateNext:function(){this.activate(Math.min(this.model.get("total")-1,this._getActiveIndex()+1))},activatePrevious:function(){this.activate(Math.max(0,this._getActiveIndex()-1))},pageDown:function(){this.activate(Math.min(this.model.get("total")-1,this._getActiveIndex()+this._getItemsPerView()))},pageUp:function(){this.activate(Math.max(0,this._getActiveIndex()-this._getItemsPerView()))},getActiveValue:function(){return this.model.getActive&&this.model.getActive()},activate:function(e,t){if(this.getCanActivate()){var i=this.getActiveValue();if(i&&i.index===e)return;if(!t||!t.silent){var n=this;this.model.once("active:changed",function(){n.trigger("active:changed",n.getActiveValue())})}this.model.activate(e,t)}},postProcessChunkModelItem:function(e,t){n.prototype.postProcessChunkModelItem.call(this,e,t);var i=this._getActiveIndex&&this._getActiveIndex();e.active=void 0!==i&&i===this.model.get("bufferStartIndex")+t},_getActiveIndex:function(){var e=this.getActiveValue();return e&&e.index}});i.exports=r}),define("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelectList",["require","exports","module","underscore","../model/SingleSelectListModel","../../scalableList/view/ListWithNavigation"],function(e,t,i){var n=e("underscore"),s=e("../model/SingleSelectListModel"),o=e("../../scalableList/view/ListWithNavigation"),r=o.extend({events:n.extend({},o.prototype.events,{"mouseup li":"onMouseup"}),initialize:function(e){var t=e.model||new s(e);o.prototype.initialize.call(this,n.extend({model:t,lazy:!0,selection:{allowed:!0,multiple:!1}},e))},onMouseup:function(){this.trigger("item:mouseup")},activate:function(e){if(this.getCanActivate()){var t=this.getActiveValue();if(t&&t.index===e)return;this.model.once("selection:change",this._triggerSelectionChanged,this).activate(e)}}});i.exports=r}),define("runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider",["require","exports","module","jquery","underscore"],function(e,t,i){var n=e("jquery"),s=e("underscore"),o=function(e){s.bindAll(this,"getData","_filterValues","_shouldFilter"),this.indexMapping={},this.internalGetData=e.getData};s.extend(o.prototype,{getData:function(e){var t=new n.Deferred;if(e&&void 0!==e.criteria)return this.dataCache=null,this.criteria=e.criteria,t.resolve(),t.promise();var i=this;return i._shouldFilter()?(this.dataCache?this._resolvePromise(e,t):this.internalGetData().done(function(n){i.indexMapping={},i.reverseIndexMapping={},i.dataCache=i._filterValues(n.data),i._resolvePromise(e,t)}).fail(t.reject),t.promise()):(this.indexMapping=null,this.reverseIndexMapping=null,this.dataCache=null,this.internalGetData(e))},getIndexMapping:function(){return this.indexMapping},getReverseIndexMapping:function(){return this.reverseIndexMapping},_resolvePromise:function(e,t){var i=e&&e.offset?e.offset:0,n=e&&e.limit?i+e.limit:this.dataCache.length,s=this._getDataSegment(this.dataCache,i,n);t.resolve({data:s,total:this.dataCache.length})},_shouldFilter:function(){return this.criteria},_filterValues:function(e){for(var t=[],i=0,n=0;n<e.length;n++){var s=e[n];(void 0===s.label?s.value:s.label).toLowerCase().indexOf(this.criteria.toLowerCase())>-1&&(t[i]=s,this.indexMapping[i]=n,this.reverseIndexMapping[n]=i,i+=1)}return t},_getDataSegment:function(e,t,i){i=Math.min(i,e.length);for(var n=[],s=t;s<i;s++)n.push({label:e[s].label,value:e[s].value});return n}}),i.exports=o}),define("runtime_dependencies/js-sdk/src/components/singleSelect/manager/DropDownManager",["require","exports","module","underscore","jquery"],function(e,t,i){var n=e("underscore"),s=e("jquery"),o=s("body"),r=function(e){return this.initialize(e),this};n.extend(r.prototype,{initialize:function(e){n.bindAll(this,"checkOffset","setNewOffset"),this.$dropDownEl=e.dropDownEl,this.calcOffset=e.calcOffset,this.isOffsetChanged=e.isOffsetChanged||this._isOffsetChanged,this.recalcInterval=e.recalcInterval||500,this.onOffsetChanged=e.onOffsetChanged},startCalc:function(){this.checkOffset(this.setNewOffset),clearInterval(this.recalcTimer),this.recalcTimer=setInterval(n.bind(this.checkOffset,this,this.onOffsetChanged),this.recalcInterval)},stopCalc:function(){clearInterval(this.recalcTimer)},checkOffset:function(e){var t=this.calcOffset(),i=this.$dropDownEl.position(),n=o.offset();(n.top||n.left)&&(i.top+=n.top,i.left+=n.left),this.$dropDownEl.width()!==t.width&&this.setNewOffset(t),this.isOffsetChanged(i,t)&&e&&e(t)},setNewOffset:function(e){this.$dropDownEl.css("top",e.top-o.offset().top).css("left",e.left-o.offset().left).css("width",e.width)},_isOffsetChanged:function(e,t){return Math.floor(e.top)!==Math.floor(t.top)||Math.floor(e.left)!==Math.floor(t.left)}}),i.exports=r}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/singleSelectTemplate.htm",[],function(){
return'<div class="jr-mSingleselect jr">\n\n    <js-templateNonce></js-templateNonce>\n    <a class="jr-mSingleselect-input jr">\n        <span class="jr-mSingleselect-input-placeholder jr">{{- i18n[\'sic.singleselect.select.one\'] }}</span>\n        <span class="jr-mSingleselect-input-selection jr">{{- value}}</span>\n        <div class="jr-mSingleselect-input-expander jr"></div>\n    </a>\n    <div class="jr-mSingleselect-search jr">\n        <input type="text" placeholder="{{- i18n[\'sic.multiselect.search\'] }}" class="jr-mInput-search jr" value="{{- value}}">\n    </div>\n</div>\n'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/singleSelectTemplate_IE10_11.htm",[],function(){return'<div class="jr-mSingleselect jr">\n\n    <js-templateNonce></js-templateNonce>\n    <a class="jr-mSingleselect-input jr">\n        <span class="jr-mSingleselect-input-placeholder jr">Click to select item...</span>\n        <span class="jr-mSingleselect-input-selection jr">{{- value}}</span>\n        <div class="jr-mSingleselect-input-expander jr"></div>\n    </a>\n    <div class="jr-mSingleselect-search jr">\n        <input type="text" class="jr-mInput-search jr" value="{{- value}}">\n    </div>\n</div>\n'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/listTemplate.htm",[],function(){return'<div class="jr-mScalablelist jr" draggable="false" ondragstart="return false" unselectable="on" onselectstart="return false">\n\n    <js-templateNonce></js-templateNonce>\n</div>'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/itemsTemplate.htm",[],function(){return'<ul class="jr-mSelectlist jr" style="top: {{- top}}px;">\n\n    <js-templateNonce></js-templateNonce>\n    {{_.each(items, function(item) { }}\n    <li class="jr-mSelectlist-item {{ if (item.selected) print(\'jr-isSelected\'); }} jr" title="{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}" data-index="{{- item.index}}">\n        <div class="jr-mSelectlist-item-wrapper jr">\n            <a class="jr-mSelectlist-item-text jr">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}</a>\n        </div>\n    </li>\n    {{ }); }}\n</ul>'}),define("text!runtime_dependencies/js-sdk/src/components/singleSelect/templates/dropDownTemplate.htm",[],function(){return'<div class="jr-mSingleselect-dropdownContainer jr">\n    <js-templateNonce></js-templateNonce>\n    <div class="jr-mSingleselect-dropdown jr"></div>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelect",["require","exports","module","jquery","backbone","underscore","../manager/KeyboardManager","./SingleSelectList","../model/SingleSelectListModel","../dataprovider/SearcheableDataProvider","../manager/DropDownManager","text!../templates/singleSelectTemplate.htm","text!../templates/singleSelectTemplate_IE10_11.htm","text!../templates/listTemplate.htm","text!../templates/itemsTemplate.htm","text!../templates/dropDownTemplate.htm","bundle!ScalableInputControlsBundle","../../../common/util/browserDetection","../../../common/util/xssUtil"],function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=e("jquery"),o=e("backbone"),r=e("underscore"),a=e("../manager/KeyboardManager"),l=e("./SingleSelectList"),c=e("../model/SingleSelectListModel"),u=e("../dataprovider/SearcheableDataProvider"),h=e("../manager/DropDownManager"),d=e("text!../templates/singleSelectTemplate.htm"),p=e("text!../templates/singleSelectTemplate_IE10_11.htm"),m=e("text!../templates/listTemplate.htm"),f=e("text!../templates/itemsTemplate.htm"),g=e("text!../templates/dropDownTemplate.htm"),v=e("bundle!ScalableInputControlsBundle"),b=e("../../../common/util/browserDetection"),C=e("../../../common/util/xssUtil"),S=s("body"),_=o.View.extend({events:function(){return{keydown:this.keyboardManager.onKeydown,input:this.keyboardManager.onKeydown,"focus input":"onFocus","blur input":"onBlur",mousedown:"onMousedown",mouseup:"onMouseup","click .jr-mSingleselect-input":"onClickOnInput"}},initialize:function(e){r.bindAll(this,"onGlobalMouseup","onGlobalMousedown","onGlobalMousemove","onMousedown","calcOffsetForListView","collapse"),this.model||(this.model=new o.Model),this.model.set("expanded",!1,{silent:!0}),this.model.set("criteria","",{silent:!0}),this.model.set("value",{},{silent:!0});var t=d;(b.isIE10()||b.isIE11())&&(t=p),this.dropUpDirection=!1,this.label=e.label,this.template=r.template(e.template||t),this.dropDownTemplate=r.template(e.dropDownTemplate||g),this.keyboardManager=new a({keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0}),this.listViewModel=this._createListViewModel(e),this.listView=this._createListView(e),this.render(),this.dropDownManager=new h({dropDownEl:this.$dropDownElContainer,calcOffset:this.calcOffsetForListView,isOffsetChanged:this.isDimensionsChangedforListView,onOffsetChanged:this.collapse}),this.initListeners(),this.setValue(e.value,{modelOptions:{silent:!0}})},_createListView:function(e){return new l({el:e.listElement||s(m),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate||f,scrollTimeout:e.scrollTimeout})},_createListViewModel:function(e){return this.searcheableDataProvider=new u({getData:e.getData}),new c({getData:this._getGetData(),bufferSize:e.bufferSize,loadFactor:e.loadFactor})},_getGetData:function(){return this.searcheableDataProvider.getData},_getActiveValueIndex:function(e){var t=this.searcheableDataProvider.getIndexMapping();return t?t[e.index]:e.index},initListeners:function(){this.listenTo(this.listView,"selection:change",this.selectionChange,this),this.listenTo(this.listView,"item:mouseup",this.itemMouseup,this),this.listenTo(this.listView,"listRenderError",this.listRenderError,this),this.listenTo(this.model,"change:expanded",this.changeExpandedState,this),this.listenTo(this.model,"change:value",this.changeValue,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.model,"change:criteria",this.changeFilter,this),this.$dropDownEl.on("mousedown",this.onMousedown),S.on("mousedown",this.onGlobalMousedown).on("dataavailable",this.onGlobalMousedown).on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove)},render:function(){var e=s(this.template({label:this.label,isIPad:b.isIPad(),value:this.model.get("value").label,expanded:this.model.get("expanded"),i18n:v}));return this.renderListView(),this.$el.empty(),this.$el.append(e),this.$singleSelect=e,this.$searchBlock=this.$el.find(".jr-mSingleselect-search"),this.$inputBlock=this.$el.find(".jr-mSingleselect-input"),this.$input=this.$searchBlock.find("input"),this},renderListView:function(){this.listRendered||(this.$dropDownElContainer=s(this.dropDownTemplate({isIPad:"iPad"===navigator.platform})),this.$dropDownEl=this.$dropDownElContainer.find(".jr-mSingleselect-dropdown"),this.listView.undelegateEvents(),this.$dropDownEl.append(this.listView.$el),S.append(this.$dropDownElContainer),this.listView.delegateEvents(),this.listRendered=!0),this.$scalablelist=this.$dropDownElContainer.find(".jr-mScalablelist"),this.model.get("expanded")?this.$dropDownElContainer.show():this.$dropDownElContainer.hide()},renderData:function(){return this.listView.renderData(),this},listRenderError:function(e,t){this.trigger("listRenderError",e,t)},itemMouseup:function(){if(!this.model.get("disabled")){delete this.preventBlur,this.$input.focus();var e=this.model.get("activeValue");e.value!==this.model.get("value").value?(this.model.unset("activeValue"),this.model.set("value",e)):this.collapse()}},selectionChange:function(){var e=this.listView.getActiveValue();e?(this.listView.scrollTo(e.index),this.model.set("activeValue",{value:e.value,label:e.label,index:this._getActiveValueIndex(e)}),this.updateValueFromActive()):this.model.unset("activeValue")},onClickOnInput:function(){this.model.get("expanded")?this.collapse():this.expand()},onFocus:function(){this.model.get("expanded")||this.$inputBlock.addClass("jr-isFocused")},onBlur:function(){this.preventBlur||(this.collapse(),this.$inputBlock.removeClass("jr-isFocused"))},onMousedown:function(){this.preventBlur=!0},onMouseup:function(){this.preventBlur&&(delete this.preventBlur,this.model.get("expanded")&&this.$input.focus())},changeExpandedState:function(e){e.get("expanded")?this.doExpand():this.doCollapse()},changeValue:function(){this.collapse(),this.updateControlLabel(),this.silent?delete this.silent:this.trigger("selection:change",this.model.get("value").value),this.$input.val(""),this.model.set("criteria","")},changeDisabled:function(){var e=this.model.get("disabled");e?(this.$input.attr("disabled","disabled"),this.collapse()):this.$input.removeAttr("disabled"),this.listView.setDisabled(e)},onGlobalMousedown:function(e){if(this.model.get("expanded")){if(e.target===this.el||this.$el.find(e.target).length>0||e.target===this.$dropDownEl[0]||this.$dropDownEl.find(e.target).length>0)return void this.$input.focus();this.preventBlur=!1}this.onBlur()},onGlobalMouseup:function(){this.onMouseup()},onGlobalMousemove:function(e){this.preventBlur&&e.stopPropagation()},onUpKey:function(){if(this.model.get("expanded")){var e=this.listView.getActiveValue();if(!e||0===e.index)return void this.collapse();this.listView.activatePrevious()}else this.expand()},onDownKey:function(){if(this.model.get("expanded")){this.listView.getActiveValue()?this.listView.activateNext():this.listView.activateFirst()}else this.expand()},onEnterKey:function(e){e.preventDefault(),this.model.get("expanded")?this.model.get("activeValue")?this.itemMouseup():this.collapse():this.expand()},onEscKey:function(){this.model.get("expanded")&&this.collapse()},onHomeKey:function(){this.model.get("expanded")?this.listView.activateFirst():this.expand()},onEndKey:function(){this.model.get("expanded")?this.listView.activateLast():this.expand()},onPageUpKey:function(){this.model.get("expanded")?this.listView.pageUp():this.expand()},onPageDownKey:function(){this.model.get("expanded")?this.listView.pageDown():this.expand()},onTabKey:function(){},updateDropDirection:function(){var e=s("html").scrollTop(),t=this.$el.offset(),i=this.$el.height(),n=this.$searchBlock.outerHeight(),o=t.top-e,r=s(window).height()-o-i;this.dropUpDirection=o>r;var a=this.dropUpDirection?o:r;a-=n+i,this.$scalablelist.css("max-height",a+"px")},doExpand:function(){this.updateDropDirection(),this.dropUpDirection&&(this.$dropDownEl.addClass("jr-mSingleselect-dropdownTop"),this.$singleSelect.addClass("jr-mSingleselectTop")),this.$searchBlock.addClass("jr-isOpen"),this.$inputBlock.addClass("jr-isOpen"),this.$inputBlock.removeClass("jr-isFocused"),this.$input.focus(),this.listView.onScroll(),this.expandListView(),this.listView.lazy?this.listView.fetch(r.bind(this.listView.resize,this.listView)):this.listView.resize(),void 0!==this.model.get("value").value&&this.setValueToList(),this.trigger("expand",this)},expandListView:function(){this.$dropDownElContainer.show(),this.dropDownManager.startCalc()},doCollapse:function(){this.model.unset("activeValue"),this.$searchBlock.removeClass("jr-isOpen"),this.$inputBlock.removeClass("jr-isOpen"),this.$dropDownEl.removeClass("jr-mSingleselect-dropdownTop"),this.$singleSelect.removeClass("jr-mSingleselectTop"),this.$inputBlock.addClass("jr-isFocused"),this.$input.val(""),this.$dropDownElContainer.hide(),this.model.set("criteria",""),this.dropDownManager.stopCalc(),this.trigger("collapse",this)},calcOffsetForListView:function(){var e,t=this.$el.offset(),i=S.offset().left+t.left,n=this.$el.height();return e=this.dropUpDirection?S.offset().top+t.top-this.$searchBlock.outerHeight():S.offset().top+t.top+n+this.$searchBlock.height(),{top:e,left:i,width:this.el.getBoundingClientRect().width}},isDimensionsChangedforListView:function(e,t){return Math.floor(e.top)!==Math.floor(t.top)||Math.floor(e.left)!==Math.floor(t.left)},immediateHandleCondition:function(e){return!this.model.get("expanded")},immediateKeydownHandler:function(e){this.expand(),this.keyboardManager.deferredHandleKeyboardEvent(e)},processKeydown:function(){this.model.set("criteria",this.$input.val())},changeFilter:function(){var e=this;this._getGetData()({criteria:this.model.get("criteria")}).done(function(){e.listView.fetch(function(){e.setValueToList()})})},setValueToList:function(e){var t=this.model.get("value"),i=t.value;if(void 0!==t.index){var n=this.searcheableDataProvider.getReverseIndexMapping(),s=n?n[t.index]:t.index;i={},void 0!==s&&(i[s]=t.value)}this.listView.setValue(i,e)},convertExternalValueToInternalFormat:function(e){var t={};if(void 0!==e)if("string"==typeof e||null===e)t={value:e};else for(var i in e)if(e.hasOwnProperty(i)&&void 0!==e[i]){t="object"===n(e[i])?{value:e[i].value,index:parseInt(i,10),label:e[i].label}:{value:e[i],index:parseInt(i,10)};break}return t},updateValueFromActive:function(){var e=this.model.get("value"),t=this.model.get("activeValue");e.value===t.value&&void 0===e.label&&(e.label=t.label,this.updateControlLabel())},updateControlLabel:function(){var e,t=this.model.get("value"),i=this.$inputBlock.find(".jr-mSingleselect-input-placeholder"),n=this.$inputBlock.find(".jr-mSingleselect-input-selection");r.isEmpty(t)||null==t.value?(i.removeClass("jr-isHidden"),this.render()):(e=this.getControlLabelByValue(t),i.addClass("jr-isHidden"),this.$inputBlock.attr("title",e),n.html(C.hardEscape(e)))},getControlLabelByValue:function(e){return null==e.label?e.value:e.label},fetch:function(e,t){return this.listView.fetch(e,t),this},reset:function(e){return this.listView.reset(e),this},expand:function(){if(!this.model.get("disabled"))return this.model.set("expanded",!0),this},collapse:function(){return this.model.set("expanded",!1),this},getValue:function(){return this.model.get("value").value},setValue:function(e,t){var e=this.convertExternalValueToInternalFormat(e);t&&t.silent&&(this.silent=!0),this.model.set("value",e),this.setValueToList()},setDisabled:function(e){return this.model.set("disabled",e),this},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.$dropDownEl.off("mousedown",this.onMousedown).remove(),this.listView.remove(),this.$dropDownElContainer.remove(),o.View.prototype.remove.call(this),S.off("mousedown",this.onGlobalMousedown).off("dataavailable",this.onGlobalMousedown).off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove)}});i.exports=_}),define("runtime_dependencies/js-sdk/src/components/scalableList/model/ListWithSelectionAsObjectHashModel",["require","exports","module","underscore","./BaseListWithSelectionModel"],function(e,t,i){var n=e("underscore"),s=e("./BaseListWithSelectionModel"),o=s.extend({_addToSelection:function(e,t){this.selection[e]=!0},_removeFromSelection:function(e,t){delete this.selection[e]},_clearSelection:function(){this.selection={}},_selectionContains:function(e,t){return this.selection[e]},_getSelection:function(){return n.keys(this.selection)},select:function(e,t){if(this._clearSelection(),"string"==typeof e)this._addToSelection(e);else if(n.isArray(e))for(var i=0;i<e.length;i++)this._addToSelection(e[i]);else if(void 0!==e)for(var s in e)if(e.hasOwnProperty(s)){var o=e[s];void 0!==o&&this._addToSelection(o,s)}this._afterSelect&&this._afterSelect(e,t),this._triggerSelectionChange(t)}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/singleSelect/model/SingleSelectListModelNew",["require","exports","module","./SingleSelectListModel","../../scalableList/model/ListWithSelectionAsObjectHashModel"],function(e,t,i){var n=e("./SingleSelectListModel"),s=e("../../scalableList/model/ListWithSelectionAsObjectHashModel"),o=s.prototype,r=n.extend({_addToSelection:o._addToSelection,_removeFromSelection:o._removeFromSelection,_clearSelection:o._clearSelection,_selectionContains:o._selectionContains,_getSelection:o._getSelection,_calcSelectionStartIndex:void 0,_select:o.select});i.exports=r}),define("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelectNew",["require","exports","module","underscore","../../scalableList/model/listWithNavigationModelTrait","./SingleSelect","../model/SingleSelectListModelNew"],function(e,t,i){function n(e,t){if(t&&"string"==typeof t&&!this.getActive()){var i=e(t);void 0!==i&&o.setActive.call(this,{index:i,item:{value:t},silent:!0})}}var s=e("underscore"),o=e("../../scalableList/model/listWithNavigationModelTrait"),r=e("./SingleSelect"),a=e("../model/SingleSelectListModelNew"),l=r.extend({initialize:function(e){s.bindAll(this,"_getSelectionIndex"),this.formatValue=e.formatValue,r.prototype.initialize.call(this,e)},_createListViewModel:function(e){return this.getData=e.getData,e.model||s.extend(new a(e),{_afterSelect:s.partial(n,this._getSelectionIndex)})},_getSelectionIndex:function(e){for(var t=this.listViewModel.get("bufferStartIndex"),i=this.listViewModel.get("items"),n=0;n<i.length;n++)if(e===i[n].value)return t+n},_getGetData:function(){return this.getData},_getActiveValueIndex:function(e){return this._getSelectionIndex(e.value)},changeFilter:function(){var e=this,t=this.model.get("criteria");this.listView.scrollTo(0),this._getGetData()({criteria:t,offset:0,limit:1}).done(function(){e.listView.fetch(function(){e.listView.resize(),e.setValueToList()})})},getControlLabelByValue:function(e){return null==e.label?this.formatValue?this.formatValue(e.value):e.value:e.label},setValue:function(e,t){e=this.convertExternalValueToInternalFormat(e),t&&t.silent&&(this.silent=!0),this.model.set("value",e),this.setValueToList(t),this.silent&&delete this.silent},setValueToList:function(e){var t=this.model.get("value"),i={};t&&t.index?i[t.index]=t.value:t&&(i=t.value),this.listView.setValue(i,e)}});i.exports=l}),define("runtime_dependencies/js-sdk/src/common/util/parse/NumberUtils",["require","exports","module","underscore"],function(e,t,i){var n=e("underscore"),s=function(e){function t(e){return"."===e?e="\\.":" "===e&&(e="\\s"),e}e=e||{},this.DECIMAL_SEPARATOR=e.decimalSeparator||".",this.GROUPING_SEPARATOR=e.groupingSeparator||",",this.decimalSeparator=t(this.DECIMAL_SEPARATOR),this.groupingSeparator=t(this.GROUPING_SEPARATOR),this.DECIMAL_NUMBER_PATTERN=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+this.groupingSeparator+"[0-9]{3})*("+this.decimalSeparator+"[0-9]+)?|[1-9]{1}[0-9]{0,}("+this.decimalSeparator+"[0-9]+)?|0("+this.decimalSeparator+"[0-9]+)?)$"),this.INTEGER_NUMBER_PATTERN=new RegExp("^-?([1-9]{1}[0-9]{0,2}("+this.groupingSeparator+"[0-9]{3})*|[1-9]{1}[0-9]{0,}|0)$")},o=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER+1:9007199254740992,r=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER-1:-9007199254740992;s.prototype.number_format=function(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var s=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):0,r=void 0===n?",":n,a=void 0===i?".":i,l=(o?function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)}(s,o):""+Math.round(s)).split(".");return l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,r)),(l[1]||"").length<o&&(l[1]=l[1]||"",l[1]+=new Array(o-l[1].length+1).join("0")),l.join(a)},s.prototype.isInt=function(e){return this.isNumberInt(e)||this.isStringInt(e)},s.prototype.isNumberInt=function(e){return n.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY&&(e===+e&&e===(0|e)||e%1==0)},s.prototype.isStringInt=function(e){return n.isString(e)&&this.INTEGER_NUMBER_PATTERN.test(e)},s.prototype.isInt32=function(e){return this.isInt(e)&&this.parseNumber(e)>=-2147483648&&this.parseNumber(e)<=2147483647},s.prototype.isDecimal=function(e){return n.isNumber(e)&&!isNaN(e)&&e!==Number.POSITIVE_INFINITY&&e!==Number.NEGATIVE_INFINITY||n.isString(e)&&this.DECIMAL_NUMBER_PATTERN.test(e)},s.prototype.parseNumber=function(e){if(n.isNumber(e))return e;if(n.isString(e)&&this.DECIMAL_NUMBER_PATTERN.test(e)){e=e.replace(new RegExp(this.groupingSeparator,"g"),"").replace(new RegExp(this.decimalSeparator,"g"),".");var t=1*e;return t>=o||t<=r?(window.console&&window.console.warn(e+" is out of the ["+(r+1)+", "+(o-1)+"] bounds. Parsing results may be corrupted. Use string representation instead. For more details see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number."),!1):t}},s.prototype.formatNumber=function(e,t){t=t||{};var i=e.toString().split(".")[1],s=i?i.length:0;n.isUndefined(t.decimalPlacesAmount)||(s=t.decimalPlacesAmount);try{return this.number_format(e,s,t.decimalSeparator||this.DECIMAL_SEPARATOR,t.groupingSeparator||this.GROUPING_SEPARATOR)}catch(t){return e.toString()}},s.prototype.MaxRange=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER+1:9007199254740992,s.prototype.MinRange=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER-1:-9007199254740992,i.exports=s}),define("runtime_dependencies/js-sdk/src/components/scalableList/util/domAndCssUtil",["require","exports","module","underscore","jquery"],function(e,t,i){var n=e("underscore"),s=e("jquery");i.exports={doCalcOnVisibleNodeClone:function(e){if(!e||!e.el)throw"Missing required option: el";if(n.defaults(e,{css:{},classes:"",container:"<div></div>",appendTo:"body",callback:function(){throw"no callback was defined"},alwaysClone:!1,cloneHandlers:!1}),n.defaults(e.css,{position:"absolute",left:"-9999px"}),!e.alwaysClone&&s(e.el).is(":visible"))e.callback(s(e.el));else{var t=s(e.el).clone(),i=s(e.container).css(e.css).addClass(e.classes).appendTo(s(e.appendTo)).append(t);e.callback(t),i.remove()}}}}),define("runtime_dependencies/js-sdk/src/components/multiSelect/mixin/scalableListItemHeightCalculationTrait",["require","exports","module","jquery","../../scalableList/model/ScalableListModel","../../../common/util/browserDetection","../../scalableList/util/domAndCssUtil"],function(e,t,i){var n=e("jquery"),s=e("../../scalableList/model/ScalableListModel"),o=e("../../../common/util/browserDetection"),r=e("../../scalableList/util/domAndCssUtil"),a=r.doCalcOnVisibleNodeClone,l={render:function(){return this._itemHeightSet||(this._calcItemHeight(),this._itemHeightSet=!0),this},_calcItemHeight:function(){var e=this;this._model=this.model,this._lazy=this.lazy,this._visibility=this.$el.css("visibility"),this._display=this.$el.css("display"),this.model=new s({getData:function(){var e=new n.Deferred;return e.resolve({total:1,data:[{value:"test value",label:"test label"}]}),e}}),this.$el.css({visibility:"hidden",display:"block"}),this.model.once("change",this.onModelChange,this),this.renderData(),a({el:this.$el,css:{width:"100px"},classes:" jr "+(o.isIPad()?"ipad":""),callback:function(t){e.itemHeight=t.find("li").outerHeight(!0),e.itemsPerChunk=Math.floor(e.defaultChunkHeight/e.itemHeight),e.chunkHeight=e.itemsPerChunk*e.itemHeight}}),this.$el.empty().css({visibility:this._visibility,display:this._display}),delete this._visibility,delete this._display,this.totalItems=void 0,this.$firstViewChunk=void 0,this.model=this._model,delete this._model,this.lazy=this._lazy,this._lazy&&delete this._lazy},_calcViewPortConstants:function(){if(!this.viewPortConstantsInitialized){if(!this._itemHeightSet)return;this._calcViewPortHeight(),this._renderViewChunks(!0),this._renderItems(),this.viewPortConstantsInitialized=!0}}};i.exports=l}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/availableItemsTemplate.htm",[],function(){return'<div class="jr-mMultiselect-search jr">\n\n    <js-templateNonce></js-templateNonce>\n    <input class="jr-mInput-search jr" type="text" placeholder="{{- i18n[\'sic.multiselect.search\']}}">\n</div>\n\n<div class="jr-mMultiselect-list jr"></div>\n\n<div class="jr-mMultiselect-buttonContainer jr">\n    <ul class="jr-mItemselector jr">\n        <li  title="{{- i18n[\'sic.multiselect.selectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.selectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.deselectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.deselectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.inverse\'] }}" class="jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.inverse\'] }}</span>\n            </a>\n        </li>\n    </ul>\n</div>\n'}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/availableItemsTemplate_IE10_11.htm",[],function(){return'<div class="jr-mMultiselect-search jr">\n\n    <js-templateNonce></js-templateNonce>\n    <input class="jr-mInput-search jr" type="text">\n</div>\n\n<div class="jr-mMultiselect-list jr"></div>\n\n<div class="jr-mMultiselect-buttonContainer jr">\n    <ul class="jr-mItemselector jr">\n        <li  title="{{- i18n[\'sic.multiselect.selectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectAll">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-checkmark jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.selectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.deselectAll\'] }}" class="jr-mItemselector-button jr-uWidth-30pc jr jr-jSelectNone">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-cancel jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.deselectAll\'] }}</span>\n            </a>\n        </li>\n\n        <li  title="{{- i18n[\'sic.multiselect.inverse\'] }}" class="jr-mItemselector-button jr-uWidth-40pc jr jr-jInvert">\n            <span class="jr-mItemselector-button-icon jr-mIcon jr-mIconSmall jr-invert jr"></span>\n            <a class="jr-mItemselector-button-label jr">\n                <span class="jr">{{- i18n[\'sic.multiselect.inverse\'] }}</span>\n            </a>\n        </li>\n    </ul>\n</div>'}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/listTemplate.htm",[],function(){return'<div class="jr-mScalablelist jr j-scalable-list" onselectstart="return false" unselectable="on" ondragstart="return false" draggable="false">\n\n    <js-templateNonce></js-templateNonce>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/AvailableItemsList",["require","exports","module","jquery","backbone","underscore","../../../common/util/browserDetection","bundle!ScalableInputControlsBundle","../../singleSelect/manager/KeyboardManager","../../scalableList/view/ListWithNavigation","../../scalableList/util/domAndCssUtil","../../scalableList/model/listWithNavigationModelTrait","../../scalableList/model/ListWithSelectionAsObjectHashModel","../mixin/scalableListItemHeightCalculationTrait","text!../templates/availableItemsTemplate.htm","text!../templates/availableItemsTemplate_IE10_11.htm","text!../templates/listTemplate.htm"],function(e,t,i){var n=e("jquery"),s=e("backbone"),o=e("underscore"),r=e("../../../common/util/browserDetection"),a=e("bundle!ScalableInputControlsBundle"),l=e("../../singleSelect/manager/KeyboardManager"),c=e("../../scalableList/view/ListWithNavigation"),u=e("../../scalableList/util/domAndCssUtil"),h=e("../../scalableList/model/listWithNavigationModelTrait"),d=e("../../scalableList/model/ListWithSelectionAsObjectHashModel"),p=e("../mixin/scalableListItemHeightCalculationTrait"),m=e("text!../templates/availableItemsTemplate.htm"),f=e("text!../templates/availableItemsTemplate_IE10_11.htm"),g=e("text!../templates/listTemplate.htm"),v=u.doCalcOnVisibleNodeClone,b=[{selector:".jr-jSelectAll",strings:[a["sic.multiselect.selectAll"],a["sic.multiselect.all"],""]},{selector:".jr-jSelectNone",strings:[a["sic.multiselect.deselectAll"],a["sic.multiselect.none"],""]},{selector:".jr-jInvert",strings:[a["sic.multiselect.inverse"],""]}],C=s.View.extend({className:"jr-mMultiselect-listContainer jr-isActive jr",events:function(){return{"keydown input.jr-mInput-search":this.keyboardManager.onKeydown,"focus input.jr-mInput-search":"onFocus","blur input.jr-mInput-search":"onBlur","click .jr-jSelectAll":"onSelectAll","click .jr-jSelectNone":"onSelectNone","click .jr-jInvert":"onInvertSelection","click input.jr-mInput-search":"onClickOnInput","touchend input.jr-mInput-search":"onClickOnInput",mousedown:"onMousedown",mouseup:"onMouseup"}},keydownHandlers:o.extend({65:"onAKey"},l.prototype.keydownHandlers),initialize:function(e){o.bindAll(this,"onGlobalMouseup","onGlobalMousedown","onResize","onGlobalMousemove","onMousedown","onMouseup","onEscKey","onSelectAll","onSelectNone","onInvertSelection"),this._debouncedOnResize=o.debounce(this.onResize,500),this.model||(this.model=new s.Model),this.model.set("criteria","",{silent:!0});var t;t=r.isIE10()||r.isIE11()?f:m,this.label=e.label,this.template=o.template(e.availableItemsTemplate||t),this.keyboardManager=new l({keydownHandlers:this.keydownHandlers,keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0}),this.listViewModel=this._createListViewModel(e),this.setValue(e.value,{silent:!0}),this.listView=this._createListView(e),this.render(),this.initListeners()},_createListViewModel:function(e){this.getData=e.getData;var t=d.extend(h);return e.listViewModel||new t({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor})},_createListView:function(e){var t=e.listView||new c({el:e.listElement||n(g),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate,scrollTimeout:e.scrollTimeout,lazy:!0,selectedClass:"jr-isSelected",selection:{allowed:!0,multiple:!0}});return o.extend(t,p),t},initListeners:function(){this.listenTo(this.listView,"active:changed",this.activeChange,this),this.listenTo(this.listView,"mousedown",this.onMousedown,this),this.listenTo(this.listView,"render:data",this.onRenderData,this),this.listenTo(this.listView,"listRenderError",this.listRenderError,this),this.listenTo(this.listViewModel,"change",this.onListViewModelChanged,this),this.listenTo(this.listViewModel,"selection:clear",this.selectionClear,this),this.listenTo(this.listViewModel,"selection:add",this.selectionAdd,this),this.listenTo(this.listViewModel,"selection:addRange",this.selectionAddRange,this),this.listenTo(this.listViewModel,"selection:remove",this.selectionRemove,this),this.listenTo(this.model,"change:totalValue",this.onChangeTotalValue,this),this.listenTo(this.model,"change:value",this.changeValue,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.model,"change:criteria",this.changeFilter,this),n("body").on("mousedown",this.onGlobalMousedown).on("mouseup",this.onGlobalMouseup).on("mousemove",this.onGlobalMousemove),n(window).on("resize",this._debouncedOnResize)},render:function(){return this.$el.empty(),
this.$el.append(n(this.template(this.getModelForRendering()))),this.listView.undelegateEvents(),this.$el.find(".jr-mMultiselect-list").append(this.listView.el),this.listView.render(),this.listView.fetch(o.bind(this.listView.resize,this.listView)),this.listView.delegateEvents(),this._tuneCSS(),this.setBulkSelectionText(),this},_tuneCSS:function(){var e=this;this._paddingHeightsSet||(v({el:this.$el,css:{width:"500px"},classes:"jr "+(r.isIPad()?"ipad":""),callback:function(t){e.searchBarHeight=Math.round(t.find(".jr-mMultiselect-search").outerHeight()),e.buttonsContainerHeight=Math.round(t.find(".jr-mMultiselect-buttonContainer").outerHeight())}}),this._paddingHeightsSet=!0),this.$el.find(".jr-mMultiselect-list").css({height:"100%","padding-top":this.searchBarHeight,"padding-bottom":this.buttonsContainerHeight})},renderData:function(){return this.listView.renderData(),this},activeChange:function(e){e&&(this.activeChangedWithShift&&(delete this.activeChangedWithShift,this.listViewModel.addRangeToSelection(e.value,e.index)),this.listView.scrollTo(e.index))},selectionAdd:function(e){this.model.get("value")[e.value]=!0,this.model.trigger("change:value")},selectionAddRange:function(e){var t=e.selection,i=this.model.get("value"),n=0,s=t.length;for(n;n<s;n+=1)i[t[n]]=!0;this.model.trigger("change:value")},selectionRemove:function(e){delete this.model.get("value")[e.value],this.model.trigger("change:value")},selectionClear:function(){this.model.attributes.value={}},onSelectAll:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.clearFilter(o.bind(this.listView.selectAll,this.listView)))},onSelectNone:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.clearFilter(o.bind(this.listView.selectNone,this.listView)))},onInvertSelection:function(){this.model.get("disabled")||(this.listView.once("selection:change",this.processSelectionThroughApi,this),this.clearFilter(o.bind(this.listView.invertSelection,this.listView)))},onRenderData:function(){this.trigger("render:data")},listRenderError:function(e,t){this.trigger("listRenderError",e,t)},onListViewModelChanged:function(){if(void 0===this.model.get("totalValues")){var e=this.listViewModel.get("total");o.isNumber(e)&&!o.isNaN(e)&&this.model.set("totalValues",e)}},onChangeTotalValue:function(){this.listView.resize()},setBulkSelectionText:function(){if(this.$el.is(":visible")){var e=this.$el.outerWidth();if(e!==this._componentWidth){this._componentWidth=e;var t=this.$el.find(".jr-mMultiselect-buttonContainer"),i=t.outerWidth();v({el:t,css:{left:0-2*i+"px",width:i+"px"},classes:"jr "+(r.isIPad()?"ipad":""),alwaysClone:!0,callback:function(e){o.each(b,function(i){var n=!1;o.each(i.strings,function(s){if(!n){var o=e.find(i.selector),r=o.find(".jr-mItemselector-button-label span").text(s);(o[0].getBoundingClientRect().right-r[0].getBoundingClientRect().right>=3||""===s)&&(n=!0,t.find(i.selector+" .jr-mItemselector-button-label span").text(s))}})})}})}}},changeValue:function(){this.trigger("selection:change",this.getValue())},changeDisabled:function(){var e=this.model.get("disabled");e?this.$el.find("input[type='text']").attr("disabled","disabled"):this.$el.find("input[type='text']").removeAttr("disabled"),this.listView.setDisabled(e)},onClickOnInput:function(){this.onFocus()},onFocus:function(){var e=this.$el.find("input");e.val()==e.attr("placeholder")&&(e.val(""),e.removeClass("jr-mMultiselect-input-placeholder"))},onBlur:function(){var e=this.$el.find("input");if(""!==e.val()&&e.val()!==e.attr("placeholder")||(e.addClass("jr-mMultiselect-input-placeholder"),e.val(e.attr("placeholder"))),this.preventBlur)return!1},onMousedown:function(){r.isIPad()||(this.preventBlur=!0)},onMouseup:function(){this.preventBlur&&(delete this.preventBlur,this.$el.find("input.jr-mInput-search").focus())},onGlobalMousedown:function(e){this.preventBlur&&e.target!==this.el&&0===this.$el.find(e.target).length&&(delete this.preventBlur,this.onBlur())},onGlobalMouseup:function(){this.onMouseup()},onGlobalMousemove:function(e){this.preventBlur&&e.stopPropagation()},onResize:function(){this.resize()},onUpKey:function(e){var t=this;this._onUpDownNavigation(e,function(){t.listView.activatePrevious()},function(){t.listView.activateLast()})},onDownKey:function(e){var t=this;this._onUpDownNavigation(e,function(){t.listView.activateNext()},function(){t.listView.activateFirst()})},_onUpDownNavigation:function(e,t,i){var n,s=this.listView.getActiveValue();s?(e.shiftKey&&(this.activeChangedWithShift=!0),t(),n=this.listView.getActiveValue(),n.index===s.index&&i()):i()},onEnterKey:function(e){e.preventDefault();var t=this.listView.getActiveValue();t&&(e.shiftKey?this.listViewModel.addRangeToSelection(t.value,t.index):e.ctrlKey||e.metaKey?(this.listViewModel.clearSelection(),this.listViewModel.addValueToSelection(t.value,t.index)):this.listViewModel.toggleSelection(t.value,t.index))},onEscKey:function(){},onHomeKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateFirst()},onEndKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.activateLast()},onPageUpKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageUp()},onPageDownKey:function(e){e.shiftKey&&(this.activeChangedWithShift=!0),this.listView.pageDown()},onTabKey:function(){},onAKey:function(e){e.ctrlKey||e.metaKey?(e.stopPropagation(),this.onSelectAll()):this.keyboardManager.deferredHandleKeyboardEvent(e)},processKeydown:function(){this.model.set("criteria",this.$el.find("input.jr-mInput-search").val())},changeFilter:function(e){var t=this,i=this.model.get("criteria");void 0!==i&&""!==i||this.model.unset("totalValues",{silent:!0}),this.listView.scrollTo(0),t.listView.activate(null,{silent:!0}),this.getData({criteria:i,offset:0,limit:1}).done(function(){t.listView.fetch(function(){t.listView.resize(),t.listView.setValue(o.keys(t.model.get("value")),{silent:!0}),t.listView.activate(0)})})},clearFilter:function(e){this.model.get("criteria")?(this.$el.find("input").val(""),this.model.set("criteria","",{silent:!0}),this.changeFilter(e)):(this.model.unset("totalValues",{silent:!0}),e&&e())},processSelectionThroughApi:function(e,t){var i={},n=0,s=e.length;for(this.selectionClear(),n;n<s;n+=1)i[e[n]]=!0;this.model.attributes.value=i,t&&t.silent||this.model.trigger("change:value")},convertSelectionForListViewModel:function(e){return e},getModelForRendering:function(){return{label:this.label,isIPad:r.isIPad(),disabled:this.model.get("disabled"),i18n:a}},fetch:function(e,t){var i=this.model.get("criteria");void 0!==i&&""!==i||this.model.unset("totalValues",{silent:!0}),this.listView.fetch(e,t)},resize:function(){this.listView.resize(),this.setBulkSelectionText()},reset:function(e){var t=this;this.clearFilter(function(){t.listView.reset(e)})},getValue:function(){return o.keys(this.model.get("value"))},setValue:function(e,t){t=t||{},this.listViewModel.once("selection:change",function(){this.selectionClear();var e=this.listViewModel.getSelection(),i=0,n=e.length;for(i;i<n;i++)this.model.attributes.value[e[i]]=!0;t&&t.silent||this.changeValue()},this),o.isArray(e)||"string"==typeof e||(e=this.convertSelectionForListViewModel(e)),this.listViewModel.select(e,t.modelOptions)},setDisabled:function(e){this.model.set("disabled",e)},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.listView.remove(),s.View.prototype.remove.call(this),n("body").off("mousedown",this.onGlobalMousedown).off("mouseup",this.onGlobalMouseup).off("mousemove",this.onGlobalMousemove),n(window).off("resize",this._debouncedOnResize)}});i.exports=C}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/selectedItemsTemplate.htm",[],function(){return'\x3c!--\nthis input only for technical purposes:\nit allows selected items list to get focus\nand have proper tab position\n(simple tabindex="0" on DOM element will broke tab index sequence)\n--\x3e\n\n    <js-templateNonce></js-templateNonce>\n<div class="jr-mMultiselect-list jr">\n    <input type="text" style="position: absolute; left: -9999px" {{ if (disabled) { }}disabled="disabled"{{ } }}>\n    \x3c!-- list position --\x3e\n    <div class="jr-mMultiselect-list-message jr-isHidden jr">\n        {{- i18n[\'sic.multiselect.noSelection\'] }}\n    </div>\n</div>'}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/selectedItemsListTemplate.htm",[],function(){return'<ul class="jr-mSelectlist jr-mSelectlistSelected jr" style="top: {{- top}}px; position: relative;">\n\n    <js-templateNonce></js-templateNonce>\n    {{_.each(items, function(item) { }}\n    <li class="jr-mSelectlist-item jr-isSelected {{ if (item.active) print(\' jr-isHovered\'); }} jr" title="{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}" data-index="{{- item.index}}">\n        <div class="jr-mSelectlist-item-wrapper jr">\n            <a class="jr-mSelectlist-item-delete jr"></a>\n            <a class="jr-mSelectlist-item-text jr">{{ print(item.label && item.label.trim() ? _.xssHardEscape(item.label) : \'&nbsp;\')}}</a>\n        </div>\n    </li>\n    {{ }); }}\n</ul>\n'}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/ListViewForSelectedItemsList",["require","exports","module","jquery","../../scalableList/view/ListWithNavigation"],function(e,t,i){var n=e("jquery"),s=e("../../scalableList/view/ListWithNavigation"),o=s.extend({_multiSelect:function(e,t,i){n(e.target).hasClass("jr-mSelectlist-item-delete")?this.model.selectionContains(t,i)||this._singleSelect(e,t,i):s.prototype._multiSelect.call(this,e,t,i)}});i.exports=o}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/SelectedItemsList",["require","exports","module","jquery","backbone","underscore","../../../common/util/browserDetection","bundle!ScalableInputControlsBundle","../../singleSelect/manager/KeyboardManager","../../scalableList/model/ListWithSelectionModel","../../scalableList/model/listWithNavigationModelTrait","../mixin/scalableListItemHeightCalculationTrait","text!../templates/selectedItemsTemplate.htm","text!../templates/selectedItemsListTemplate.htm","text!../templates/listTemplate.htm","../view/ListViewForSelectedItemsList"],function(e,t,i){var n=e("jquery"),s=e("backbone"),o=e("underscore"),r=e("../../../common/util/browserDetection"),a=e("bundle!ScalableInputControlsBundle"),l=e("../../singleSelect/manager/KeyboardManager"),c=e("../../scalableList/model/ListWithSelectionModel"),u=e("../../scalableList/model/listWithNavigationModelTrait"),h=e("../mixin/scalableListItemHeightCalculationTrait"),d=e("text!../templates/selectedItemsTemplate.htm"),p=e("text!../templates/selectedItemsListTemplate.htm"),m=e("text!../templates/listTemplate.htm"),f=e("../view/ListViewForSelectedItemsList"),g=s.View.extend({className:"jr-mMultiselect-listContainer jr-isInactive jr",events:function(){return{"keydown input":this.keyboardManager.onKeydown,"focus input":"onFocus","blur input":"onBlur","mouseup .jr-mSelectlist-item-delete":"onMouseupOnDeleteButton",mousedown:"onMousedown",mouseup:"onMouseup"}},keydownHandlers:o.extend({65:"onAKey",8:"onDeleteKey",46:"onDeleteKey"},l.prototype.keydownHandlers),initialize:function(e){this.model||(this.model=new s.Model),this.model.set("focused",!1,{silent:!0}),this.template=o.template(d),this.keyboardManager=new l({keydownHandlers:this.keydownHandlers,keydownTimeout:e.keydownTimeout,context:this,deferredKeydownHandler:this.processKeydown,immediateHandleCondition:this.immediateHandleCondition,immediateKeydownHandler:this.immediateKeydownHandler,stopPropagation:!0});var t=c.extend(u);this.listViewModel=e.listViewModel||new t({getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor}),this.listView=e.listView||o.extend(new f({el:e.listElement||n(m),model:this.listViewModel,chunksTemplate:e.chunksTemplate,itemsTemplate:e.itemsTemplate||p,scrollTimeout:e.scrollTimeout,lazy:!0,selectedClass:"is-selected",selection:{allowed:!0,multiple:!1}}),h),this.initListeners(),this.render().resize()},initListeners:function(){this.listenTo(this.listView,"active:changed",this.activeChange,this),this.listenTo(this.model,"change:focused",this.focusStateChanged,this),this.listenTo(this.model,"change:disabled",this.changeDisabled,this),this.listenTo(this.listViewModel,"change",this.onModelChange,this)},render:function(){this.listView.undelegateEvents();var e=n(this.template({disabled:this.model.get("disabled"),i18n:a}));return this.$el.empty().append(e).find(".jr-mMultiselect-list").append(this.listView.el),this.listView.render(),this.listView.delegateEvents(),this},renderData:function(){return this.listView.renderData(),this},activeChange:function(e){e?this.listView.scrollTo(e.index):this.listViewModel.clearSelection()},changeDisabled:function(){var e=this.model.get("disabled");e?(this.$el.find("input[type='text']").attr("disabled","disabled"),this.listView.setValue({}),this.listView.activate(void 0)):this.$el.find("input[type='text']").removeAttr("disabled"),this.listView.setDisabled(e)},focusStateChanged:function(){this.model.get("focused")?this.$el.find(".mSelect-svListPlaceholder").addClass("focused"):this.$el.find(".mSelect-svListPlaceholder").removeClass("focused")},onModelChange:function(){this.listViewModel.get("total")?this.listView.$el.show():this.listView.$el.hide()},onFocus:function(){this.model.set("focused",!0)},onBlur:function(){this.preventBlur||this.model.set("focused",!1)},onMouseupOnDeleteButton:function(e){this.onDeleteKey(e)},onMousedown:function(){r.isIPad()||(this.preventBlur=!0,this.model.get("focused")||this.$el.find("input").focus())},onMouseup:function(){this.preventBlur&&(this.$el.find("input").focus(),delete this.preventBlur)},onUpKey:function(e){this.listView.activatePrevious()},onDownKey:function(e){this.listView.getActiveValue()?this.listView.activateNext():this.listView.activateFirst()},onEnterKey:function(e){},onHomeKey:function(e){this.listView.activateFirst()},onEndKey:function(e){this.listView.activateLast()},onPageUpKey:function(e){this.listView.pageUp()},onPageDownKey:function(e){this.listView.pageDown()},onTabKey:function(){},onAKey:function(e){},onDeleteKey:function(e){var t=this.listView.getValue();if(t&&t.length>0){var i=!0;for(var n in t)if(t.hasOwnProperty(n)&&void 0!==t[n]){i=!1;break}i||this.trigger("selection:remove",t)}},fetch:function(e,t){this.listView.setValue({}),this.listView.activate(void 0),this.listView.fetch(e,t)},resize:function(){this.listView.resize()},setDisabled:function(e){this.model.set("disabled",e)},getDisabled:function(){return this.model.get("disabled")},remove:function(){this.listView.remove(),s.View.prototype.remove.call(this)}});i.exports=g}),define("text!runtime_dependencies/js-sdk/src/components/multiSelect/templates/multiSelectTemplate.htm",[],function(){return'<div class="jr-mMultiselect-toggleContainer jr">\n\n    <js-templateNonce></js-templateNonce>\n    <div class="jr-mMultiselect-toggle jr-mMultiselect-toggleAvailable jr-isActive jr" title="">\n        <span class="jr-mMultiselect-toggle-label jr" title=""></span>\n    </div>\n    <div class="jr-mMultiselect-toggle jr-mMultiselect-toggleSelected jr-isInactive jr">\n        <span class="jr-mMultiselect-toggle-label jr" title=""></span>\n    </div>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/CacheableDataProvider",["require","exports","module","jquery","underscore"],function(e,t,i){var n=e("jquery"),s=e("underscore"),o=function(e){s.bindAll(this,"getData","getAllCachedData"),this.data=e||[]};s.extend(o.prototype,{setData:function(e){this.data=e||[]},getAllCachedData:function(){return this.data},getData:function(e){var t=new n.Deferred,i=e&&e.offset?e.offset:0,s=e&&e.limit?i+e.limit:this.data.length,o=this._getDataSegment(this.data,i,s);return t.resolve({data:o,total:this.data.length}),t.promise()},_getDataSegment:function(e,t,i){i=Math.min(i,e.length);for(var n=[],s=t;s<i;s++)n.push({label:e[s].label,value:e[s].value});return n}}),i.exports=o}),define("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/SelectedItemsDataProvider",["require","exports","module","underscore","../../singleSelect/dataprovider/CacheableDataProvider"],function(e,t,i){var n=e("underscore"),s=e("../../singleSelect/dataprovider/CacheableDataProvider"),o=function(e){e=e||{},n.defaults(e,{sortFunc:this._sortFunc,formatLabel:this._formatLabel}),this.sortFunc=e.sortFunc,this.formatLabel=e.formatLabel,s.call(this,e.data)};n.extend(o.prototype,s.prototype),n.extend(o.prototype,{setData:function(e){e=this._convertToStandardData(e),e=this._sortData(e),s.prototype.setData.call(this,e)},_sortFunc:function(e,t){return e.label.localeCompare(t.label)},_formatLabel:function(e){return e},_sortData:function(e){return e=e||[],e.sort(this.sortFunc)},_convertToStandardData:function(e){var t=this;return n.map(e,function(e){return{value:e,label:t.formatLabel(e)}})}}),i.exports=o}),define("text!runtime_dependencies/js-sdk/src/components/sizer/template/sizerTemplate.htm",[],function(){return'<div class="jr-mSizer jr-mSizerVertical ui-resizable-s jr">\n\n    <js-templateNonce></js-templateNonce>\n    <span class="ui-icon ui-icon-grip-solid-horizontal"></span>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/sizer/Sizer",["require","exports","module","jquery","backbone","underscore","text!./template/sizerTemplate.htm","../../common/logging/logger","jquery-ui/ui/widgets/resizable"],function(e,t,i){var n=e("jquery"),s=e("backbone"),o=e("underscore"),r=e("text!./template/sizerTemplate.htm"),a=e("../../common/logging/logger");e("jquery-ui/ui/widgets/resizable");var l=a.register("Sizer");i.exports=s.View.extend({template:o.template(r),el:function(){return this.template()},initialize:function(e){this.container=e.container,this.sizerOptions=o.clone(e),delete this.sizerOptions.container,this.$container=n(this.container),this.render()},render:function(){return o.defaults(this.sizerOptions,{minHeight:this.$container.height(),handles:{s:this.$el}}),this.$container.resizable(this.sizerOptions),this},show:function(){return this.$el.removeClass("jr-isInvisible"),this},hide:function(){return this.$el.addClass("jr-isInvisible"),this},updateMinMax:function(e){this.$container.resizable("option","minHeight",e.minHeight),this.$container.resizable("option","maxHeight",e.maxHeight)},remove:function(){try{this.$container.resizable("destroy")}catch(e){l.debug(e)}s.View.prototype.remove.apply(this,arguments)}})}),define("runtime_dependencies/js-sdk/src/components/multiSelect/view/MultiSelect",["require","exports","module","jquery","backbone","underscore","../../singleSelect/dataprovider/SearcheableDataProvider","../../../common/util/parse/NumberUtils","../../scalableList/util/domAndCssUtil","../../../common/util/browserDetection","bundle!ScalableInputControlsBundle","../../../common/util/xssUtil","../view/AvailableItemsList","../view/SelectedItemsList","text!../templates/multiSelectTemplate.htm","../dataprovider/SelectedItemsDataProvider","../../sizer/Sizer"],function(e,t,i){var n=e("jquery"),s=e("backbone"),o=e("underscore"),r=(e("../../singleSelect/dataprovider/SearcheableDataProvider"),e("../../../common/util/parse/NumberUtils")),a=e("../../scalableList/util/domAndCssUtil"),l=e("../../../common/util/browserDetection"),c=e("bundle!ScalableInputControlsBundle"),u=e("../../../common/util/xssUtil"),h=e("../view/AvailableItemsList"),d=e("../view/SelectedItemsList"),p=e("text!../templates/multiSelectTemplate.htm"),m=e("../dataprovider/SelectedItemsDataProvider"),f=e("../../sizer/Sizer"),g=a.doCalcOnVisibleNodeClone,v=new r;i.exports=s.View.extend({className:"jr-mMultiselect jr",events:function(){return{"click  .jr-mMultiselect-toggle":"toggleLists"}},initialize:function(e){this.template=o.template(p),this.i18n={selected:c["sic.multiselect.toggle.selected"],available:c["sic.multiselect.toggle.available"]},this.heightAutoAdjustment=!!o.isUndefined(e.heightAutoAdjustment)||e.heightAutoAdjustment,this.availableItemsListModel=this._createAvailableItemsListModel(e),this.availableItemsList=this._createAvailableItemsList(e),this.selectedItemsDataProvider=this._createSelectedItemsListDataProvider(e),this.selectedItemsList=this._createSelectedItemsList(e),this.height=e.height,this.resizable=e&&e.resizable,this.initListeners(),void 0!==e.value&&(this.silent=!0,this.availableItemsList.setValue(e.value)),e&&e.resizable&&(this.sizer=new f({container:this.$el,stop:o.bind(function(){this.resize()},this)})),this.render()},_createAvailableItemsListModel:function(e){return new s.Model},_createAvailableItemsList:function(e){return e.availableItemsList||new h({model:this.availableItemsListModel,getData:e.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout})},_createSelectedItemsListDataProvider:function(e){return e.selectedItemsDataProvider||new m(e.selectedListOptions)},_createSelectedItemsList:function(e){return this.formatValue=e.formatValue,new d({getData:this.selectedItemsDataProvider.getData,bufferSize:e.bufferSize,loadFactor:e.loadFactor,chunksTemplate:e.chunksTemplate,scrollTimeout:e.scrollTimeout})},initListeners:function(){this.listenTo(this.availableItemsList,"selection:change",this.selectionChange,this),this.listenTo(this.availableItemsList,"listRenderError",this.listRenderError,this),this.listenTo(this.availableItemsListModel,"change:totalValues",this._availableItemsTotalCountChange,this),this.listenTo(this.selectedItemsList,"selection:remove",this.selectionRemoved,this)},render:function(){return this.sizer&&this.sizer.$el.detach(),this.$el.html(n(this.template({i18n:c}))),this.$toggleContainer=this.$el.find(".jr-mMultiselect-toggleContainer"),this.availableItemsList.undelegateEvents(),this.selectedItemsList.undelegateEvents(),this.selectedItemsList.$el.insertAfter(this.$toggleContainer),this.availableItemsList.$el.insertAfter(this.$toggleContainer),this.availableItemsList.render(),this.selectedItemsList.render(),this._updateAvailableItemsCountLabel(),this._updateSelectedItemsCountLabel(),this.availableItemsList.delegateEvents(),this.selectedItemsList.delegateEvents(),this._tuneCSS(),this._renderSizer(),this},_renderSizer:function(){this.sizer&&(this.heightAutoAdjustment&&this._handleHeight(),this.$el.append(this.sizer.$el))},_tuneCSS:function(){var e=this;this._cssDepententSizesSet||(g({el:this.$el,css:{width:"500px"},classes:"jr",alwaysClone:!0,callback:function(t){e.toggleContainerHeight=t.find(".jr-mMultiselect-toggleContainer").outerHeight(),e._tuneCSSInternal(t),t.find(".jr-mScalablelist").css({height:"0"}),e._emptyContainerHeight=t.outerHeight();var i;i=e.height?e.height:e._calcHeightByItemsCount(10),e.$el.css("height",i)}}),this._cssDepententSizesSet=!0),this._tuneCSSInternal(this.$el)},_tuneCSSInternal:function(e){var t=this.toggleContainerHeight;l.isIPad()&&this.$el.addClass("ipad"),e.find(".jr-mMultiselect-listContainer").css("padding-top",t)},listRenderError:function(e,t){this.trigger("listRenderError",e,t)},toggleLists:function(e){e.stopPropagation(),n(e.currentTarget).hasClass("jr-isActive")||(this.$el.find(".jr-mMultiselect-toggle").toggleClass("jr-isActive jr-isInactive"),this.$el.find(".jr-mMultiselect-listContainer").toggleClass("jr-isActive jr-isInactive"),l.isIPad()||this.$el.find(".jr-mMultiselect-listContainer.jr-isActive input").focus())},selectionChange:function(e){clearTimeout(this.selectionChangeTimeout),this.selectionChangeTimeout=setTimeout(o.bind(this.selectionChangeInternal,this,e),100)},selectionRemoved:function(e){var t,i=this.availableItemsList.model.get("value"),n=e.length;for(t=0;t<n;t+=1)delete i[e[t]];this.availableItemsList.setValue(o.keys(i))},selectionChangeInternal:function(e){var t=this,i=this.selectedItemsList.listView.getActiveValue(),n=this.selectedItemsList.listView.$el.scrollTop();this.selectedItemsDataProvider.setData(e),this.selectedItemsList.fetch(function(){if(t._updateSelectedItemsCountLabel(),t.selectedItemsList.resize(),t.selectedItemsList.listView.$el.scrollTop(n),i&&t.selectedItemsList.$el.hasClass("j-active")){var e=t.selectedItemsList.listView.model.get("total");e&&e>i.index?t.selectedItemsList.listView.activate(i.index):e&&t.selectedItemsList.listView.activate(i.index-1)}}),this.silent?delete this.silent:this.triggerSelectionChange()},_setToggleLabel:function(e,t,i){var n=v.formatNumber(t),s=this.$el.find(e+" .jr-mMultiselect-toggle-label"),o=i+": "+n;s.text(o).attr("title",u.hardEscape(o))},_handleHeight:function(){var e=this.availableItemsList.model.get("totalValues")||0;if(this._cssDepententSizesSet&&e){var t=this.$el.height(),i=this.$el.height(),n=this._calcHeightByItemsCount(3),s=this._calcHeightByItemsCount(e);e<=10?n=s=i=this._calcHeightByItemsCount(Math.max(3,e)):t>s&&(i=this._calcHeightByItemsCount(e)),this.$el.css("height",i+"px"),this._updateSizerVisibility({minHeight:n,maxHeight:s})}},_updateSizerVisibility:function(e){this.sizer&&(this.sizer.updateMinMax(e),e.minHeight===e.maxHeight?this.sizer.hide():this.sizer.show())},_calcHeightByItemsCount:function(e){return e*this.availableItemsList.listView.itemHeight+this._emptyContainerHeight},_availableItemsTotalCountChange:function(){this._updateAvailableItemsCountLabel(),this.heightAutoAdjustment&&this._handleHeight()},_updateAvailableItemsCountLabel:function(){var e=this.availableItemsList.model.get("totalValues")||0;this._setToggleLabel(".jr-mMultiselect-toggleAvailable",e||0,this.i18n.available)},_updateSelectedItemsCountLabel:function(){var e=this.$el.find(".jr-mMultiselect-list-message"),t=this.selectedItemsList.listView.model.get("total")||0;this._setToggleLabel(".jr-mMultiselect-toggleSelected",t,this.i18n.selected),0===t?e.removeClass("jr-isHidden"):e.addClass("jr-isHidden")},triggerSelectionChange:function(){this.trigger("selection:change",this.getValue())},renderData:function(){return this.availableItemsList.renderData(),this.selectedItemsList.renderData(),this},fetch:function(e,t){this.availableItemsList.fetch(e,t)},reset:function(e){this.availableItemsList.reset(e)},resize:function(){o.debounce(o.bind(function(){this.availableItemsList.resize(),this.selectedItemsList.resize()},this),500)()},setValue:function(e,t){t&&t.silent&&(this.silent=!0),delete t.silent,this.availableItemsList.setValue(e,t)},getValue:function(){var e=this.availableItemsList.getValue(),t=[],i=0;for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&(t[i++]=e[n]);return t},setDisabled:function(e){return this.availableItemsList.setDisabled(e),this.selectedItemsList.setDisabled(e),this},getDisabled:function(){return this.availableItemsList.getDisabled()},remove:function(){this.availableItemsList.remove(),this.selectedItemsList.remove(),this.sizer&&this.sizer.remove(),s.View.prototype.remove.call(this)}})}),define("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory",["require","exports","module"],function(e,t,i){i.exports={create:function(e){return function(t,i){return t.label===e?-1:i.label===e?1:t.label.localeCompare(i.label)}}}}),define("runtime_dependencies/js-sdk/src/common/util/datetime/RelativeDate",["require","exports","module","underscore"],function(e,t,i){var n=e("underscore"),s=function(e,t,i){this.setKeyword(e),this.setSign(t),this.setNumber(i)};s.prototype.setKeyword=function(e){this.keyword=e.toUpperCase()},s.prototype.setSign=function(e){this.sign=e},s.prototype.setNumber=function(e){if(n.isNumber(e))this.number=e;else{var t=parseInt(e,10);isNaN(t)?this.number=0:this.number=t}},s.prototype.toString=function(){return n.isNumber(this.number)&&!isNaN(this.number)&&this.number>0&&("+"===this.sign||"-"===this.sign)&&this.keyword in s.PATTERNS?this.keyword+this.sign+this.number.toString():this.keyword in s.PATTERNS?this.keyword:""},s.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},s.parse=function(e){if(s.isValid(e))for(var t in s.PATTERNS){var i=s.PATTERNS[t].exec(e);if(null!==i&&n.isArray(i)&&5===i.length)return new s(i[1],i[3],i[4])}},s.isValid=function(e){if(e instanceof s)return""!==e.toString();if(n.isString(e))for(var t in s.PATTERNS)if(s.PATTERNS[t].test(e))return!0;return!1},i.exports=s}),define("runtime_dependencies/js-sdk/src/common/util/datetime/RelativeTimestamp",["require","exports","module","./RelativeDate","underscore"],function(e,t,i){var n=e("./RelativeDate"),s=e("underscore"),o=function(){n.apply(this,arguments)},r=function(){};r.prototype=n.prototype,o.prototype=new r,o.prototype.constructor=o,o.PATTERNS={DAY:/^(DAY)(([+|\-])(\d{1,9}))?$/i,WEEK:/^(WEEK)(([+|\-])(\d{1,9}))?$/i,MONTH:/^(MONTH)(([+|\-])(\d{1,9}))?$/i,QUARTER:/^(QUARTER)(([+|\-])(\d{1,9}))?$/i,SEMI:/^(SEMI)(([+|\-])(\d{1,9}))?$/i,YEAR:/^(YEAR)(([+|\-])(\d{1,9}))?$/i},o.parse=function(e){if(o.isValid(e))for(var t in o.PATTERNS){var i=o.PATTERNS[t].exec(e);if(null!==i&&s.isArray(i)&&5===i.length)return new o(i[1],i[3],i[4])}},o.isValid=function(e){if(e instanceof o)return""!==e.toString();if(s.isString(e))for(var t in o.PATTERNS)if(o.PATTERNS[t].test(e))return!0;return!1},i.exports=o}),define("runtime_dependencies/js-sdk/src/common/util/parse/date",["require","exports","module","momentExtension","../../../jrs.configs","underscore","../datetime/RelativeDate","../datetime/RelativeTimestamp"],function(e,t,i){function n(e){var t=e;return t=e.indexOf("yy")>-1?t.replace("yy","YYYY"):t.replace("y","YY"),e.indexOf("mm")>-1?t=t.replace("mm","MM"):e.indexOf("MM")>-1?t=t.replace("MM","MMMM"):e.indexOf("m")>-1?t=t.replace("m","M"):e.indexOf("M")>-1&&(t=t.replace("M","MMM")),e.indexOf("dd")>-1?t=t.replace("dd","DD"):e.indexOf("DD")>-1?t=t.replace("DD","dddd"):e.indexOf("d")>-1?t=t.replace("d","D"):e.indexOf("D")>-1&&(t=t.replace("D","ddd")),t}function s(e){return e.toUpperCase()}function o(e){return e.toLowerCase().replace("hh","HH")}function r(e){return e.replace("aaa","a")}function a(e,t,i){var s=n(e),r=o(t);return s+(null!=i?i:" ")+r}function l(e,t,i){i=void 0!==i&&i,t=t||" ";var a=e.split(t),l=a[0],c=a.length>1?a[1]:null,u=i?s:n,h=i?r:o;(l.indexOf("h")>0||l.indexOf("H")>0||l.indexOf("s")>0)&&(c=l,l=null);var d="";return l&&(d+=u(l)),c&&(d&&(d+=t),d+=h(c)),d}function c(e){return M(e,n(B.dateFormat),!0)}function u(e){return M(e,a(B.dateFormat,B.timeFormat,B.timestampSeparator),!0)}function h(e){return H.isValid(e)}function d(e){return z.isValid(e)}function p(e){return U.isDate(e)&&M(e).isValid()||U.isString(e)&&""!==e&&c(e).isValid()}function m(e){return U.isDate(e)&&M(e).isValid()||U.isString(e)&&""!==e&&u(e).isValid()}function f(e){return M(e,G,!0).isValid()}function g(e,t){if(p(e)&&p(t)){return b(U.isDate(e)?M(e):c(e),U.isDate(t)?M(t):c(t))}}function v(e,t){if(m(e)&&m(t)){return b(U.isDate(e)?M(e):u(e),U.isDate(t)?M(t):u(t))}}function b(e,t){return e.isBefore(t)?-1:e.isAfter(t)?1:0}function C(e){var t=M(e);if(U.isDate(e)&&t.isValid())return t.format(G)}function S(e){var t=M(e,G,!0);if(t.isValid())return t.toDate()}function _(e){return E(e,a(B.dateFormat,B.timeFormat,B.timestampSeparator),G)}function w(e){return E(e,G,a(B.dateFormat,B.timeFormat,B.timestampSeparator))}function I(e){return E(e,n(B.dateFormat),q)}function y(e){return E(e,q,n(B.dateFormat))}function T(e){return E(e,o(B.timeFormat),$)}function O(e){return E(e,$,o(B.timeFormat))}function E(e,t,i){if(H.isValid(e))return e;var n=M(e,t,!0);return n.isValid()?n.format(i):e}function P(e){return M(e,q,!0)}function x(e){return e.format(q)}function A(e){return e.format(n(B.dateFormat))}function D(e,t){var i;return i=t?M.tz(e,t).tz(F):M.utc(e).tz(F),i.format(n(B.dateFormat))}function j(e,t){var i=M.duration(e),n=M.utc();return t&&n.tz(t),n.hours(i.hours()),n.minutes(i.minutes()),
n.seconds(i.seconds()),n.tz(F).format(o(B.timeFormat))}function L(e,t){var i;return i=t?M.tz(e,t).tz(F):M.utc(e).tz(F),i.format(a(B.dateFormat,B.timeFormat,B.timestampSeparator))}function N(e,t){e=I(e);var i=M.tz(e,F);return i=t?i.tz(t):i.utc(),i.format(q)}function V(e,t){var i=M.duration(e),n=M.utc(),s=n.tz(F);s.hours(i.hours()),s.minutes(i.minutes()),s.seconds(i.seconds());var o;return o=t?s.tz(t):s.utc(),o.format($)}function R(e,t){e=_(e);var i=M.tz(e,F);return i=t?i.tz(t):i.utc(),i.format(G)}var M=e("momentExtension"),k=e("../../../jrs.configs"),U=e("underscore"),H=e("../datetime/RelativeDate"),z=e("../datetime/RelativeTimestamp"),B=k.localeSettings,F=k.userTimezone,G="YYYY-MM-DD[T]HH:mm:ss",q="YYYY-MM-DD",$="HH:mm:ss";i.exports={isRelativeDate:h,isRelativeTimestamp:d,isDate:p,isTimestamp:m,isIso8601Timestamp:f,compareDates:g,compareTimestamps:v,iso8601DateToMoment:P,momentToIso8601Date:x,momentToLocalizedDate:A,dateObjectToIso8601Timestamp:C,iso8601TimestampToDateObject:S,localizedTimestampToIsoTimestamp:_,isoTimestampToLocalizedTimestamp:w,localizedDateToIsoDate:I,isoDateToLocalizedDate:y,localizedTimeToIsoTime:T,isoTimeToLocalizedTime:O,toMomentDateOrTimeOrTimestampPattern:l,isoDateToLocalizedDateByTimezone:D,localizedDateToIsoDateByTimezone:N,isoTimeToLocalizedTimeByTimezone:j,localizedTimeToIsoTimeByTimezone:V,isoTimestampToLocalizedTimestampByTimezone:L,localizedTimestampToIsoTimestampByTimezone:R}}),define("runtime_dependencies/jrs-ui/src/controls/dataprovider/InputControlsDataProvider",["require","exports","module"],function(e,t,i){function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(i,!0).forEach(function(t){l(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=function(){function e(t){o(this,e),l(this,"inputControlsService",void 0),l(this,"controlId",void 0),l(this,"additionalParams",void 0),this.controlId=t.controlId,this.inputControlsService=t.inputControlsService,this.additionalParams={}}return a(e,[{key:"getData",value:function(e,t){var i=this;return this.inputControlsService.getInputControlsPaginatedValues(e,t).then(function(e){var t=e&&e.inputControlState?e.inputControlState:[],n=t.find(function(e){return e.id===i.controlId})||{id:"",uri:"",options:[],totalCount:"0"};return{data:n.options.map(function(e){return s({},e)}),total:parseInt(n.totalCount,10)}})}}]),e}();i.exports=c}),define("runtime_dependencies/jrs-ui/src/controls/dataprovider/InputControlsDataProviderWithDataLabelHash",["require","exports","module"],function(e,t,i){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=function(){function e(t){n(this,e),r(this,"inputControlsDataProvider",void 0),r(this,"dataLabelHash",void 0),this.dataLabelHash={},this.inputControlsDataProvider=t.inputControlsDataProvider}return o(e,[{key:"getData",value:function(e,t){var i=this;return this.inputControlsDataProvider.getData(e,t).then(function(e){var t=e.data,n=e.total;return t.forEach(function(e){i.dataLabelHash[e.value]=e.label}),{data:t,total:n}})}},{key:"getLabelByValue",value:function(e){return this.dataLabelHash[e]}}]),e}();i.exports=a}),define("runtime_dependencies/js-sdk/src/common/component/tree/dataprovider/DataProviderWithSearchCache",["require","exports","module","underscore","jquery"],function(e,t,i){var n=e("underscore"),s=e("jquery"),o=function(e){n.bindAll(this,"getData"),e=e||{},this.dataCache=[],this.dataCacheTotal=null,this.dataCachePages=[],this.pageSize=e.pageSize||999,this.criteriaKey=e.searchKey||"criteria",this.maxSearchCacheSize=e.maxSearchCacheSize||50,this.getDataByCriteriaHolder={},this.criteriaValuesCache=[],this.controlGetTotal=void 0!==e.controlGetTotal&&e.controlGetTotal,this.dataConverter=e.dataConverter,this.saveLastCriteria=void 0!==e.saveLastCriteria&&e.saveLastCriteria,this.lastCriteria=null,this.serialRequestsDelay=void 0!==e.serialRequestsDelay?e.serialRequestsDelay:50,this.serialRequestsDelayedPromise=null,this.request=e.request};n.extend(o.prototype,{getData:function(e){if(e=e||{},n.isEmpty(this.criteriaValuesCache)||void 0===e[this.criteriaKey]&&(e[this.criteriaKey]=n.first(this.criteriaValuesCache)),e[this.criteriaKey])return this._getDataByCriteria(e[this.criteriaKey])(e);if(void 0===e[this.criteriaKey]&&this.saveLastCriteria&&this.lastCriteria)return this._getDataByCriteria(this.lastCriteria)(e);this.lastCriteria=null,this.criteriaValuesCache=[];var t=s.Deferred(),i=this._getPagesToLoad(e);return i?this._requestData(e,i,t):this._resolveDeferredUsingDataFromCache(t,e),t.promise()},clear:function(){this.dataCache=[],this.dataCacheTotal=null,this.dataCachePages=[],this.getDataByCriteriaHolder={},this.criteriaValuesCache=[],this.lastCriteria=null},_requestData:function(e,t,i){var s=(t[t.length-1]-t[0]+1)*this.pageSize,o=n.extend({},e,{offset:t[0]*this.pageSize,limit:s});this.controlGetTotal&&(o.skipGetTotal=!0),s>=2147483647/this.pageSize*this.pageSize&&delete o.limit,this.controlGetTotal&&"number"!=typeof this.dataCacheTotal&&delete o.skipGetTotal,this.serialRequestsDelay>0?(clearTimeout(this.deferredTimeout),this.deferredTimeout=setTimeout(n.bind(this._requestDataDeferred,this,e,o,i),this.serialRequestsDelay)):this._requestDataDeferred(e,o,i)},_requestDataDeferred:function(e,t,i){this._getPagesToLoad(e)?this.serialRequestsDelayedPromise&&n.isEqual(t,this.serialRequestsDelayedPromise.query)?this.serialRequestsDelayedPromise.promise.done(i.resolve).fail(i.reject):(this.serialRequestsDelayedPromise={promise:i.promise(),query:t},this.request(t).done(n.bind(this._requestDone,this,e,t,i)).fail(i.reject)):this._resolveDeferredUsingDataFromCache(i,e)},_requestDone:function(e,t,i,n){this._putDataToCache(t,n),this.serialRequestsDelayedPromise=null,this._resolveDeferredUsingDataFromCache(i,e)},_resolveDeferredUsingDataFromCache:function(e,t){var i=this._getDataFromCache(t);e.resolve({total:this.dataCacheTotal,data:i})},_getPagesToLoad:function(e){var t,i=this._convertLimitOffsetToFirstLast(e),n=this._findPageIndex(i.first),s=this._findPageIndex(i.last),o=[];for(t=n;t<=s;t++)if(!this.dataCachePages[t]){o.push(t);break}for(t=s;t>=n;t--)if(!this.dataCachePages[t]){o.push(t);break}return o.length>0?o:null},_findPageIndex:function(e){return Math.floor(e/this.pageSize)},_convertLimitOffsetToFirstLast:function(e){var t=e&&e.offset?e.offset:0,i=e&&e.limit?t+e.limit-1:this.dataCacheTotal?this.dataCacheTotal-1:2147483647;return this.dataCacheTotal&&i>this.dataCacheTotal-1&&(i=this.dataCacheTotal-1),{first:t,last:i}},_getDataFromCache:function(e){e=n.defaults(e,{offset:0,limit:2147483647});var t=Math.max(0,e.offset),i=Math.min(t+e.limit,this.dataCacheTotal);return this.dataCache.slice(t,i)},_putDataToCache:function(e,t){var i;for(void 0!==t.total&&(this.dataCacheTotal=t.total),e.limit=e.limit||2147483647,i=0;i<t.data.length;i++)this.dataCache[i+e.offset]=this.dataConverter?this.dataConverter(t.data[i]):t.data[i];var n=e.offset/this.pageSize,s=Math.floor((Math.min(e.limit,t.data.length)+e.offset-1)/this.pageSize);for(i=n;i<=s;i++)this.dataCachePages[i]=!0},_getDataByCriteria:function(e){if(!this.getDataByCriteriaHolder[e]){var t,i=Number.MAX_VALUE,n=0,s=0;for(var o in this.getDataByCriteriaHolder)if(this.getDataByCriteriaHolder.hasOwnProperty(o)){s+=1;var r=this.getDataByCriteriaHolder[o];r.index<i&&(i=r.index,t=o),r.index>n&&(n=r.index)}s>=this.maxSearchCacheSize&&(delete this.getDataByCriteriaHolder[t],this.criteriaValuesCache=[]),this.getDataByCriteriaHolder[e]={getData:this._createDataProviderForCriteria(e),index:n+1},this.criteriaValuesCache.push(e)}return this.lastCriteria=e,this.getDataByCriteriaHolder[e].getData},_createDataProviderForCriteria:function(e){var t=this.request,i=this,s=new o({pageSize:this.pageSize,dataConverter:this.dataConverter,serialRequestsDelay:this.serialRequestsDelay,searchKey:this.criteriaKey,controlGetTotal:this.controlGetTotal,request:function(s){var o=n.extend({},s);return o[i.criteriaKey]=e,t(o)}}),r=s.getData;return s.getData=function(e){var t=n.extend({},e);return delete t[i.criteriaKey],r.call(s,t)},s.getData}}),i.exports=o}),define("runtime_dependencies/jrs-ui/src/controls/dataprovider/util/getInputControlsDataProviderNewPageOptions",["require","exports","module"],function(e,t,i){function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(i,!0).forEach(function(t){o(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(i).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},r.apply(this,arguments)}function a(e,t){if(null==e)return{};var i,n,s=l(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}function l(e,t){if(null==e)return{};var i,n,s={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(s[i]=e[i]);return s}i.exports=function(e){var t=e.paginatedValuesOptions,i=a(e,["paginatedValuesOptions"]);return t&&t.length>0?t.map(function(e){return e.name===i.name?r({},e,i):e}):[s({},i)]}}),define("runtime_dependencies/jrs-ui/src/controls/controls.components",["require","exports","module","../namespace/namespace","jquery","underscore","./controls.base","runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelectNew","runtime_dependencies/js-sdk/src/components/multiSelect/view/MultiSelect","runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider","runtime_dependencies/js-sdk/src/components/dateAndTime/DateAndTimePicker","runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory","runtime_dependencies/js-sdk/src/common/util/parse/date","./dataprovider/InputControlsDataProvider","./dataprovider/InputControlsDataProviderWithDataLabelHash","runtime_dependencies/js-sdk/src/common/component/tree/dataprovider/DataProviderWithSearchCache","./dataprovider/util/getInputControlsDataProviderNewPageOptions","../core/core.ajax.utils","./controls.core","./controls.basecontrol"],function(e,t,i){function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}var s=e("../namespace/namespace"),o=s.JRS,r=e("jquery"),a=e("underscore"),l=e("./controls.base"),c=l.ControlsBase,u=e("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelectNew"),h=e("runtime_dependencies/js-sdk/src/components/multiSelect/view/MultiSelect"),d=(e("runtime_dependencies/js-sdk/src/components/singleSelect/dataprovider/SearcheableDataProvider"),e("runtime_dependencies/js-sdk/src/components/dateAndTime/DateAndTimePicker")),p=e("runtime_dependencies/js-sdk/src/components/multiSelect/dataprovider/selectedItemsDataProviderSorterFactory"),m=e("runtime_dependencies/js-sdk/src/common/util/parse/date"),f=e("./dataprovider/InputControlsDataProvider"),g=e("./dataprovider/InputControlsDataProviderWithDataLabelHash"),v=e("runtime_dependencies/js-sdk/src/common/component/tree/dataprovider/DataProviderWithSearchCache"),b=e("./dataprovider/util/getInputControlsDataProviderNewPageOptions"),C=e("../core/core.ajax.utils"),S=C.showErrorPopup;e("./controls.core"),e("./controls.basecontrol");var _=function(e){return e.reduce(function(e,t){return e[t.value]=t.label||t.value,e},{})};o.Controls=function(e,t,i){function s(e){var t=i.BaseControl.prototype.get.call(this,"selection");t&&t[0]===e||this.set({selection:[e]})}function r(e){return e.toUpperCase().replace(/([\s]+$|^[\s]+)/g,"").replace(/[\s]*(\+|\-)[\s]*/g,"$1")}return t.extend(i,{Bool:i.BaseControl.extend({setValue:function(e){var t=this.getElem(),i=t.find("input");"true"==e?i.prop("checked",!0):i.prop("checked",!1)},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){var t=null==e.target.getValue()?"false":"true";this.set({selection:[t]})},this))}}),SingleValueText:i.BaseControl.extend({setValue:function(e){var t=e==c.NULL_SUBSTITUTION_VALUE?c.NULL_SUBSTITUTION_LABEL:e,i=this.getElem();i&&(i.find("input").attr("value",t),i.find("input").val(t))},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){var t=e.target.value,i=t==c.NULL_SUBSTITUTION_LABEL?c.NULL_SUBSTITUTION_VALUE:t;this.set({selection:[i]})},this))}}),SingleValueNumber:i.BaseControl.extend({setValue:function(e){this.getElem().find("input").attr("value",e),this.getElem().find("input").val(e)},bindCustomEventListeners:function(){this.getElem()&&this.getElem().on("change","input",t.bind(function(e){this.set({selection:[e.target.value]})},this))}}),SingleValueDate:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.getElem()&&this.setupCalendar()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return m.localizedDateToIsoDate(t)},set:function(e,t){e.values&&(e.values=m.isoDateToLocalizedDate(e.values)),i.BaseControl.prototype.set.call(this,e,t)},setupCalendar:function(){var i=this.getElem().find("input");this.picker=new d({el:i,showOn:"button",dateFormat:o.i18n.bundledCalendarFormat,disabled:i[0].disabled,onSelect:t.bind(s,this)}),i.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(r(t.target.value)),s.call(this,e(t.target).val())},this)),i.after("&nbsp;"),this.getElem().find("button").wrap(c.CALENDAR_ICON_SPAN).empty()},setValue:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleValueDatetime:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.getElem()&&this.setupCalendar()},getInput:function(){var e=this.getElem();return e&&e.find("input")},destroyCalendar:function(){this.getInput().off(),this.picker&&this.picker.remove()},setupCalendar:function(){var i=this.getElem(),n=this.getInput();this.destroyCalendar(),this.picker=new d({el:n[0],showOn:"button",dateFormat:o.i18n.bundledCalendarFormat,timeFormat:o.i18n.bundledCalendarTimeFormat,disabled:n[0].disabled,onSelect:t.bind(s,this)}),n.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(r(t.target.value)),s.call(this,e(t.target).val())},this)),n.after("&nbsp;"),i.find("button").wrap(c.CALENDAR_ICON_SPAN).empty()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return m.localizedTimestampToIsoTimestamp(t)},set:function(e,t){e.values&&(e.values=m.isoTimestampToLocalizedTimestamp(e.values)),e.values||e.selection||!this.getInput()||this.setupCalendar(),i.BaseControl.prototype.set.call(this,e,t)},setValue:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleValueTime:i.BaseControl.extend({initialize:function(e){this.baseRender(e),e.visible&&this.getElem()&&this.setupCalendar()},getInput:function(){var e=this.getElem();return e&&e.find("input")},destroyCalendar:function(){this.getInput().off(),this.picker&&this.picker.remove()},setupCalendar:function(){var i=this.getElem(),n=this.getInput();this.destroyCalendar(),this.picker=new d({el:n[0],showOn:"button",timeFormat:o.i18n.bundledCalendarTimeFormat,disabled:n[0].disabled,onClose:t.bind(s,this)}),n.change(t.bind(function(t){t.stopPropagation(),e(t.target).val(r(t.target.value)),s.call(this,e(t.target).val())},this)),n.after("&nbsp;"),i.find("button").wrap(c.CALENDAR_ICON_SPAN).empty()},get:function(e){var t=i.BaseControl.prototype.get.call(this,e);return m.localizedTimeToIsoTime(t)},set:function(e,t){e.values&&(e.values=m.isoTimeToLocalizedTime(e.values)),e.values||e.selection||!this.getInput()||this.setupCalendar(),i.BaseControl.prototype.set.call(this,e,t)},setValue:function(e){var t=this.getElem();t.find("input").attr("value",e),t.find("input").val(e)}}),SingleSelect:i.BaseControl.extend({initialize:function(e){var s=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.initialSelectedValues;this.dataUri=o.dataUri,this.inputControlsService=o.inputControlsService,this.paginatedValuesOptions=o.paginatedValuesOptions,this.singleSelect||(this.inputControlsDataProviderWithDataLabelHash=new g({inputControlsDataProvider:new f({controlId:e.id,inputControlsService:this.inputControlsService})}),this.dataProviderWithCache=new v({pageSize:100,maxSearchCacheSize:1,request:function(e){e=b(n({name:s.id,paginatedValuesOptions:s.paginatedValuesOptions},e));var t=s.inputControlsDataProviderWithDataLabelHash.getData(s.dataUri,e);return i.Utils.showLoadingDialogOn(t,null,!0),t}}),this.initialSelectedValuesToLabelMap=_(r),this.singleSelect=new u({getData:this.dataProviderWithCache.getData,formatValue:function(e){return s.inputControlsDataProviderWithDataLabelHash.getLabelByValue(e)||s.initialSelectedValuesToLabelMap[e]}}).setDisabled(e.readOnly),e&&t.extend(this,e))},render:function(){var t=i.TemplateEngine.createTemplate(this.type);if(t){this.singleSelect.undelegateEvents();var n=e(t(this));this.singleSelect.render().renderData(),n.find(".ssPlaceholder").append(this.singleSelect.el),this.setElem(n),this.singleSelect.delegateEvents(),this.makeResizable&&this.makeResizable(),this.isVisible(this)&&this.bindCustomEventListeners()}},setValue:function(e){this.singleSelect.setValue(e,{silent:!0})},updateSelectionOnOptionChange:function(e){this.initialSelectedValuesToLabelMap=_(e)},fetch:function(t,i){var n=this;this.dataUri=t,this.paginatedValuesOptions=i;var s=e.Deferred();return this.singleSelect.off("listRenderError").once("listRenderError",function(e){S(e.responseJSON.message),s.reject(e),n.bindCustomEventListeners()}),this.dataProviderWithCache.clear(),this.singleSelect.fetch(function(){s.resolve.apply(s,arguments)}),s},bindCustomEventListeners:function(){this.singleSelect.off("selection:change").on("selection:change",function(e){this.fireControlSelectionChangeEvent([e])},this),this.singleSelect.off("listRenderError").on("listRenderError",function(e){S(e.responseJSON.message)})}}),MultiSelect:i.BaseControl.extend({initialize:function(e){var s=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.initialSelectedValues;this.dataUri=o.dataUri,this.inputControlsService=o.inputControlsService,this.paginatedValuesOptions=o.paginatedValuesOptions,this.multiSelect||(this.inputControlsDataProviderWithDataLabelHash=new g({inputControlsDataProvider:new f({controlId:e.id,inputControlsService:this.inputControlsService})}),this.dataProviderWithCache=new v({pageSize:100,maxSearchCacheSize:1,request:function(e){e=b(n({name:s.id,paginatedValuesOptions:s.paginatedValuesOptions},e));var t=s.inputControlsDataProviderWithDataLabelHash.getData(s.dataUri,e);return i.Utils.showLoadingDialogOn(t,null,!0),t}}),this.initialSelectedValuesToLabelMap=_(r),this.multiSelect=new h({getData:this.dataProviderWithCache.getData,selectedListOptions:{formatLabel:function(e){return s.inputControlsDataProviderWithDataLabelHash.getLabelByValue(e)||s.initialSelectedValuesToLabelMap[e]},sortFunc:p.create(c.NULL_SUBSTITUTION_LABEL)},resizable:!0}),this.multiSelect.setDisabled(e.readOnly),this._resize=t.debounce(t.bind(this.multiSelect.resize,this.multiSelect),500),e&&t.extend(this,e))},render:function(){var t=i.TemplateEngine.createTemplate(this.type);if(t){this.multiSelect.undelegateEvents();var n=e(t(this));this.multiSelect.render().renderData(),n.find(".msPlaceholder").append(this.multiSelect.el),this.setElem(n),this.multiSelect.delegateEvents(),this.makeResizable&&this.makeResizable(),this.isVisible(this)&&this.bindCustomEventListeners()}},setValue:function(e){this.multiSelect.setValue(e,{silent:!0}),this._resize()},updateSelectionOnOptionChange:function(e){this.initialSelectedValuesToLabelMap=_(e)},fetch:function(t,i){var n=this,s=e.Deferred();return this.dataUri=t,this.paginatedValuesOptions=i,this.dataProviderWithCache.clear(),this.multiSelect.off("listRenderError").once("listRenderError",function(e){S(e.responseJSON.message),s.reject(e),n.bindCustomEventListeners()}),this.multiSelect.fetch(function(){s.resolve.apply(s,arguments)}),s},bindCustomEventListeners:function(){this.multiSelect.off("selection:change").on("selection:change",function(e){this.fireControlSelectionChangeEvent(e)},this),this.multiSelect.off("listRenderError").on("listRenderError",function(e){S(e.responseJSON.message)})},get:function(e){var i=this[e];return"selection"===e&&t.isEmpty(i)?[]:i},makeResizable:function(){var e=this.multiSelect.$el.find(".jr-mSizer");e.length&&e.detach().insertAfter(this.getElem()&&this.getElem().find(".resizeOverlay"))}}),SingleSelectRadio:i.BaseControl.extend({initialize:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e&&t.extend(this,e),this.dataUri=i.dataUri,this.inputControlsService=i.inputControlsService,this.paginatedValuesOptions=i.paginatedValuesOptions,this.inputControlsDataProvider=new f({controlId:e.id,inputControlsService:this.inputControlsService})},render:function(){var t=i.TemplateEngine.createTemplate(this.type);if(t){var n=e(t(this));this.setElem(n),this.makeResizable&&this.makeResizable(),this.isVisible(this)&&this.bindCustomEventListeners()}return this.fetch(this.dataUri,this.paginatedValuesOptions)},fetch:function(e,t){var i=this;return this._fetchData(e,t).then(function(e){i._renderData(e.data)})},_fetchData:function(e,t){this.dataUri=e,this.paginatedValuesOptions=t;var i=b({name:this.id,paginatedValuesOptions:this.paginatedValuesOptions,offset:0});return this.inputControlsDataProvider.getData(this.dataUri,i)},_renderData:function(n){var s=this,o=this.getElem()&&this.getElem().find("ul")[0];if(o){var r=n.map(function(e){var i=t.clone(e);return i.readOnly=s.readOnly,i.name=s.getOptionName(),i.uuid=t.uniqueId(s.id),i}),a=this.getTemplateSection("data");i.Utils.setInnerHtml(o,a,{data:r}),o=e(o),o.html(o.html()+"&nbsp;"),o.find("li").length<5&&this.getElem()[0].clientHeight<125?(this.getElem().find(".jr-mSizer").addClass("hidden"),this.getElem().find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.getElem().find(".jr-mSizer").removeClass("hidden"),this.getElem().find(".inputSet").addClass("sizable"))}},getOptionName:function(){return this.id+"_option"},bindCustomEventListeners:function(){var e=this;this.getElem().on("change","input",function(t){var i=t.target.value;setTimeout(function(){e.set({selection:[i]})})})},makeResizable:function(){this.resizable=!0;var e=this.getElem().find("ul"),t=this.getElem().find(".jr-mSizer").removeClass("hidden");t.addClass("ui-resizable-s"),e.resizable({handles:{s:t}})}}),MultiSelectCheckbox:i.BaseControl.extend({initialize:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e&&t.extend(this,e),this.dataUri=i.dataUri,this.inputControlsService=i.inputControlsService,this.paginatedValuesOptions=i.paginatedValuesOptions,this.inputControlsDataProvider=new f({controlId:e.id,inputControlsService:this.inputControlsService})},render:function(){var t=i.TemplateEngine.createTemplate(this.type);if(t){var n=e(t(this));this.setElem(n),this.makeResizable&&this.makeResizable(),this.isVisible(this)&&this.bindCustomEventListeners()}return this.fetch(this.dataUri,this.paginatedValuesOptions)},fetch:function(e,t){var i=this;return this._fetchData(e,t).then(function(e){i._renderData(e.data)})},_fetchData:function(e,t){this.dataUri=e,this.paginatedValuesOptions=t;var i=b({name:this.id,paginatedValuesOptions:this.paginatedValuesOptions,offset:0});return this.inputControlsDataProvider.getData(this.dataUri,i)},_renderData:function(n){var s=this,o=n.map(function(e){var i=t.clone(e);return i.readOnly=s.readOnly,i.uuid=t.uniqueId(s.id),i}),r=this.getElem()&&this.getElem().find("ul")[0];if(r){var a=this.getTemplateSection("data");i.Utils.setInnerHtml(r,a,{data:o}),e(r).find("li").length<5&&this.getElem()[0].clientHeight<125?(this.getElem().find(".jr-mSizer").addClass("hidden"),this.getElem().find(".inputSet").removeClass("sizable").attr("style",!1)):this.resizable&&(this.getElem().find(".jr-mSizer").removeClass("hidden"),this.getElem().find(".inputSet").addClass("sizable"))}},getSelection:function(){var i=this.getElem().find(":checkbox").filter(":checked");return t.map(i,function(t){return e(t).val()})},bindCustomEventListeners:function(){var i=this;this.getElem().on("change","input",function(e){var t=i.getSelection();setTimeout(function(){i.set({selection:t})})}),this.getElem().on("click","a",function(n){var s=i.getElem().find("input"),o=e(n.target)[0].name;"multiSelectAll"===o||"multiSelectNone"===o?t.each(s,function(e){e.checked="multiSelectAll"===o}):"multiSelectInverse"===o&&t.each(s,function(e){e.checked=!e.checked}),i.getElem().find("input").change()})},get:function(e){var i=this[e];return"selection"===e&&t.isEmpty(i)?[]:i},makeResizable:function(){this.resizable=!0;var e=this.getElem().find("ul"),t=this.getElem().find(".jr-mSizer").removeClass("hidden");t.addClass("ui-resizable-s"),e.resizable({handles:{s:t}})}})})}(r,a,o.Controls),i.exports=o.Controls}),jQuery.url=function(e){function t(e){for(var t="",i=0,n=0,s=0;i<e.length;)n=e.charCodeAt(i),n<128?(t+=String.fromCharCode(n),i++):n>191&&n<224?(s=e.charCodeAt(i+1),t+=String.fromCharCode((31&n)<<6|63&s),i+=2):(s=e.charCodeAt(i+1),c3=e.charCodeAt(i+2),t+=String.fromCharCode((15&n)<<12|(63&s)<<6|63&c3),i+=3);return t}function i(t,i){var n={},s={true:!0,false:!1,null:null};return e.each(t.replace(/\+/g," ").split("&"),function(t,o){var a,l=o.split("="),c=r(l[0]),u=n,h=0,d=c.split("]["),p=d.length-1;if(/\[/.test(d[0])&&/\]$/.test(d[p])?(d[p]=d[p].replace(/\]$/,""),d=d.shift().split("[").concat(d),p=d.length-1):p=0,2===l.length)if(a=r(l[1]),i&&(a=a&&!isNaN(a)?+a:"undefined"===a?void 0:void 0!==s[a]?s[a]:a),p)for(;h<=p;h++)c=""===d[h]?u.length:d[h],u=u[c]=h<p?u[c]||(d[h+1]&&isNaN(d[h+1])?{}:[]):a;else e.isArray(n[c])?n[c].push(a):void 0!==n[c]?n[c]=[n[c],a]:n[c]=a;else c&&(n[c]=i?void 0:"")}),n}function n(e){e=e||window.location;for(var t=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],s=t.exec(e),o={},r=n.length;r--;)o[n[r]]=s[r]||"";return o.query&&(o.params=i(o.query,!1)),o}function s(t){if(t.source)return encodeURI(t.source);var i=[];return t.protocol&&("file"==t.protocol?i.push("file:///"):"mailto"==t.protocol?i.push("mailto:"):i.push(t.protocol+"://")),t.authority?i.push(t.authority):(t.userInfo?i.push(t.userInfo+"@"):t.user&&(i.push(t.user),t.password&&i.push(":"+t.password),i.push("@")),t.host&&(i.push(t.host),t.port&&i.push(":"+t.port))),t.path?i.push(t.path):(t.directory&&i.push(t.directory),t.file&&i.push(t.file)),t.query?i.push("?"+t.query):t.params&&i.push("?"+e.param(t.params)),t.anchor&&i.push("#"+t.anchor),i.join("")}function o(e){return encodeURIComponent(e)}function r(e){return t(unescape(e.replace(/\+/g," ")))}return{encode:o,decode:r,parse:n,build:s}}(jQuery),define("jquery.urldecoder",["jquery"],function(e){return function(){return e.jQuery}}(this)),define("runtime_dependencies/jrs-ui/src/controls/controls.controller",["require","exports","module","jquery","../namespace/namespace","underscore","request","./rest/InputControlsService","./rest/InputControlsServiceWithCache","./service/InputControlsReportViewerService","../core/core.ajax.utils","./controls.core","./controls.datatransfer","./controls.viewmodel","./controls.components","jquery.urldecoder"],function(e,t,i){function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},s.apply(this,arguments)}function o(e){return l(e)||a(e)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function l(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}var c=e("jquery"),u=e("../namespace/namespace"),h=u.JRS,d=e("underscore"),p=e("request"),m=e("./rest/InputControlsService"),f=e("./rest/InputControlsServiceWithCache"),g=e("./service/InputControlsReportViewerService"),v=e("../core/core.ajax.utils"),b=v.showErrorPopup;e("./controls.core"),e("./controls.datatransfer"),e("./controls.viewmodel"),e("./controls.components"),e("jquery.urldecoder");var C=function(e,t){var i=e&&e.inputControlState?e.inputControlState:[],n=!0;return i.forEach(function(e){var i=t[e.id];i&&i.get("error")&&i.set({error:null}),e.error&&(i.set({error:e.error}),n=!1)}),n};!function(e,t,i){t.extend(i,{Controller:i.Base.extend({constructor:function(n){var s=this;t.bindAll(this,"getViewModel","resetControlsToSelection","validate"),this.inputControlsService=new f({inputControlsService:new m({request:p})}),this.inputControlsReportViewerService=new g({inputControlsService:this.inputControlsService}),this.viewModel=n&&n.viewModel?n.viewModel:new i.ViewModel,this.initialize(n),i.ignore("reportoptions:selection:changed"),i.listen({"viewmodel:selection:changed":function(){s._onViewModelSelectionChange.apply(s,arguments)},"reportoptions:selection:changed":function(){s._onReportOptionsSelectionChanged.apply(s,arguments)}}),i.getController=t.bind(function(){return this},this),e(document).trigger("controls:initialized",[this.getViewModel()])},_onViewModelSelectionChange:function(r,a,l,c){var u=this,h=this.getViewModel(),d=h.getControls();if(l&&c){var p=this.inputControlsReportViewerService.fetchInputControlsValuesOnControlSelectionChange({controlId:a,value:l,uri:this.dataUri,structure:h.structure,selection:h.get("selection"),initialSelectedValues:h.controlsOptions.initialSelectedValues}).then(function(t,i,n){var s=n.map(function(e){var t=e.name;return d[t].fetch(u.dataUri,n)});return e.when.apply(e,o(s)).then(function(){return e.Deferred().resolve(i,t)})}).then(function(e,i){e=s({},e,n({},a,l)),t.each(e,function(e,t){d[t].set({values:e})}),C(i,d)}).catch(function(t){var i=d[a];return i.set({
values:i.selection}),b(t.responseJSON.message),e.Deferred().reject(t)});i.Utils.showLoadingDialogOn(p,null,!0)}else a&&this.viewModel.controls[a].set({selection:l},!0)},_onReportOptionsSelectionChanged:function(n,s){var r=this,a=s.reportOption,l=s.previousReportOption,c=this.viewModel,u=c.getControls();this.dataUri=a&&a.uri||this.dataUri;var h=this.inputControlsReportViewerService.fetchInitialInputControlsValuesByUri(this.dataUri,c.structure).then(function(i){var n=i.selection,s=i.paginatedValuesResponse,a=i.paginationOptionsPerControl,l=t.map(a,function(e,t){var i=u[t];return i.updateSelectionOnOptionChange&&i.updateSelectionOnOptionChange(n[t]||[]),i.fetch(r.dataUri,e)});return e.when.apply(e,o(l)).then(function(){return e.Deferred().resolve(n,s)})}).then(function(e,i){t.each(e,function(e,t){u[t].set({values:e.map(function(e){return e.value})})}),C(i,u)}).catch(function(t){return b(t.responseJSON.message),i.reportOptions.set({selection:l},!0),e.Deferred().reject(t)});i.Utils.showLoadingDialogOn(h,null,!0)},initialize:function(e){this.dataUri=e.reportOptionUri||e.reportUri},fetchAndSetInputControlsState:function(t){var n=this,s=this.inputControlsReportViewerService.fetchInputControlsInitialState(this.dataUri,t).then(function(t){if(t){n.viewModel.set({structure:t.structure,controlsOptions:{dataUri:n.dataUri,inputControlsService:n.inputControlsService,initialSelectedValues:t.selection,paginatedValuesOptions:t.paginationOptionsPerControl,paginatedValuesResponse:t.paginatedValuesResponse}});var i=n.getViewModel(),s=i.getControls();C(t.paginatedValuesResponse,s)}return e.Deferred().resolve(t)});return i.Utils.showLoadingDialogOn(s,null,!0),s},getViewModel:function(){return this.viewModel},resetControlsToSelection:function(i){var n=this,s=this.getViewModel(),r=s.getControls();return i||(i=s.get("selection")),this.inputControlsReportViewerService.fetchInputControlsOptionsBySelectionAndUri(i,this.dataUri,s.structure).then(function(t,i,s){var a=i.map(function(e){return r[e.name].fetch(n.dataUri,s[e.name]||i)});return e.when.apply(e,o(a)).then(function(){return t})}).then(function(e){C(e,r),t.each(r,function(e,t){var n,s=i[t];n=s?{values:s}:{error:null,values:void 0,selection:void 0},e.reset(n)})})},validate:function(){var t=this.getViewModel(),n=t.getControls(),s=t.get("selection"),o=e.Deferred();return this.inputControlsReportViewerService.fetchInputControlsOptionsBySelectionAndUri(s,this.dataUri,t.structure).then(function(e){var t=C(e,n);return t?o.resolve(t):o.reject()}),i.Utils.showLoadingDialogOn(o,null,!0),o}})})}(c,d,h.Controls),i.exports=h.Controls}),define("reportOptions/controls.editoptions",["require","exports","module","runtime_dependencies/jrs-ui/src/namespace/namespace","runtime_dependencies/jrs-ui/src/util/utils.common","underscore","jquery","runtime_dependencies/jrs-ui/src/controls/controls.controller"],function(e,t,i){var n=e("runtime_dependencies/jrs-ui/src/namespace/namespace"),s=n.JRS,o=e("runtime_dependencies/jrs-ui/src/util/utils.common"),r=o.addDataToForm,a=e("underscore"),l=e("jquery");e("runtime_dependencies/jrs-ui/src/controls/controls.controller"),s.EditOptions=function(e,t,i){return i.Base.extend({constructor:function(n,s){this.controlsController=new i.Controller({reportUri:s}),this.viewModel=this.controlsController.getViewModel(),this.controlsController.fetchAndSetInputControlsState();var o=e(n);o.on("click","button#done",t.bind(this.handleClick,this,o[0],"save")),o.on("click","button#cancel",t.bind(this.handleClick,this,o[0],"cancel"))},handleClick:function(e,i,n){n.preventDefault(),e.method="post",e._eventId.value=i,"cancel"==i?e.submit():"save"==i&&this.controlsController.validate().then(t.bind(function(t){t&&this.submitForm(e)},this))},submitForm:function(e){var t=this.viewModel.get("selection");t&&r(e,t),e.submit()}})}(l,a,s.Controls),i.exports=s.EditOptions}),define("runtime_dependencies/jrs-ui/src/reportViewer/report.view.base",["require","exports","module","../core/core.ajax","../core/core.layout","../util/utils.common","../components/components.dialogs","underscore","../controls/controls.base","jquery","prototype"],function(e,t,i){var n=e("../core/core.ajax"),s=n.ajax,o=e("../core/core.layout"),r=e("../util/utils.common"),a=r.doNothing,l=e("../components/components.dialogs"),c=e("underscore"),u=e("../controls/controls.base"),h=u.ControlsBase,d=e("jquery"),p=e("prototype"),m=p.$;!function(e){var t=window.dashboardViewFrame,i=window.Template,n={_messages:{},_scroll:null,pageActions:{},viewReportForm:null,pageIndex:0,lastPageIndex:0,pageTimestamp:null,checkPageUpdatedTimeoutId:null,emptyReport:!0,reportForceControls:!1,hasInputControls:!1,reportControlsLayout:null,refreshReportCanceled:!1,reportParameterValues:null,allRequestParameters:null,requestedInputParameters:{},parametersWithoutDefaultValues:null,isLoaded:!1,hasError:!1,EXPORT_ACTION_FORM:"exportActionForm",TOOLBAR_SUBMENU:"toolbarText",PAGINATION_PAGE_FIRST:"page_first",PAGINATION_PAGE_PREV:"page_prev",PAGINATION_PAGE_CURRENT:"page_current",PAGINATION_PAGE_NEXT:"page_next",PAGINATION_PAGE_LAST:"page_last",PAGINATION_PAGE_TOTAL:"page_total",DATA_TIMESTAMP_SPAN:"dataTimestampMessage",DATA_REFRESH_BUTTON:"dataRefreshButton",ASYNC_CANCEL_BUTTON:"asyncCancel",REPORT_COMPONENT_ID:"report",getMessage:function(e,t){var n=this._messages[e];return n?new i(n).evaluate(t||{}):""},commonInit:function(e){var t=d("#"+s.LOADING_ID);t.length>0&&(t.addClass(o.CANCELLABLE_CLASS),t.find("#cancel").click(function(){this._reportIsCanceled||(this._reportIsCanceled=!0,n.cancelReportExecution())})),document.location.href.indexOf("frame=0")>0&&(d("#reportViewFrame > .content > .header").hide(),d("#reportViewFrame").css("margin",0),d("#innerPagination").css("margin","none"),d("#reportViewFrame > .content > .body").css({top:0,"margin-top":0}))},navigateToReportPage:function(e,t,i){window.viewer.jive&&window.viewer.jive.hide(),window.viewer.reportInstance.gotoPage(e)},goToPage:function(e){parseInt(e,10)&&parseInt(e,10)>0&&(null==n.lastPageIndex||parseInt(e,10)<=n.lastPageIndex+1)?n.navigateToReportPage(parseInt(e,10)-1):a()},reportExecutionKey:function(){return n.flowExecutionKeyOutput?n.flowExecutionKeyOutput:window.dashboardViewFrame?t.flowExecutionKey:n.flowExecutionKey},refreshReport:function(e,t,i){var o=/(\?|&)output=([^&]*)/.exec(location.href),r=o&&3===o.length?o[2]:"";l.popup.showShared(m(s.LOADING_ID),!0,{owner:this.REPORT_COMPONENT_ID}),e=e||{},e._flowExecutionKey=e._flowExecutionKey?e._flowExecutionKey:n.reportExecutionKey(),e._eventId=e._eventId?e._eventId:"refreshReport",e.decorate="no",e.confirm="true",e.decorator="empty",e.ajax||(e.ajax="true");var a="flow.html?"+Object.toQueryString(e);return n.requestedInputParameters=i||this.getParametersFromRequest(),e.freshData&&(n.requestedInputParameters+="&freshData=true"),""===r||"html"===r?n.isLoaded?(window.viewer.reportInstance.eventManager.triggerEvent("beforeAction",{name:"beforeAction",type:"reportRefresh"}),window.viewer.reportInstance.refreshPage(0)):window.viewer.loadReport().always(function(){n.isLoaded=!0}):n.exportReport(r,a)},cancelReportExecution:function(){document.body.style.cursor="default",l.popup.hideShared(m(s.LOADING_ID),this.REPORT_COMPONENT_ID),window.viewer.reportInstance?window.viewer.reportInstance.cancelExecution().then(function(){n.isLoaded||(this._reportIsCanceled=!1,n.goBack())},function(){}):(this._reportIsCanceled=!1,n.goBack())},getParametersFromRequest:function(){return h.buildParams(n.getAllRequestParameters())},getAllRequestParameters:function(){return c.isObject(n.allRequestParameters)?n.allRequestParameters:{}},canSaveReport:function(){return!n.isReportReadOnly},confirmExit:function(){return!0},confirmAndLeave:function(){return!!n.confirmExit()&&n.closeViewerOnExit},closeViewerOnExit:function(e){window.viewer.exit().then(function(){e()})},showAjaxDialog:function(){l.popup.showShared(m(s.LOADING_ID),!0,{owner:this.REPORT_COMPONENT_ID})},hideAjaxDialog:function(){l.popup.hideShared(m(s.LOADING_ID),this.REPORT_COMPONENT_ID)}};e.Report=n}(window),i.exports=window.Report}),define("controls/controls.options",["require","exports","module","prototype","jquery","underscore","runtime_dependencies/js-sdk/src/jrs.configs","runtime_dependencies/jrs-ui/src/namespace/namespace","runtime_dependencies/jrs-ui/src/controls/controls.base","runtime_dependencies/jrs-ui/src/reportViewer/report.view.base","settings!inputControls","../core/core.ajax.utils","runtime_dependencies/jrs-ui/src/controls/controls.basecontrol"],function(e,t,i){var n=e("prototype"),s=(n.$,e("jquery")),o=e("underscore"),r=e("runtime_dependencies/js-sdk/src/jrs.configs"),a=e("runtime_dependencies/jrs-ui/src/namespace/namespace"),l=a.JRS,c=e("runtime_dependencies/jrs-ui/src/controls/controls.base"),u=c.ControlsBase,h=e("runtime_dependencies/jrs-ui/src/reportViewer/report.view.base"),d=e("settings!inputControls"),p=e("../core/core.ajax.utils"),m=p.showErrorPopup;e("runtime_dependencies/jrs-ui/src/controls/controls.basecontrol"),function(e,t,i,n){function o(e){if(e.status>=500)return void m(e.responseText);e.getResponseHeader("JasperServerError")&&(e.getResponseHeader("SuppressError")||m(e.responseText))}function a(t,n,s){var o=i.TemplateEngine.renderUrl(f,{reportUnitURI:t});return e.ajax({type:"GET",url:o,success:function(e){n(e.reportOptionsSummary)},error:s,dataType:"json",cache:!1})}function l(t,n,s,o,r,a){var l=i.TemplateEngine.renderUrl(g,{reportUnitURI:t,label:n,overwrite:o});return e.ajax({type:"POST",url:l,processData:!1,data:JSON.stringify(s),success:function(e){r(e)},error:a,contentType:"application/json",dataType:"json"})}function c(t,n,s,o){var r=i.TemplateEngine.renderUrl(v,{reportUnitURI:t,optionId:n});return e.ajax({type:"DELETE",url:r,success:function(e){s(e)},error:o,contentType:"application/json",dataType:"text"})}function u(e){return{id:"",uri:e,label:n.CONTROL_DEFAULT_OPTION_TEXT}}function p(e,i){return void 0!==t.find(i,function(e){return!0===e.selected})||(e.selected=!0),t.union([e],i)}var f=r.contextPath+"/rest_v2/reports{{=reportUnitURI}}/options",g=r.contextPath+"/rest_v2/reports{{=reportUnitURI}}/options?label={{=label}}&overwrite={{=overwrite}}",v=r.contextPath+"/rest_v2/reports{{=reportUnitURI}}/options/{{=optionId}}";t.extend(i,{ReportOptions:i.BaseControl.extend({title:"",label:n.CONTROL_OPTIONS_TEXT,type:"reportOptions",setValue:function(e){var t=this.getElem().find("select"),n=this.getTemplateSection("data");t.empty(),i.Utils.setInnerHtml(t[0],n,{data:e})},bindCustomEventListeners:function(){var e=this.getElem();e&&e.on("change","select",t.bind(function(e){var t=s(e.target).val(),i=this.find({id:t});this.set({selection:i})},this))},fireControlSelectionChangeEvent:function(e,n){var o=null;"true"===d.useUrlParametersOnReset&&(o=t.extend(h.getAllRequestParameters(),h.reportParameterValues)),s(document).trigger(i.REPORT_OPTIONS_SELECTION_CHANGE,{reportOption:e,previousReportOption:n,selectedData:o})},set:function(e,n){if(void 0!==e.selection){var s=this.get("selection"),o=e.selection.id;this.selection=this.find({id:o}),this.enableRemoveButton(""!==o),this.setValue(t.map(this.values,function(e){return o===e.id?e.selected=!0:delete e.selected,e})),!n&&this.fireControlSelectionChangeEvent(this.get("selection"),s)}else i.ReportOptions.__super__.set.apply(this,arguments)},fetch:function(e,i){var n=u(e);return this.set({defaultOption:n}),a(e,t.bind(function(e){var s=t.map(e,function(e){return i&&i==e.uri&&(e.selected=!0),e});s=p(n,s),this.set({values:s})},this),o)},reset:function(e){this.set({selection:this.get("defaultOption")},e)},add:function(e,n,s,r){var a=t.bind(function(e){var i;e.selected=!0;var n=this.get("values"),s=t.find(n,function(e){return e.selected});s&&delete s.selected,i=n?t.union(n,[e]):[e],n&&!t.isEmpty(n)||(i=p(this.get("defaultOption"),i)),r||this.set({values:i}),this.set({selection:e},!0),this.enableRemoveButton(!0)},this);return l(e,n,s,r,a,o).fail(t.bind(function(e){try{var t=JSON.parse(e.responseText),n=i.TemplateEngine.render(t.message,t.parameters,i.TemplateEngine.STD_PLACEHOLDERS);this.set({error:n})}catch(e){}},this))},removeOption:function(e,n){return c(e,n,t.bind(function(){var e=this.get("selection"),t=this.get("values"),i=t.without(e);this.set({values:i}),this.values.size()<2&&delete this.values},this),o).fail(t.bind(function(e){try{var t=JSON.parse(e.responseText),n=i.TemplateEngine.render(t.message,t.parameters,i.TemplateEngine.STD_PLACEHOLDERS);this.set({error:n})}catch(e){}},this))},enableRemoveButton:function(t){var i=e("#"+(t?n._BUTTON_REMOVE:n._BUTTON_SAVE))[0],o=e("#"+(t?n._BUTTON_SAVE:n._BUTTON_REMOVE))[0];i&&o&&(s(i).removeClass("hidden"),s(o).addClass("hidden"))}}),REPORT_OPTIONS_SELECTION_CHANGE:"reportoptions:selection:changed"})}(s,o,l.Controls,u,window.Report),i.exports=l.Controls.ReportOptions}),define("text!runtime_dependencies/js-sdk/src/components/overlay/template/overlayTemplate.htm",[],function(){return'<div class="jr-mOverlay jr-isHidden jr">\n\n    <js-templateNonce></js-templateNonce>\n</div>\n'}),define("runtime_dependencies/js-sdk/src/components/overlay/Overlay",["require","exports","module","underscore","jquery","backbone","text!./template/overlayTemplate.htm"],function(e,t,i){var n=e("underscore"),s=(e("jquery"),e("backbone")),o=e("text!./template/overlayTemplate.htm");i.exports=s.View.extend({el:function(){return this.template()},template:n.template(o),initialize:function(e){e=n.defaults(e||{},{zIndex:4e3}),this.delay=e.delay,this.$el.css({zIndex:e.zIndex}),this.$el.parent().css({position:"relative"})},show:function(e){var t=this,i=function(){t.$el.show(),t.$el.removeClass("jr-isHidden")};this.delay||e?this._timer||(this._timer=setTimeout(i,this.delay||e)):i()},hide:function(){this._timer&&(clearTimeout(this._timer),this._timer=null),this.$el.hide(),this.$el.addClass("jr-isHidden")}})}),define("runtime_dependencies/jrs-ui/src/controls/controls.report",["require","exports","module","prototype","../namespace/namespace","../core/core.layout","./controls.core","../util/utils.common","../components/components.dialogs","./controls.base","./controls.options","../namespace/namespace","../reportViewer/report.view.base","settings!inputControls","jquery","underscore","runtime_dependencies/js-sdk/src/common/component/dialog/ConfirmationDialog","runtime_dependencies/js-sdk/src/components/overlay/Overlay","../core/core.ajax.utils","../reportViewer/report.view.base","./controls.controller"],function(e,t,i){var n=e("prototype"),s=n.$,o=n.$$,r=e("../namespace/namespace"),a=r.JRS,l=e("../core/core.layout"),c=e("./controls.core"),u=e("../util/utils.common"),h=u.centerElement,d=u.matchAny,p=u.triggerNativeEvent,m=u.isIPad,f=u.selectAndFocusOn,g=e("../components/components.dialogs"),v=e("./controls.base"),b=v.ControlsBase,C=v.OptionsDialog,S=v.ControlDialog,_=e("./controls.options"),w=e("../namespace/namespace"),I=w.isProVersion,y=e("../reportViewer/report.view.base"),T=(e("settings!inputControls"),e("jquery")),O=e("underscore"),E=e("runtime_dependencies/js-sdk/src/common/component/dialog/ConfirmationDialog"),P=e("runtime_dependencies/js-sdk/src/components/overlay/Overlay"),x=e("../core/core.ajax.utils"),A=x.showErrorPopup;e("../reportViewer/report.view.base"),e("./controls.controller");var D=function(){var e=!O.isUndefined(O.find(y.parametersWithoutDefaultValues,function(e){return!O.contains(O.keys(y.getAllRequestParameters()),e)}));return y.hasInputControls&&(y.reportForceControls||e&&O.isEmpty(y.reportParameterValues))},j=function(e,t,i,n){return t.extend(i,{_messages:{},layouts:{LAYOUT_POPUP_SCREEN:1,LAYOUT_SEPARATE_PAGE:2,LAYOUT_TOP_OF_PAGE:3,LAYOUT_IN_PAGE:4},controlDialog:null,reportOptionsDialog:null,inputControlsLocation:null,toggleControlsOn:!1,controller:null,hideControls:null,selectionChanged:!0,initialInputControlsFetched:!1,initialize:function(){this.controller=new a.Controls.Controller({reportUri:n.reportUnitURI,reportOptionUri:n.reportOptionsURI}),this.viewModel=i.controller.getViewModel(),this.initializeOptions();var o=t.debounce(function(){i.applyInputValues(!0)},i.Utils.LOADING_DIALOG_DELAY,!0),r=t.debounce(function(){i.applyInputValues()},i.Utils.LOADING_DIALOG_DELAY,!0),c=t.debounce(function(){i.cancel()},i.Utils.LOADING_DIALOG_DELAY,!0),u=t.debounce(function(){i.resetToInitial()},i.Utils.LOADING_DIALOG_DELAY,!0);this.buttonActions={"button#ok":o,"button#apply":r,"button#cancel":c,"button#reset":u,"button#save":i.save,"button#remove":i.remove};var p={"button#ok":o,"button#cancel":c,"button#reset":u,"button#apply":r,"button#save":i.save,"button#remove":i.remove};s(b.INPUT_CONTROLS_DIALOG)&&(this.controlDialog=new S(p)),s(b.INPUT_CONTROLS_FORM)&&s(b.INPUT_CONTROLS_FORM).observe("click",function(e){var t=e.element();for(var i in this.buttonActions)if(d(t,[i],!0))return this.buttonActions[i](),void e.stop()}.bindAsEventListener(this)),this.inputControlsLocation=s(s(b.INPUT_CONTROLS_CONTAINER)?b.INPUT_CONTROLS_CONTAINER:b.INPUT_CONTROLS_FORM),s(b.TOOLBAR_CONTROLS_BUTTON)&&(this.toggleControlsOn=s(b.TOOLBAR_CONTROLS_BUTTON).hasClassName("down")),a.Controls.listen({"viewmodel:selection:changed":function(){i.selectionChanged=!0},"reportoptions:selection:changed":function(e,t){i.selectionChanged=!0}});var m=D();m||n.hasInputControls&&(i.layouts.LAYOUT_IN_PAGE,n.reportControlsLayout);if(n.hasInputControls){var f=this._fetchAndSetInputControlsStateOnce().then(function(){var t=i.controller.getViewModel(),n=t.areAllControlsValid();if(!m&&n)return i.refreshReport().catch(function(){return e.Deferred().resolve()});i.show(),i.controlDialog.show()}).catch(function(e){var t=i.refreshReport();i.Utils.showLoadingDialogOn(t,null,!0)}).always(function(){var t=i.controller.getViewModel(),s=t.areAllControlsValid();!m&&s||n&&n.nothingToDisplay&&(n.nothingToDisplay.removeClassName(l.HIDDEN_CLASS),h(n.nothingToDisplay,{horz:!0,vert:!0}),e("#"+n.DATA_REFRESH_BUTTON).attr(l.DISABLED_ATTR_NAME,l.DISABLED_ATTR_NAME))});i.Utils.showLoadingDialogOn(f,null,!0)}else{var g=i.refreshReport();i.Utils.showLoadingDialogOn(g,null,!0)}},initializeOptions:function(){function o(){var t;(t=e(i.layouts.LAYOUT_POPUP_SCREEN==n.reportControlsLayout?"#"+b.INPUT_CONTROLS_DIALOG:"#"+b.INPUT_CONTROLS_FORM))&&t.length>0&&t.addClass("showingSubHeader")}function r(){var t;(t=e(i.layouts.LAYOUT_POPUP_SCREEN==n.reportControlsLayout?"#"+b.INPUT_CONTROLS_DIALOG:"#"+b.INPUT_CONTROLS_FORM))&&t.length>0&&t.removeClass("showingSubHeader")}if(I()){var l;l=this.layouts.LAYOUT_POPUP_SCREEN==n.reportControlsLayout?"#"+b.INPUT_CONTROLS_DIALOG+" .sub.header":(this.layouts.LAYOUT_TOP_OF_PAGE,n.reportControlsLayout,"#"+b.INPUT_CONTROLS_FORM+" .sub.header");var c=new _;c.fetch(n.reportUnitURI,n.reportOptionsURI).done(function(){e(l).append(c.getElem()),i.lastReportOptionsSelection=c.get("selection")}).fail(function(){e(l).addClass("hidden")}).always(function(){i.lastReportOptionsSelection||(i.lastReportOptionsSelection=c.get("defaultOption"))}),c.updateWarningMessage=function(){i.reportOptionsDialog.showWarning(this.error)},a.Controls.listen({"viewmodel:selection:changed":function(){var e=c.find({uri:n.reportUnitURI});c.set({selection:e},!0)},"viewmodel:order:changed":t.bind(function(e,i){n.newIcOrder=t.pluck(i,"id").join(";")},this)});var u={"button#saveAsBtnSave":function(){var t=i.reportOptionsDialog.input.getValue(),s=i.viewModel.get("selection"),r=t===i.reportOptionsDialog.optionNameToOverwrite;c.add(n.reportUnitURI,t,s,r).done(function(){i.reportOptionsDialog.hideWarning(),g.systemConfirm.show(b.getMessage("report.options.option.saved")),o();var t=c.getElem().parent();t.length>0?t.removeClass("hidden"):(e(l).removeClass("hidden"),e(l).append(c.getElem())),i.layouts.LAYOUT_TOP_OF_PAGE==n.reportControlsLayout&&e("#"+b.INPUT_CONTROLS_FORM+" .header").removeClass("hidden"),i.reportOptionsDialog.hide(),delete i.reportOptionsDialog.optionNameToOverwrite}).fail(function(e){if(e)try{"report.options.dialog.confirm.message"===JSON.parse(e.responseText).errorCode&&!r&&(i.reportOptionsDialog.optionNameToOverwrite=t)}catch(e){}})},"button#saveAsBtnCancel":function(){i.reportOptionsDialog.hide(),delete i.reportOptionsDialog.optionNameToOverwrite}};s(b.SAVE_REPORT_OPTIONS_DIALOG)&&(this.reportOptionsDialog=new C(u)),this.remove=function(){var t=c.get("selection").label,s=new E({text:b.getMessage("report.options.option.confirm.remove",{option:t})});s.on("button:yes",function(){c.removeOption(n.reportUnitURI,c.get("selection").id).done(function(){if(!c.get("values")){r();var t=c.getElem().parent();t.length>0?t.addClass("hidden"):(e(l).addClass("hidden"),e(l).html("")),i.layouts.LAYOUT_TOP_OF_PAGE==n.reportControlsLayout&&e("#"+b.INPUT_CONTROLS_FORM+" .header").addClass("hidden")}c.enableRemoveButton(!1),g.systemConfirm.show(b.getMessage("report.options.option.removed"))}),s.remove()}),s.on("button:no",function(){s.remove()}),s.open()},i.reportOptions=c}},cancel:function(){i.ViewModel.isSelectionChanged(i.lastSelection,i.viewModel.get("selection"));if(n.reportControlsLayout===i.layouts.LAYOUT_SEPARATE_PAGE&&i.separatePageICLayoutFirstShow)n.goBack();else{var e=this._refreshControlsToSelection(i.lastSelection);e.then(function(){}).catch(function(e){A(e.responseJSON.message)}).always(function(){n.reportControlsLayout===i.layouts.LAYOUT_POPUP_SCREEN?i.controlDialog.hide():n.reportControlsLayout===i.layouts.LAYOUT_SEPARATE_PAGE&&i.showReport(),i.reportOptions&&i.lastReportOptionsSelection&&i.reportOptions.set({selection:i.lastReportOptionsSelection},!0)}),i.Utils.showLoadingDialogOn(e,null,!0)}},_refreshControlsToSelection:function(e){return i.controller.resetControlsToSelection(e)},getLastSelection:function(){return this.lastSelection},save:function(){i.selectionChanged?i.controller.validate().then(i.showOptionDialog):i.showOptionDialog()},refreshReport:function(t){if(t){var n=new e.Deferred,s=n.promise(),o=i.viewModel.get("selection");if(!a.Controls.ViewModel.isSelectionChanged(i.lastSelection,o))return n.resolve(),s()}return this._refreshReportOnConfirm()},_refreshReportOnConfirm:function(){var s,o=i.viewModel.get("selection");try{return o&&!t.isEmpty(o)?(s=n.refreshReport(null,null,b.buildSelectedDataUri(o)),i.lastSelection=o):(s=n.refreshReport(),i.lastSelection={}),s}catch(t){return e.Deferred().reject(t)}},_refreshReportOnApply:function(){var s=e.Deferred(),o=i.viewModel.get("selection");return o&&!t.isEmpty(o)?n.refreshReport(null,null,b.buildSelectedDataUri(o)):s.resolve()},applyInputValues:function(o){var r=i.viewModel;i.selectionChanged?i.controller.validate().then(function(r){if(r){var a,l=i.lastSelection;i.reportOptions&&(a=i.lastReportOptionsSelection),window.viewer&&window.viewer.jive&&window.viewer.jive.hide();var c=i.refreshReport();c&&c.then(function(){i.selectionChanged=!1,o&&i.hide()},function(){var s=new P({zIndex:g.errorPopup.getZIndex()-1});e("body").append(s.$el),s.show(),i.lastSelection=l,i.lastReportOptionsSelection=a,g.errorPopup.onClose=function(){n.hasError=!0,i.lastSelection&&!t.isEmpty(i.lastSelection)?n.refreshReport(null,null,b.buildSelectedDataUri(i.lastSelection)):n.refreshReport(),s.remove()},o&&(i.cancel(),i.hide(),i.selectionChanged=!1)}),i.reportOptions&&(i.lastReportOptionsSelection=i.reportOptions.get("selection"),c||g.popup.hide(s("loading")))}}):r.areAllControlsValid()&&o&&i.hide()},resetToInitial:function(){var e=this._refreshControlsToSelection(i.initialSelection).then(function(){i.selectionChanged=!0;var e=i.reportOptions;if(e){var t=e.find({uri:n.reportOptionsURI?n.reportOptionsURI:n.reportUnitURI});if(t)return void e.set({selection:t})}},function(e){A(e.responseJSON.message)});i.Utils.showLoadingDialogOn(e,null,!0)},show:function(){switch(n.reportControlsLayout){case 2:i.showControls();break;case 3:i.toggleControls();break;case 4:break;default:i.showDialog()}},hide:function(){switch(n.reportControlsLayout){case 2:i.showReport();break;case 3:case 4:break;default:i.controlDialog.hide()}},toggleControls:function(){var t=function(){s(b.TOOLBAR_CONTROLS_BUTTON).removeClassName("up").addClassName("down"),o(".panel.pane.inputControls")[0].removeClassName(l.HIDDEN_CLASS)};i.toggleControlsOn?function(){s(b.TOOLBAR_CONTROLS_BUTTON).removeClassName("down").addClassName("up"),o(".panel.pane.inputControls")[0].addClassName(l.HIDDEN_CLASS),p("resize")}():this._fetchAndSetInputControlsStateOnce().then(function(){t()}).catch(function(e){A(e.responseJSON.message)}),i.toggleControlsOn=!i.toggleControlsOn,m()&&n.touchController.reset(),e("#"+b.INPUT_CONTROLS_FORM).show().height()},showDialog:function(){i.controlDialog&&this._fetchAndSetInputControlsStateOnce().then(function(){i.controlDialog.show()}).catch(function(e){A(e.responseJSON.message)})},showReport:function(){s(l.PAGE_BODY_ID).removeClassName(l.CONTROL_PAGE_CLASS).addClassName(l.ONE_COLUMN_CLASS)},showControls:function(){var t=function(){s(l.PAGE_BODY_ID).removeClassName(l.ONE_COLUMN_CLASS).addClassName(l.CONTROL_PAGE_CLASS),document.getElementById(b.INPUT_CONTROLS_FORM)&&e("#"+b.INPUT_CONTROLS_FORM).show()};this._fetchAndSetInputControlsStateOnce().then(function(){t()}).catch(function(e){A(e.responseJSON.message)})},showOptionDialog:function(){a.Controls.Utils.wait(200).then(function(){i.viewModel.areAllControlsValid()&&(i.reportOptionsDialog.show(),f(i.reportOptionsDialog.input))})},_fetchAndSetInputControlsStateOnce:function(){var s=this,o=e.Deferred();if(this.initialInputControlsFetched)o.resolve();else{var r=t.extend(n.getAllRequestParameters(),n.reportParameterValues);this.controller.fetchAndSetInputControlsState(r).then(function(){s.initialInputControlsFetched=!0;var e=i.controller.getViewModel(),t=e.get("selection");return i.lastSelection=t,i.initialSelection=t,o.resolve()},function(){o.reject.apply(o,arguments)}),i.Utils.showLoadingDialogOn(o,null,!0)}return o}})}(T,O,c,y);i.exports=j}),define("runtime_dependencies/jrs-ui/src/components/components.toolbarButtons.events",["require","exports","module","jquery","../util/utils.common","../core/core.events.bis","./components.toolbarButtons"],function(e,t,i){var n=e("jquery"),s=e("../util/utils.common"),o=s.isFirefox,r=s.getAsFunction,a=e("../core/core.events.bis"),l=e("./components.toolbarButtons");l.initialize=function(e){l.actionMap=e,n(".toolbar").on("mouseup mouseover mouseout","button",function(e){n(this).prop("disabled")||l["mouse"+e.type.substring(5,6).toUpperCase()+e.type.substring(6)+"Handler"](e,this)}),o()&&n(".toolbar li").each(function(e,t){n(t).css("padding","0 2px")})},l.mouseUpHandler=function(e,t){var i=t.className.indexOf("capsule")>=0?l.actionMap[t.id]:null;if(i){r(i)(e),e.stopPropagation()}},l.mouseOverHandler=function(e,t){t.className.indexOf("capsule")>=0&&t.className.indexOf("mutton")>=0&&!a.isDisabled(t)&&l.showButtonMenu(e.originalEvent,t)},l.mouseOutHandler=function(e,t){},i.exports=l}),define("runtime_dependencies/jrs-ui/src/reportViewer/report.view.runtime",["require","exports","module","prototype","./report.view.base","../controls/controls.report","../controls/controls.base","../components/components.toolbarButtons.events","../util/utils.common","../namespace/namespace","../util/touch.controller","../core/core.layout","../components/components.dialogs","../core/core.ajax","../core/core.events.bis","underscore","jquery","runtime_dependencies/js-sdk/src/common/stdnav/stdnav"],function(e,t,i){var n=e("prototype"),s=n.$,o=e("./report.view.base"),r=e("../controls/controls.report"),a=e("../controls/controls.base"),l=a.ControlsBase,c=e("../components/components.toolbarButtons.events"),u=e("../util/utils.common"),h=u.matchAny,d=u.isIPad,p=u.isSupportsTouch,m=u.centerElement,f=u.addDataToForm,g=e("../namespace/namespace"),v=g.JRS,b=e("../util/touch.controller"),C=e("../core/core.layout"),S=e("../components/components.dialogs"),_=e("../core/core.ajax"),w=_.ajax,I=e("../core/core.events.bis"),y=e("underscore"),T=e("jquery"),O=e("runtime_dependencies/js-sdk/src/common/stdnav/stdnav");o.toolbarActionMap={back:"Report.goBack",ICDialog:"Controls.show",export:"doNothing",undo:"Report.undo",redo:"Report.redo",undoAll:"Report.undoAll"},T.extend(o,{initialize:function(){this.commonInit(),o.exportForm=s(o.EXPORT_ACTION_FORM),this.nothingToDisplay=s("nothingToDisplay"),s(o.DATA_REFRESH_BUTTON)&&s(o.DATA_REFRESH_BUTTON).observe("mouseup",function(){if(window.viewer.jive&&window.viewer.jive.hide(),void 0!==r){var e=r.viewModel.get("selection"),t=l.buildSelectedDataUri(e);this.refreshReport({freshData:!0},null,t?"&"+t:"")}else this.refreshReport({freshData:!0},null,"")}.bindAsEventListener(this)),s(o.ASYNC_CANCEL_BUTTON)&&s(o.ASYNC_CANCEL_BUTTON).observe("mouseup",function(){this.cancelReportAsyncExecution(!0)}.bindAsEventListener(this)),c.ACTION_MODEL_TAG=o.TOOLBAR_SUBMENU,c.initialize(o.toolbarActionMap),s(o.PAGINATION_PAGE_CURRENT)&&(s(o.PAGINATION_PAGE_CURRENT).observe("change",function(e){this.goToPage(s(o.PAGINATION_PAGE_CURRENT).getValue()),e.stop()}.bindAsEventListener(this)),T(".toolsRight")[0].observe("click",function(e){var t=e.element();e.stop();for(var i in this.pageActions)if(h(t,[i],!0))return void this.navigateToReportPage(this.pageActions[i])}.bindAsEventListener(this))),document.location.href.indexOf("noReturn=true")>0&&I.disable(s("back")),void 0!==r?r.initialize.bind(r)(o.refreshReport):o.refreshReport()},reportRefreshed:function(e){var t,i;if(void 0!==v&&v.fid){t=T("#"+v.fid,window.parent.document),i=t.contents().find("#reportContainer"),t.removeClass(C.HIDDEN_CLASS).show(),d()||t.parent().parent().css("background-image","none");i.height(),i.width();p()&&(new b(i.get(0),t.get(0).parentNode.parentNode,{use2Fingers:!0,showBorders:!0,noInit3d:!0}),i.children("div").bind({touchstart:function(){t.parent().parent().siblings().removeClass(C.HOVERED_CLASS),t.parent().parent().addClass(C.HOVERED_CLASS)}})),i.show(),window.reportFrameHeight=window.reportFrameHeight||t.parent().height(),window.reportFrameWidth=window.reportFrameWidth||t.parent().width()}else{var n=s(l.INPUT_CONTROLS_FORM);if(p()){if(this.touchController)this.touchController.reset();else{var r=T("#reportContainer").parent().parent(),a=T("#reportContainer > div").width();r.width()<a&&r.css("width",a+"px"),this.touchController=new b(r[0],r.parent()[0],{noInit3d:!0,scrollbars:!0})}var c=T("#"+l.INPUT_CONTROLS_FORM+" > button.minimize");if(n&&c&&c.is(":visible")){var u=n.hasClassName("minimized");C.maximize(n),u&&C.minimize(n)}}T("#reportContainer").show().height()}T("#reportContainer").parents(".body").slice(0,1).scrollTop(0),o.nothingToDisplay&&(o.nothingToDisplay.addClassName(C.HIDDEN_CLASS),T("#"+o.DATA_REFRESH_BUTTON).removeAttr(C.DISABLED_ATTR_NAME));var h=T("#paginationIndexHolder"),f=T("#emptyReportMessageHolder"),g=T(T("#emptyReportID p.message")[1]).html(),_=g&&g.trim().length;if(h.length>0){var I=h.attr("data-lastPageIndex");T("#emptyReportID").addClass(C.HIDDEN_CLASS),"0"===I?T(".control.paging").addClass(C.HIDDEN_CLASS).prev(".divider").addClass(C.HIDDEN_CLASS):T(".control.paging").removeClass(C.HIDDEN_CLASS).prev(".divider").removeClass(C.HIDDEN_CLASS)}if(f&&f.length>0&&0===_){var y=f.html();T(".control.paging").addClass(C.HIDDEN_CLASS).prev(".divider").addClass(C.HIDDEN_CLASS),T(T("#emptyReportID p.message")[1]).html(y),T("#emptyReportID").removeClass(C.HIDDEN_CLASS),m(T("#emptyReportID"),{horz:!0,vert:!0})}o.refreshPagination(e),o.refreshExporters(),o.refreshSave(),o.refreshAsyncCancel(),this.dataTimestampMessage&&s(o.DATA_TIMESTAMP_SPAN)&&s(o.DATA_TIMESTAMP_SPAN).update(this.dataTimestampMessage),o.allRequestParameters.viewAsDashboardFrame?T("#innerPagination").css("margin","none"):T("#innerPagination").css("margin",0),S.popup.hideShared(s(w.LOADING_ID),o.REPORT_COMPONENT_ID)}}),T.extend(o,{refreshExporters:function(){I[null!=this.lastPageIndex?"enable":"disable"](s("export"))},refreshSave:function(){},refreshPagination:function(e){var t=window.viewer.reportInstance.currentpage,i=window.viewer.reportInstance.status.totalPages;if(this.emptyReport||null!=i&&i<=0)return I.disable(s(o.PAGINATION_PAGE_FIRST)),I.disable(s(o.PAGINATION_PAGE_PREV)),
I.disable(s(o.PAGINATION_PAGE_CURRENT)),I.disable(s(o.PAGINATION_PAGE_NEXT)),I.disable(s(o.PAGINATION_PAGE_LAST)),void(s(o.PAGINATION_PAGE_CURRENT)&&(s(o.PAGINATION_PAGE_CURRENT).setValue(""),s(o.PAGINATION_PAGE_TOTAL).update("")));t>0?(I.enable(s(o.PAGINATION_PAGE_FIRST)),I.enable(s(o.PAGINATION_PAGE_PREV))):(I.disable(s(o.PAGINATION_PAGE_FIRST)),I.disable(s(o.PAGINATION_PAGE_PREV))),null==i?(null==this.lastPartialPageIndex||t<this.lastPartialPageIndex?I.enable(s(o.PAGINATION_PAGE_NEXT)):I.disable(s(o.PAGINATION_PAGE_NEXT)),I.disable(s(o.PAGINATION_PAGE_LAST))):t+1<i?(I.enable(s(o.PAGINATION_PAGE_NEXT)),I.enable(s(o.PAGINATION_PAGE_LAST))):(I.disable(s(o.PAGINATION_PAGE_NEXT)),I.disable(s(o.PAGINATION_PAGE_LAST))),I.enable(s(o.PAGINATION_PAGE_CURRENT)),s(o.PAGINATION_PAGE_CURRENT)&&(e||s(o.PAGINATION_PAGE_CURRENT).setValue(t+1),null==i?s(o.PAGINATION_PAGE_TOTAL).update(""):s(o.PAGINATION_PAGE_TOTAL).update(this.getMessage("jasper.report.view.page.of")+i)),this.pageActions={"button#page_first":0,"button#page_prev":t-1,"button#page_next":t+1},null!=window.viewer.reportInstance.status.totalPages&&(this.pageActions["button#page_last"]=i-1);var n=T(".toolsRight .paging.subfocus").find("button");n.length&&n.is(":disabled")?n.is("#"+o.PAGINATION_PAGE_LAST)?O.forceFocus(".toolsRight li.page_first"):n.is("#"+o.PAGINATION_PAGE_FIRST)?O.forceFocus(".toolsRight li.page_last"):n.is("#"+o.PAGINATION_PAGE_NEXT)?O.forceFocus(".toolsRight li.page_prev"):n.is("#"+o.PAGINATION_PAGE_PREV)?O.forceFocus(".toolsRight li.page_next"):n.closest("ul").focus():n.addClass(C.HOVERED_CLASS)},refreshAsyncCancel:function(e){var t=window.viewer.reportInstance.status;s(o.ASYNC_CANCEL_BUTTON)&&(e?(s("asyncIndicator").addClassName(C.HIDDEN_CLASS),I.disable(o.ASYNC_CANCEL_BUTTON),s(o.DATA_REFRESH_BUTTON).removeClassName(C.HIDDEN_CLASS)):t.jasperPrintName&&"running"==t.reportStatus&&null==t.totalPages?(I.enable(o.ASYNC_CANCEL_BUTTON),s("asyncIndicator").removeClassName(C.HIDDEN_CLASS),s(o.DATA_REFRESH_BUTTON).addClassName(C.HIDDEN_CLASS)):(s("asyncIndicator").addClassName(C.HIDDEN_CLASS),I.disable(o.ASYNC_CANCEL_BUTTON),s(o.DATA_REFRESH_BUTTON).removeClassName(C.HIDDEN_CLASS)))}}),T.extend(o,{exportReport:function(e,t){for(var i,n,s,a,l=o.exportForm;l.hasChildNodes();)l.removeChild(l.firstChild);l.method="post",l.target="_blank",i=l.action,a=function(){l.target="_self",l.action=i},n={_eventId:"export",_flowExecutionKey:o.reportExecutionKey(),output:""+e};var c=r.viewModel.get("selection");s=y.extend(n,c),f(l,s),t&&(l.action=t),l.submit(),setTimeout(a,500)},goBack:function(){if(o.confirmExit()){var e=o.getAllRequestParameters();I.disable(s("back")),e._ddHyperlink?window.history.back():(o.exportForm._eventId.value="close",o.exportForm._flowExecutionKey.value=o.reportExecutionKey(),o.exportForm.submit())}},open:function(){alert("Not implemented yet: open report")},save:function(){alert("Report saving is not available in community edition")},saveAs:function(){alert("Report saving is not available in community edition")},undo:function(){window.viewer.reportInstance.undo()},redo:function(){window.viewer.reportInstance.redo()},undoAll:function(){window.viewer.reportInstance.undoAll()},cancelReportAsyncExecution:function(e){window.viewer.reportInstance.status.jasperPrintName&&(I.disable(s(o.ASYNC_CANCEL_BUTTON)),window.viewer.reportInstance.cancelExecution(e).then(function(e,t,i){var n=e.result.status;if("finished"!=window.viewer.reportInstance.status.reportStatus&&null==window.viewer.reportInstance.status.totalPages)return e.result.lastPartialPageIndex&&(o.lastPartialPageIndex=e.result.lastPartialPageIndex),"error"==n?void alert("Report execution error: "+e.result.errorMessage):"canceled"==n?(o.refreshAsyncCancel(!0),void S.systemConfirm.show(o.getMessage("jasper.report.view.report.canceled"),5e3)):(e.result.lastPageIndex&&(o.lastPageIndex=e.result.lastPageIndex,window.viewer.reportInstance.status.totalPages=o.lastPageIndex+1),e.result.snapshotSaveStatus&&(o.snapshotSaveStatus=e.result.snapshotSaveStatus),window.viewer.reportInstance.status.reportStatus=n,o.refreshPagination(!0),o.refreshExporters(),o.refreshSave(),o.refreshAsyncCancel(),void 0)},function(e){e.getResponseHeader("lastPartialPageIndex")&&(o.lastPartialPageIndex=e.getResponseHeader("lastPartialPageIndex")),o.refreshPagination(!0)}))}}),i.exports=o}),define("reportView/report.view.runtime",["require","exports","module","runtime_dependencies/jrs-ui/src/reportViewer/report.view.runtime"],function(e,t,i){var n=e("runtime_dependencies/jrs-ui/src/reportViewer/report.view.runtime");i.exports=n}),define("reportView/report.view",["require","exports","module","prototype","jquery","./report.view.runtime","runtime_dependencies/jrs-ui/src/components/components.dialogs","runtime_dependencies/jrs-ui/src/core/core.ajax","../core/core.ajax.utils","runtime_dependencies/js-sdk/src/common/component/dialog/ConfirmationDialog","runtime_dependencies/jrs-ui/src/core/core.events.bis","runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils"],function(e,t,i){function n(e,t){function i(e){var t=r(e.templateMatcher);return d.cloneTemplate&&(t=this.dialogElement.clone()),d.elementId&&t.attr("id",e.elementId),r(d.insertAfterMatcher).append(t),t}function n(e){e.name=m.find(d.nameInputMatcher).val(),e.description=m.find(d.descriptionInputMatcher).val();var t=g.getSelectedNode();e.folder=t?t.param.uri:null}function s(e){return e.name?!!e.folder||(alert(a.getMessage("jasper.report.view.save.missing.folder")),!1):(alert(a.getMessage("jasper.report.view.save.missing.name")),!1)}function o(e){n(f),s(f)&&t(f).then(function(){e.stopPropagation(),p.close()})}function c(e){e.stopPropagation(),p.close()}function u(){var e=b.createRepositoryTree(d.foldersTreeId,{providerId:"adhocRepositoryTreeFoldersProvider",rootUri:"/",organizationId:a.organizationId,publicFolderUri:a.publicFolderUri,urlGetNode:"flow.html?_flowId=adhocTreeFlow&method=getNode",urlGetChildren:"flow.html?_flowId=adhocTreeFlow&method=getChildren",treeErrorHandlerFn:function(){}}),t=e.modifyRootObject,i=e.modifyRootObject=function(e,n,s,o){for(var r=n?e:e.children,a=0,l=r.length;a<l;a++)r[a].extra.isWritable||(r[a].cssClass="readonly"),r[a].children&&i(r[a],!1,r[a],!0);if(n?e=r:e.children=r,!o)return t.call(this,e,n,s)};return e}var h={templateMatcher:"#saveAs",insertAfterMatcher:"#frame",cloneTemplate:!1,elementId:null,okButtonMatcher:"#saveAsBtnSave",cancelButtonMatcher:"#saveAsBtnCancel",nameInputMatcher:"#saveAsInputName",descriptionInputMatcher:"#saveAsInputDescription",foldersTreeId:"saveAsFoldersTree"},d=r.extend({},h,e),p=this,m=null,f={folder:null,name:null,description:null},g=null;this.open=function(e){e.folder||(e.folder="/"),m=i(d),l.popup.show(m.get(0)),m.find(d.nameInputMatcher).val(e.name),m.find(d.descriptionInputMatcher).val(e.description),m.find(d.nameInputMatcher).focus(),m.find(d.okButtonMatcher).click(o),m.find(d.cancelButtonMatcher).click(c),g=u(),g.observe("node:selected",function(e){try{m.find(d.okButtonMatcher)[0].disabled=!e.memo.node.param.extra.isWritable}catch(e){m.find(d.okButtonMatcher)[0].disabled=!0,console&&console.log("report.view[this.open] - "+e)}}),g.showTreePrefetchNodes(e.folder,function(){g.openAndSelectNode(e.folder)})},this.close=function(){m.find(d.okButtonMatcher).off("click",o),m.find(d.cancelButtonMatcher).off("click",c),l.popup.hide(m.get(0))}}var s=e("prototype"),o=s.$,r=e("jquery"),a=e("./report.view.runtime"),l=e("runtime_dependencies/jrs-ui/src/components/components.dialogs"),c=e("runtime_dependencies/jrs-ui/src/core/core.ajax"),u=c.isValidJsonResponse,h=c.AjaxRequester,d=c.ajaxTargettedUpdate,p=c.appendPostData,m=e("../core/core.ajax.utils"),f=m.baseErrorHandler,g=e("runtime_dependencies/js-sdk/src/common/component/dialog/ConfirmationDialog"),v=e("runtime_dependencies/jrs-ui/src/core/core.events.bis"),b=e("runtime_dependencies/jrs-ui/src/dynamicTree/dynamicTree.utils");a.jsonErrorHandler=function(e){if(!u(e)){return f(e)||alert("Unexpected response"),!0}return!1},a.save=function(){if(a.isUriTmp(a.reportUnitURI))return a.saveAs();var e={_flowExecutionKey:a.reportExecutionKey(),_eventId:"saveReport"};a.newIcOrder&&(e.inputControlOrder=a.newIcOrder);var t="flow.html?"+Object.toQueryString(e),i={mode:h.prototype.EVAL_JSON,errorHandler:a.jsonErrorHandler,callback:function(e){e.flowExecutionKey&&(a.flowExecutionKeyOutput=e.flowExecutionKey),e.response&&"success"==e.response.status?l.systemConfirm.show(a.getMessage(e.response.msg),5e3):e.response&&"failure"==e.response.status&&(a.newIcOrder?l.systemConfirm.show(a.getMessage(e.response.msg),5e3):"cluster.exception.session.attribute.missing.popup"==e.response.msg?l.clusterErrorPopup.show(e.response.msg):l.errorPopup.show(a.getMessage(e.response.msg))),a.savedState=window.jasperreports.reportviewertoolbar.currentState(),a.snapshotSaveStatus=null,a.newIcOrder=!1}};d(t,i)},a.doSaveAs=function(e,t){var i={_flowExecutionKey:a.reportExecutionKey(),_eventId:"saveReportAs",folder:e.folder,name:e.name,description:e.description,overwrite:t};a.newIcOrder&&(i.inputControlOrder=a.newIcOrder);var n={mode:h.prototype.EVAL_JSON,postData:p("",i),errorHandler:a.jsonErrorHandler,callback:function(t){switch(t.response.status){case"success":t.flowExecutionKey&&(a.flowExecutionKeyOutput=t.flowExecutionKey);var i=a.reportLabel;a.reportUnitURI=t.response.copyURI,a.reportLabel=e.name,a.reportDescription=e.description,document.title=a.replaceSingleOccurrence(document.title,i,a.reportLabel),r("#reportViewFrame .title").each(function(e,t){var n=r(t),s=n.html(),o=a.replaceSingleOccurrence(s,i,a.reportLabel);o!=s&&n.text(o)}),v.disable("undo"),v.disable("redo"),v.disable("undoAll"),l.systemConfirm.show(a.getMessage(t.response.msg),5e3),a.savedState=window.jasperreports.reportviewertoolbar.currentState(),a.snapshotSaveStatus=null,a.newIcOrder&&(a.newIcOrder=!1);break;case"failure":"cluster.exception.session.attribute.missing.popup"==t.response.msg?l.clusterErrorPopup.show(t.response.msg):l.errorPopup.show(a.getMessage(t.response.msg));break;case"confirmOverwrite":var n=new g({text:a.getMessage(t.response.msg)});n.on("button:yes",function(){a.doSaveAs(e,!0),n.remove()}),n.on("button:no",function(){n.remove()}),n.open()}}};d("flow.html",n)},a.replaceSingleOccurrence=function(e,t,i){var n=e.indexOf(t);return n<0||e.indexOf(t,n+1)>=0?e:e.replace(t,i)},a.uriToParts=function(e){var t={name:null,folder:null},i=e.lastIndexOf("/");return i<0?t.name=e:1==i?(t.folder="/",t.name=e.substring(1)):(t.folder=e.substring(0,i),t.name=e.substring(i+1)),t},a.uriToFolder=function(e){var t=e.lastIndexOf("/");return t<0?null:1==t?"/":e.substring(0,t)},a.isUriTmp=function(e){return 0===e.indexOf(a.tempFolderUri)},a.saveAs=function(){void 0===a.saveAsDialog&&(a.saveAsDialog=new n({},function(e){a.doSaveAs(e,!1);var t=r.Deferred();return t.resolve(),t}));var e=a.reportUnitURI;a.isUriTmp(e)&&a.allRequestParameters&&a.allRequestParameters.advUri&&a.allRequestParameters.advUri[0]&&(e=a.allRequestParameters.advUri[0]);var t={name:a.reportLabel,folder:a.uriToFolder(e),description:a.reportDescription};a.saveAsDialog.open(t)},a.refreshSave=function(){var e=null!=a.lastPageIndex;e?v.enable(o("fileOptions")):v.disable(o("fileOptions")),e&&"NEW"==a.snapshotSaveStatus&&!a.snapshotSaved&&(a.snapshotSaveStatus=null,a.snapshotSaved=!0,window.setTimeout(a.autoSaveSnapshot,200))},a.confirmExit=function(){return a.reportRunning?confirm(a.getMessage("jasper.report.view.in.progress.confirm.leave")):!(a.savedState&&a.savedState!=window.jasperreports.reportviewertoolbar.currentState()||null!=a.lastPageIndex&&"UPDATED"==a.snapshotSaveStatus)||confirm(a.getMessage("jasper.report.view.confirmLeave"))},a.reportRefreshedOrig=a.reportRefreshed,a.reportRefreshed=function(){a.reportRefreshedOrig(),a.savedState||(a.savedState=window.jasperreports.reportviewertoolbar.currentState())},a.autoSaveSnapshot=function(){var e={_flowExecutionKey:a.reportExecutionKey(),_eventId:"saveReportDataSnapshot"},t="flow.html?"+Object.toQueryString(e),i={mode:h.prototype.EVAL_JSON,silent:!0,errorHandler:function(e){return!u(e)},callback:function(e){e.flowExecutionKey&&(a.flowExecutionKeyOutput=e.flowExecutionKey)}};d(t,i)},i.exports=a}),define("reportOptions/editReportOptionMain",["require","exports","module","requirejs-domready","underscore","runtime_dependencies/js-sdk/src/jrs.configs","./controls.editoptions","../reportView/report.view","runtime_dependencies/jrs-ui/src/controls/controls.base"],function(e,t,i){var n=e("requirejs-domready"),s=e("underscore"),o=e("runtime_dependencies/js-sdk/src/jrs.configs"),r=e("./controls.editoptions"),a=e("../reportView/report.view"),l=e("runtime_dependencies/jrs-ui/src/controls/controls.base"),c=l.ControlsBase;n(function(){a.reportUnitURI=o.Report.reportUnitURI,s.extend(c,o.inputControlsConstants);new r("#reportOptionsForm",o.Report.reportOptionsURI)})});