/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","./enum/relations","underscore","jquery","request","./util/helper","./enum/links","runtime_dependencies/js-sdk/src/common/logging/logger"],function(e,r,n){function s(e,r){return h.debug(e,r),r}function t(e){return l.find(d,function(r){return r.rel===e.rel&&r.name===e.name})}function i(e,r,n,s){this.isLoggerEnabled=r,this.logLevel=n,this.scripts=s,this.baseUrl=e||""}var o=e("./enum/relations"),l=e("underscore"),g=e("jquery"),u=e("request"),c=e("./util/helper"),a=e("./enum/links"),f=e("runtime_dependencies/js-sdk/src/common/logging/logger"),d=a.links,h=f.register("Root");l.extend(i.prototype,{settings:function(){var e=new g.Deferred,r=t({rel:o.SETTINGS}),n=this;return r?u({url:this.baseUrl+r.href}).done(function(r){var s=c.serverSettings(r);s.contextPath=n.baseUrl,"undefined"!=typeof __jrsConfigs__?l.extend(__jrsConfigs__,s):window.__jrsConfigs__=s,e.resolve(s)}):e.resolve(new Error("Can't get server settings")),e.promise()},requirejs:function(){var e=new g.Deferred,r=t({rel:o.REQUIREJS,name:"jrs"});if(d){var n,i=this.scripts?this.scripts:"scripts",a=r.href.replace("{scripts}",this.scripts),f=this.baseUrl+"/",h=l.partial(s,"Script loader configs for JRS: "),p=this;n=u({url:this.baseUrl+a,dataType:"text"}).then(c.loaderConfig).then(function(e){var r=e.baseUrl?e.baseUrl:i;return e.baseUrl=f+r,e.config&&e.config.logger&&(e.config.logger.enabled=p.isLoggerEnabled,e.config.logger.level=p.logLevel),e}).then(h),g.when(n).then(function(e){return e},e.reject).then(e.resolve)}else e.reject(new Error("Can't get RequireJS configs"));return e.promise()}}),n.exports=i});