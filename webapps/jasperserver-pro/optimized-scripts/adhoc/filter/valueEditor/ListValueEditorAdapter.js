/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","underscore","./AbstractValueEditor","../format/OlapFilterValueFormatter","../format/filterValueFormatter","runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelectNew"],function(e,t,i){var s=e("underscore"),a=e("./AbstractValueEditor"),l=e("../format/OlapFilterValueFormatter"),n=e("../format/filterValueFormatter"),r=e("runtime_dependencies/js-sdk/src/components/singleSelect/view/SingleSelectNew");i.exports=a.extend({tagName:"div",className:"values",initialize:function(e){this.list=this.createList(),a.prototype.initialize.apply(this,arguments)},createList:function(){return new r({getData:s.bind(this.model.dataProvider.getData,this.model),formatValue:this.model.isOlap?new l(this.model.get("isFirstLevelInHierarchyAll")).format:n})},registerEvents:function(){this.listenTo(this.list,"selection:change",s.bind(function(e,t){t&&this.model.set("isAnyValue",t.isTrueAll,{silent:!0}),this.setValue(s.isArray(e)?s.reject(e,function(e){return void 0===e}):e)},this))},render:function(){return this.$el.empty(),this.list.$el.hide(),this.$el.append(this.list.el),this.$el.append('<span class="message warning" data-validation-field="value"></span>'),this},renderData:function(){this.list.renderData()},_setValueToList:function(e){this.list.setValue(this.getValue(),e)},_removeAvailableData:function(){this.model.isOlap&&(this.model.removeAvailableData(),this.list.reset({silent:!0}))},updateData:function(){this._removeAvailableData();var e={};this.model.setShowLoading(!1),this.list.once("selection:change",s.bind(this.model.setShowLoading,this.model,!0)),this._setValueToList(e),this.list.$el.show(),this.trigger("rendered",this)},remove:function(){this.list.remove(),this.removeView(),a.prototype.remove.call(this)}})});