/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","./table.observers","../base/designer.base","underscore","runtime_dependencies/jrs-ui/src/util/utils.common","jquery"],function(e,n,a){var o=e("./table.observers"),t=e("../base/designer.base"),l=e("underscore"),d=e("runtime_dependencies/jrs-ui/src/util/utils.common"),i=d.encodeText,s=e("jquery");o.addFieldAsColumnAtPosition=function(e,n){if(o.canAddFieldAsColumn(e)){var a=window.adhocDesigner.isNoDataToDisplay(),l=function(e){o.hoverColumn=-1,window.localContext.standardTableOpCallback(e),a&&!window.adhocDesigner.isNoDataToDisplay()&&window.adhocDesigner.checkMaxRowsLimit()};t.sendRequest("ta_insertColumn",{"f[]":t.encodeParam(e),i:n},l,{bPost:!0})}},o.moveColumn=function(e,n,a,o){var d=o?e:l.pluck(window.selObjects,"index").join(","),i=n-e,s=function(e){window.localContext.standardTableOpCallback(e),a&&a(e)};t.sendRequest("ta_moveColumn",["indexes="+d,"offset="+i],s)},o.switchToColumn=function(e,n,a){!e&&window.selObjects.length>0&&(e=window.selObjects[0].fieldName,n=window.selObjects[0].index,a=-1),t.sendRequest("ta_switchToColumn",["item="+i(e),"from="+n,"to="+a],window.localContext.standardTableOpCallback)},o.removeColumn=function(e,n){var a=l.isNumber(e)?e:l.pluck(window.selObjects,"index").join(","),o=n||window.localContext.standardTableOpCallback;t.sendRequest("ta_removeColumn",["indexes="+a],o)},o.tableColumnResize=function(e,n){var a=function(e){window.localContext.standardTableOpCallback(e)};t.sendRequest("ta_resizeColumn",["i="+n,"w="+e],a)},o.setColumnHeaderToNull=function(e){var n=function(e){window.localContext.standardTableOpCallback(e)};t.sendRequest("ta_setColumnHeader",["i="+e,"l=_null","w=-1"],n)},o.updateColumnHeaderRequest=function(e,n,a){var o=function(e){window.localContext.standardTableOpCallback(e)};0===e.length?window.localContext.removeColumnHeaderRequest():t.sendRequest("ta_setColumnHeader",["i="+n,"l="+i(e),"w="+a],o)},o.setMask=function(e,n){var a=function(e){window.localContext.standardTableOpCallback(e),t.unSelectAll()};t.sendRequest("ta_setColumnMask",["m="+i(e),"i="+n],a)},o.updateViewCallback=function(e){window.localContext.standardOpCallback(e)},o.addFieldAsGroup=function(e,n){e||(n=-1,e=window.adhocDesigner.collectFields(window.adhocDesigner.getSelectedTreeNodes(),!0)),t.sendRequest("ta_insertGroup",{"f[]":t.encodeParam(e),i:n},window.localContext.standardTableOpCallback)},o.moveGroup=function(e,n,a){var o=function(e){window.localContext.standardTableOpCallback(e),a&&a()};t.sendRequest("ta_moveGroup",["i1="+e,"i2="+n],o)},o.switchToGroup=function(e,n,a){!e&&window.selObjects.length>0&&(e=s(window.selObjects[0].header).attr("data-fieldname"),n=window.selObjects[0].index,a=-1),t.sendRequest("ta_switchToGroup",["item="+i(e),"from="+n,"to="+a],window.localContext.standardTableOpCallback)},o.removeGroup=function(e,n){var a,o=parseInt(e),l=n||window.localContext.standardTableOpCallback;isNaN(o)&&(o=(a=window.adhocDesigner.getSelectedColumnOrGroup())&&a.index),t.sendRequest("ta_removeGroup",["i="+o],l)},o.updateGroupLabel=function(e,n){if(!e||e.blank())return void window.localContext.setGroupLabelToNull(n);var a=function(e){window.localContext.standardTableOpCallback(e)};t.sendRequest("ta_setGroupLabel",["g="+n,"l="+i(e)],a)},o.setGroupLabelToNull=function(e){var n=function(e){window.localContext.standardTableOpCallback(e)};t.sendRequest("ta_setGroupLabel",["g="+e,"l=_null"],n)},o.setGroupMask=function(e,n){var a=function(e){window.localContext.standardTableOpCallback(e)};t.sendRequest("ta_setGroupMask",["m="+i(e),"i="+n],a)},o.fetchMoreRows=function(){o.fetchingRows=!0,t.sendRequest("ta_"+o.FETCH_MORE_ROWS,[],this.Rendering.addMoreRows.bind(this.Rendering),null)},o.addDefaultColumnSummary=function(){var e=window.adhocDesigner.getSelectedColumnOrGroup();e&&t.sendRequest("ta_updateSummaryVisibility",["visible=true","i="+e.index],window.localContext.standardTableOpCallback)},o.removeColumnSummary=function(){var e=window.adhocDesigner.getSelectedColumnOrGroup();e&&t.sendRequest("ta_updateSummaryVisibility",["visible=false","i="+e.index],window.localContext.standardTableOpCallback)},o.setSummaryFunction=function(e,n){var a=function(e){window.localContext.standardTableOpCallback(e)};t.sendRequest("ta_setColumnSummaryFunction",["f="+i(e),"i="+n],a)},o.setTimeSummaryFunction=function(e,n){var a=function(e){window.localContext.standardTableOpCallback(e)};t.sendRequest("ta_setColumnTimeSummaryFunction",["f="+i(e),"i="+n],a)},o.toggleGridMode=function(e){t.sendRequest("ta_toggleGridMode",["mode="+e],window.localContext.standardTableOpCallback)},o.toggleDuplicateTableRows=function(e){t.sendRequest("ta_toggleDuplicateTableRows",["hideDuplicateTableRows="+e],window.localContext.standardTableOpCallback)},o.updateCustomFieldCallback=function(){window.localContext.standardTableOpCallback(),window.localContext.state.inDesignView&&window.adhocDesigner.updateAllFieldLabels()},o.getCallbacksForPivot=function(e){window.localContext.standardOpCallback(e)},o.standardOpCallback=function(e){e?window.localContext.standardTableOpCallback(e,!0):window.console&&console.log("Internal server error occurred")},o.standardTableOpCallback=function(e){window.adhocDesigner.updateStateAndRender(e)},a.exports=o});