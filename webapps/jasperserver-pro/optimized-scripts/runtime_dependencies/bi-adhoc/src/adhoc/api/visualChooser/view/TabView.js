/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","jquery","underscore","backbone","../VisualizationTypesController","text!../template/tabTemplate.htm","bundle!AdHocBundle"],function(e,i,t){var s=e("jquery"),n=e("underscore"),a=e("backbone"),r=e("../VisualizationTypesController"),o=e("text!../template/tabTemplate.htm"),l=e("bundle!AdHocBundle");t.exports=a.View.extend({className:"jr-mVisualchooser-panel jr",template:n.template(o),events:{"click .jr-mTab-item":"_onClickTab","click .jr-Visualchooser-panel-minimize":"_onClickMinimize","mouseenter .jr-mTab-item":"_onMouseEnter","mouseleave .jr-mTab-item":"_onMouseLeave"},constructor:function(e){this.options=n.defaults(e||{},this.defaults),this._selectedGroupName=null,this.typesManager=this.options.typesController,this._minimized=!1,n.isUndefined(this.options.minimized)||(this._minimized=this.options.minimized),this._tabSize={expanded:-1,collapsed:-1},this.typesManager||(this.typesManager=new r),a.View.apply(this,arguments)},initialize:function(){this.i18n=l,this.showDisabledIcons=!0},render:function(){var e=this.typesManager.getAllGroups();return this.$el.html(this.template({groups:e,showDisabledIcons:this.showDisabledIcons})),this.$tabElements=this.$("li.jr-mTab-item"),this.setMinimized(this._minimized),this},_onMouseEnter:function(e){this.$(e.currentTarget).hasClass("jr-isActive")||this.$(e.currentTarget).addClass("jr-isHovered")},_onMouseLeave:function(e){this.$(e.currentTarget).removeClass("jr-isHovered")},_onClickTab:function(e){var i=this.$(e.currentTarget),t=i.data("groupName");this.changeTabToGroupName(t)},changeTabToGroupName:function(e){var i=this.$tabElements.filter(function(i,t){return s(t).data("groupName")===e});1===i.length&&(this.$tabElements.filter(".jr-isActive").removeClass("jr-isActive"),this.$tabElements.filter(".jr-isHovered").removeClass("jr-isHovered"),i.addClass("jr-isActive"),this._selectedGroupName=e,this.trigger("change:groupSelected",this._selectedGroupName))},recordTabDimensions:function(){this._minimized&&-1===this._tabSize.collapsed&&(this._tabSize.collapsed=Math.round(this.$el.outerWidth())),this._minimized||-1!==this._tabSize.expanded||(this._tabSize.expanded=Math.round(this.$el.outerWidth()))},_onClickMinimize:function(){this.recordTabDimensions(),this.setMinimized(!this._minimized),this.recordTabDimensions(),this.trigger("tabMinimizedEvent",this._minimized,this._tabSize.expanded-this._tabSize.collapsed)},setShowDisabledIcons:function(e){this.showDisabledIcons=e},setMinimized:function(e){this._minimized=e;var i=s(".jr-mVisualchooser-body").width(),t=this.$el.parents("#visualSelector").find(".jr-mVisualchooser-body").width(),n=window.isDesignView?i:t,a=this.$(".jr-Visualchooser-panel-minimize-icon");this._minimized?(a.removeClass("jr-caretLeft").addClass("jr-caretRight"),this.$el.addClass("jr-isMinimized")):(a.removeClass("jr-caretRight").addClass("jr-caretLeft"),this.$el.removeClass("jr-isMinimized"));var r=window.isDesignView?s("#adhocVisual"):this.$el.parents("#visualSelector");r.width(n+this.$el.outerWidth()),r&&this.setDialogMinWidth(r)},setDialogMinWidth:function(e){var i;i=e.find(".jr-Visualchooser-panel-minimize-icon").hasClass("jr-caretLeft")?"502px":"312px",e.css({"min-width":i})},getSelectedGroupName:function(){return this._selectedGroupName},isMinimized:function(){return this._minimized}})});