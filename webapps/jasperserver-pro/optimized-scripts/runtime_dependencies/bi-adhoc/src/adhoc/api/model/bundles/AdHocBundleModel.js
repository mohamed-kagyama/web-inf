/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","backbone","underscore","./RepositoryBundleFileModel","runtime_dependencies/bi-repository/src/bi/repository/enum/repositoryResourceTypes"],function(e,i,t){function o(e){if(c.FILE in e)this.resource=new n(e[c.FILE],{contextPath:this.collection.CONTEXT_PATH});else{if(!e.fileReference)throw new Error("Unknown value",e);this.resource=new n(e.fileReference,{contextPath:this.collection.CONTEXT_PATH})}}var r=e("backbone"),s=e("underscore"),n=e("./RepositoryBundleFileModel"),c=e("runtime_dependencies/bi-repository/src/bi/repository/enum/repositoryResourceTypes"),u=r.Model.extend({idAttribute:"locale",defaults:{locale:void 0,file:void 0},initialize:function(){this.updateResource(),this.on("change:file",this.updateResource),this.on("change:fileReference",this.updateResource)},updateResource:function(){var e=this.get("file")||this.get("fileReference");e&&s.isObject(e)&&(this.resource?this.resource.set(e):o.call(this,e))},toJSON:function(e){var i=r.Model.prototype.toJSON.apply(this,arguments);return i.file={},this.resource.isNew()||!0===e?i.file.file=this.resource.toJSON(!0):i.file.fileReference={uri:this.resource.get("uri")},i},toLabel:function(e){return this.resource.contentJSON[e]}});t.exports=u});