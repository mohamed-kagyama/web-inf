/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","backbone"],function(e,n,r){var t=e("backbone"),i={LOCALE_SPECIFIC:"\xa4",USD:"$",GBP:"\xa3",EUR:"\u20ac",YEN:"\xa5"};r.exports=t.Model.extend({defaults:function(){return{backgroundColor:void 0,align:void 0,font:{name:void 0,size:11,bold:!1,italic:!1,underline:!1,color:"000000"}}},initialize:function(e,n){n||(n={}),this.dataType=n.dataType},parse:function(e){var n={align:e.fontHAlign.toLowerCase(),backgroundColor:"Opaque"===e.mode?e.fontBackColor:"transparent",font:{name:e.fontName,size:parseFloat(e.fontSize),italic:e.fontItalic,bold:e.fontBold,underline:e.fontUnderline,color:e.fontColor}};if(e.formatPattern)if("numeric"===this.dataType&&"[h]:mm:ss"===e.formatPattern)n.pattern=e.formatPattern;else if("numeric"===this.dataType){var r=e.formatPattern,t=new RegExp("0\\.(0+)"),i=!1,a=!1,o=0,c="-###0",l=null;r.indexOf(",")>-1&&(i=!0,r=r.replace(/,/g,"")),r.indexOf("%")>-1&&(a=!0,r=r.replace(/%/g,"")),r.indexOf("\xa4")>-1?(l="LOCALE_SPECIFIC",r=r.replace(/\u00A4/g,"")):r.indexOf("$")>-1?(l="USD",r=r.replace(/\u0024/g,"")):r.indexOf("\xa3")>-1?(l="GBP",r=r.replace(/\u00A3/g,"")):r.indexOf("\u20ac")>-1?(l="EUR",r=r.replace(/\u20AC/g,"")):r.indexOf("\xa5")>-1&&(l="YEN",r=r.replace(/\u00A5/g,"")),r=r.replace(/\s/g,"");var f=t.exec(r);f&&2==f.length&&(o=f[1].length,r=r.replace(new RegExp("\\."+Array(o+1).join("0"),"g"),""));var p=r.split(";");p&&2===p.length&&(c=p[1]),n.pattern={negativeFormat:c,currency:l,precision:o,grouping:i,percentage:a}}else n.pattern=e.formatPattern;return n},toJiveFormat:function(){if(this.has("pattern")){if("numeric"!==this.dataType||"numeric"===this.dataType&&"[h]:mm:ss"===this.get("pattern"))return this.get("pattern");var e=this.get("pattern"),n="###0",r=e.negativeFormat||"-###0";if(e.percentage&&(n+=" %",r+=" %"),e.currency&&i[e.currency]&&(n=i[e.currency]+" "+n,r=i[e.currency]+" "+r),e.grouping){var t=n.indexOf("#");n=n.slice(0,t)+"#,"+n.slice(t+1),t=r.indexOf("#"),r=r.slice(0,t)+"#,"+r.slice(t+1)}if(e.precision){var t=n.indexOf("##0");n=n.slice(0,t)+"##0."+Array(e.precision+1).join("0")+n.slice(t+3),t=r.indexOf("##0"),r=r.slice(0,t)+"##0."+Array(e.precision+1).join("0")+r.slice(t+3)}return n+";"+r}return""}})});