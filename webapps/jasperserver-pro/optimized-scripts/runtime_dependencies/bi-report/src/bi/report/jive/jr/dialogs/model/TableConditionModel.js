/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","backbone.epoxy","underscore","../../../util/jiveDataConverter","runtime_dependencies/js-sdk/src/common/util/parse/NumberUtils"],function(e,t,i){function r(){var e,t,i=this.get("value"),r=this.get("operator");e=r&&-1!=r.toLowerCase().indexOf("between"),t=r&&-1!==r.toLowerCase().indexOf("null"),!0===e?a.isArray(i)||this.set({value:[i]},{silent:!0}):!1===e&&a.isArray(i)&&this.set({value:i[0]},{silent:!0}),t&&this.set({value:""})}function n(e,t,i,r,n){var l,s,c;if(null===r||void 0===r)l="No value supplied!";else if("datetime"===e)try{void 0===o.jQueryUiTimestampToIsoTimestamp(r,i)&&(l="Unparsable date: "+r+" !")}catch(e){l=e}else if("time"===e)try{void 0===o.jQueryUiTimeToIsoTime(r,i)&&(l="Unparsable time: "+r+" !")}catch(e){l=e}else"numeric"===e&&o.DURATION_PATTERN===t&&(s=a.trim(r),s.length>0?(c=s.split(":"),c.length>3?l="Unparsable duration: "+r+" !":(void 0===u.parseNumber(c[0])||c.length>1&&(void 0===u.parseNumber(c[1])||u.parseNumber(c[1])>59)||c.length>2&&(void 0===u.parseNumber(c[2])||u.parseNumber(c[2])>59))&&(l="Unparsable duration: "+r+" !")):l="Empty value supplied!");return this.trigger("validate:"+n,this,n,l),l}var l=e("backbone.epoxy"),a=e("underscore"),o=e("../../../util/jiveDataConverter"),s=e("runtime_dependencies/js-sdk/src/common/util/parse/NumberUtils"),u=new s;i.exports=l.Model.extend({defaults:function(){return{operator:null,value:null,backgroundColor:null,font:{bold:null,italic:null,underline:null,color:null}}},computeds:function(){var e={};return a.each(this.defaults().font,function(t,i){e["font"+i.charAt(0).toUpperCase()+i.substring(1,i.length)]={deps:["font"],get:function(e){return e[i]},set:function(e){return this.modifyObject("font",i,e),e}}}),e.isMultiValueOperator=function(){var e=this.get("operator");return!(!e||-1==e.toLowerCase().indexOf("between"))},e.isNotNullCheckOperator=function(){var e=this.get("operator");return!!(!e||-1===e.toLowerCase().indexOf("null"))},e},initialize:function(){this.on("change:operator",a.bind(r,this)),l.Model.prototype.initialize.apply(this,arguments)},reset:function(){return this.set(this.defaults(),{silent:!0}),this},validate:function(e,t){var i,r,l=e.value,s=e.operator,u=o.dataTypeToSchemaFormat[this.collection.dataType],c=this.collection.conditionPattern,d=this.collection.genericProperties;if("IS_NULL"!==s&&"IS_NOT_NULL"!==s)if("IS_TRUE"!==s&&"IS_NOT_FALSE"!==s&&"IS_NOT_TRUE"!==s&&"IS_FALSE"!==s||(l="true/false"),null!==l&&void 0!==l||this.get("isMultiValueOperator")&&(l=[null,null]),a.isArray(l)){if(i=n.call(this,u,c,d,l[0],"valueStart"),r=n.call(this,u,c,d,l[1],"valueEnd"),i||r)return"Invalid value supplied!"}else if(n.call(this,u,c,d,l,"valueStart"))return"Invalid value supplied!"},remove:function(){}})});