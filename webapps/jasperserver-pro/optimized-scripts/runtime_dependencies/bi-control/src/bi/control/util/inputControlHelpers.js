/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","jquery","underscore"],function(e,t,n){var i=e("jquery"),r=e("underscore"),a=navigator.userAgent.toLowerCase().indexOf("msie")>-1;n.exports={LOADING_DIALOG_DELAY:800,isElementInDom:function(e){var t=e.nextSibling,n=e.parentNode&&11!==e.parentNode.nodeType;return t||n},setInnerHtml:function(e,t,n){var s,l,o;if(this.isElementInDom(e)&&(s=e.nextSibling,l=e.parentNode,o=e.style.display,e.style.display="none",l.removeChild(e)),i(e).html(""),a&&"SELECT"==e.tagName){var u=document.createDocumentFragment();r.each(n.data,function(e){var t=document.createElement("OPTION");t.value=r.isUndefined(e.value)?e.id:e.value,i(t).html(e.label),e.selected&&t.setAttribute("selected","selected"),u.appendChild(t)}),e.appendChild(u)}else i(e).html(t(n));if(s?l.insertBefore(e,s):l.appendChild(e),e.style.display=o,a&&"SELECT"==e.tagName){var d=e.getAttribute("style");e.removeAttribute("style"),e.setAttribute("style",d)}},wait:function(e){return i.Deferred(function(t){setTimeout(t.resolve,e)})},showLoadingDialogOn:function(e,t,n){this.wait(t||this.LOADING_DIALOG_DELAY).then(r.bind(function(){"pending"==e.state()&&i.when(e).always(r.bind(function(){this.wait(500).then(function(){})},this))},this))},createTimer:function(e){var t=new i.Deferred;return t.done(function(t){var n=(new Date).getTime(),i=n-t;console.log(e+" took time: "+i+" msec.")}),{start:function(){return this.startTime=(new Date).getTime(),this},stop:function(){return t.resolve(this.startTime),this}}},merge:function(e,t){return r.isNull(e)||r.isUndefined(e)?t:r.isNull(t)||r.isUndefined(t)?e:r.isArray(t)?r.map(e,function(e){return void 0!==r.find(t,function(t){return t===e.value})?e.selected=!0:delete e.selected,e}):this.merge(e,[t])},extractSelection:function(e,t){if(!e)return null;for(var n={},i=0;i<e.length;i++){var r=e[i];if(r.selected&&(n[i]=r.value,t))break}return n},isSelectionChanged:function(e,t){var n=e?r(e).keys():[],i=t?r(t).keys():[];if(r.union(n,i).length===n.length){var a=e?r.flatten(r(e).values()):[],s=t?r.flatten(r(t).values()):[];return r.difference(a,s).length>0||r.difference(s,a).length>0}return!0}}});