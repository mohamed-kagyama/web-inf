/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","../../base/componentViewTrait/inputControlTrait","../../../dashboardMessageBus","../../../enum/dashboardMessageBusEvents","../../../collection/ReportsParametersCollection","underscore"],function(e,t,n){var o=e("../../base/componentViewTrait/inputControlTrait"),i=e("../../../dashboardMessageBus"),s=e("../../../enum/dashboardMessageBusEvents"),l=e("../../../collection/ReportsParametersCollection"),r=e("underscore"),a=l.instance;n.exports=r.extend({},o,{_onViewInitialize:function(){var e=this;o._onViewInitialize.apply(this,arguments),this.stopListening(this.model,"change:value"),this.listenTo(i,s.TOGGLE_PREVIEW_MODE,function(t){if(!t)for(var n in e.component.controlViews)"singleSelectRadio"===e.component.controlViews[n].model.get("type")&&e.component.controlViews[n].updateOptionsSelection()})},_initComponent:function(){var e=this;o._initComponent.apply(this,arguments),this.listenTo(a,"change:inputControl",function(t){t.id===e.model.getOwnerUri()&&e.reset()})},_onComponentPropertiesChange:function(){var e=this.model.changedAttributes(),t=this.inputControlCollection.models[0];e&&"label"in e&&(t&&t.set({label:this.model.get("label")}),this.component.render())},reset:function(){var e=this,t=arguments;this.inputControlCollection.models&&this.inputControlCollection.models.length>0?o.reset.apply(this,arguments):a.getReportControls(this.model.getOwnerUri()).done(function(n){var i=r.findWhere(n,{id:e.model.getOwnerParameterName()});if(i){var s=r.extend({},i,{label:e.model.get("label")||i.label,slaveDependencies:[],state:{},isDesignerMode:!0});e.inputControlCollection.reset([s])}o.reset.apply(e,t)}).fail(function(){o.reset.apply(e,t)})}})});