/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

define(["require","exports","module","prototype","../components/components.dialogs","underscore","./repository.search.main","../actionModel/actionModel.modelGenerator","../namespace/namespace","../core/core.ajax","../core/core.ajax.utils","../util/utils.common","jquery","../core/core.layout"],function(e,r,t){var o=e("prototype"),n=o.$,i=e("../components/components.dialogs"),c=e("underscore"),a=e("./repository.search.main"),d=a.repositorySearch,u=a.ResourcesUtils,s=a.invokeResourceAction,R=a.isPropertiesChanged,l=a.isPermissionsChanged,p=e("../actionModel/actionModel.modelGenerator"),f=e("../namespace/namespace"),A=f.JRS,E=e("../core/core.ajax"),I=E.ajax,w=E.ajaxTargettedUpdate,U=E.AjaxRequester,F=e("../core/core.ajax.utils"),T=F.baseErrorHandler,D=e("../util/utils.common"),m=D.ajaxIframeDownload,h=D.doNothing,C=D.redirectToUrl,v=D.downloadFileByUrl,y=e("jquery"),S=e("../core/core.layout");d.Action=function(e){Object.isFunction(e)&&(this.invokeAction=e)},d.Action.DEFAULT="default-action",d.Action.addMethod("invokeAction",h),d.folderActionFactory={CreateFolder:function(e){return new d.Action(function(){d.showCreateFolderConfirm(e)})},CopyFolder:function(e){return new d.Action(function(){d.CopyMoveController.copy(e)})},MoveFolder:function(e){return new d.Action(function(){d.CopyMoveController.move(e)})},PasteFolder:function(e){return new d.Action(function(){var r,t=e||d.model.getContextFolder();d.CopyMoveController.object;if(d.CopyMoveController.isCopyFolder())r=d.FolderAction.COPY;else{if(!d.CopyMoveController.isMoveFolder())return;r=d.FolderAction.MOVE}new d.ServerAction.createFolderAction(r,{toFolder:t,folder:d.CopyMoveController.object}).invokeAction()})},PasteResources:function(e){return new d.Action(function(){var r,t=e||d.model.getContextFolder();t||(t=d.model.getSelectedFolder());var o=d.CopyMoveController.object,n=d.CopyMoveController.isBulkAction()?[].concat(o):[o];if(d.CopyMoveController.isCopyResource())r=d.ResourceAction.COPY;else{if(!d.CopyMoveController.isMoveResource())return;r=d.ResourceAction.MOVE}for(var i=0;i<n.length;i++)if(n[i].parentResource){for(var c=n[i].parentResource.URI,a=!1,u=0;u<n.length&&!a;u++)a|=n[u].URI==c;a||n.push(n[i].parentResource)}new d.ServerAction.createResourceAction(r,{resources:n,folder:t}).invokeAction()})},DeleteFolder:function(e){return new d.Action(function(){p.hideMenu(),d.showDeleteFolderConfirm(e)})},ShowFolderProperties:function(e){return new d.Action(function(){d.showFolderProperties(e)})},EditFolderProperties:function(e){return new d.Action(function(){d.editFolderProperties(e)})},AssignPermissions:function(e){return new d.Action(function(){d.editFolderPermissions(e)})},SetActiveThemeFolder:function(e){return new d.Action(function(){new d.ServerAction.createFolderAction(d.ThemeAction.SETTHEME,{folder:e}).invokeAction()})},DownloadTheme:function(e){return new d.Action(function(){new d.ServerAction.createFolderAction(d.ThemeAction.DOWNLOAD_THEME,{folder:e}).initDownload()})},UploadTheme:function(e){return new d.Action(function(){d.showUploadThemeConfirm(e,!1)})},ReuploadTheme:function(e){return new d.Action(function(){d.showUploadThemeConfirm(e,!0)})},Export:function(e){return new d.Action(function(){d.exportDialog.openRepoDialog(e)})}},d.resourceActionFactory={Copy:function(e){return new d.Action(function(){d.CopyMoveController.copy(e)})},Move:function(e){return new d.Action(function(){d.CopyMoveController.move(e)})},Delete:function(e){return new d.Action(function(){p.hideMenu(),d.showDeleteResourceConfirm(e)})},Export:function(e,r){return new d.Action(function(){d.exportDialog.openRepoDialog(e)})},ShowProperties:function(e,r){return new d.Action(function(){d.showResourceProperties(e,r)})},EditProperties:function(e,r){return new d.Action(function(){d.editResourceProperties(e,r)})},AssignPermissionsToResourceAction:function(e){return new d.Action(function(){d.editResourcePermissions(e)})},GenerateResourceAction:function(e,r){return new d.Action(function(){A.CreateReport.selectGenerator(e.URIString)})},ConvertResourceAction:function(e,r){return new d.Action(function(){new d.ServerAction.createConvertAction(d.ResourceAction.CONVERT,{reportUri:e.URIString}).invokeAction()})}},d.bulkActionFactory={Run:function(e){return new d.Action(function(){e.each(function(e,r){d.RedirectAction.createRunResourceAction(e,0!==r).invokeAction()})})},Edit:function(e){return new d.Action(function(){e.each(function(e,r){d.RedirectAction.createEditResourceAction(e,0!==r).invokeAction()})})},Open:function(e){return new d.Action(function(){e.each(function(r,t){d.RedirectAction.createOpenResourceAction(r,e.length>1).invokeAction()})})},Copy:function(e){return new d.Action(function(){d.CopyMoveController.copy(e)})},Move:function(e){return new d.Action(function(){d.CopyMoveController.move(e)})},Delete:function(e){return new d.Action(function(){p.hideMenu(),1==e.length?d.showDeleteResourceConfirm(e[0]):d.showBulkDeleteResourcesConfirm(e)})},ShowProperties:function(e){return new d.Action(function(){e.each(function(r,t){s("ShowProperties",r,{cascade:!0,position:t,number:e.length})})})},EditProperties:function(e){return new d.Action(function(){e.each(function(r,t){s("EditProperties",r,{cascade:!0,position:t,number:e.length})})})},Export:function(e){return new d.Action(function(){d.exportDialog.openRepoDialog(e)})}},d.ServerAction=function(e,r){this.actionURL="flow.html?_flowExecutionKey="+d.flowExecutionKey+"&_eventId="+e,this.data=Object.toQueryString(r.data)},d.ServerAction.addMethod("invokeAction",function(){w(this.actionURL,{postData:this.data,callback:function(e){"OK"==e.status?this.onSuccess(e.data):this.onError(e.data)}.bind(this),errorHandler:this._serverErrorHandler,mode:U.prototype.EVAL_JSON})}),d.ServerAction.addMethod("initDownload",function(){var e=this.actionURL+"&"+this.data;m(e,{onload:function(){var e=y(n("ajax-download-iframe").contentDocument.body).html();try{var r=e.evalJSON();alert(r.data)}catch(e){}}})}),d.ServerAction.addMethod("_serverErrorHandler",function(e){return T(e)}),d.ServerAction.addMethod("onSuccess",h),d.ServerAction.addMethod("onError",h),d.ServerAction.createSearchAction=function(e,r){r.mode=d.mode;var t=new d.ServerAction(e,{data:r});return t.onSuccess=function(t){e==d.SearchAction.NEXT?d.fire(d.Event.RESULT_NEXT,t):e==d.SearchAction.GET_RESOURCE_CHILDREN?d.fire(d.Event.CHILDREN_LOADED,{inputData:r,responseData:t}):(d.fire(d.Event.RESULT_CHANGED,t),d.fire(d.Event.STATE_CHANGED,t),d.mode==d.Mode.SEARCH&&d.fire(d.Event.FILTER_PATH_CHANGED,t))},t.onError=function(e){d.fire(d.Event.RESULT_ERROR,e)},t},d.ServerAction.createFolderAction=function(e,r){var t,o,n;d.FolderAction.DELETE==e?(t={sourceFolderUri:r.folder.URI},o=d.FolderEvent.DELETED,n=d.FolderEvent.DELETE_ERROR):d.FolderAction.CREATE==e?(t={destFolderUri:r.toFolder.URI,folder:Object.toJSON({URI:"",label:r.label,desc:r.desc})},o=d.FolderEvent.CREATED,n=d.FolderEvent.CREATE_ERROR):d.FolderAction.COPY==e?(t={destFolderUri:r.toFolder.URI,sourceFolderUri:r.folder.URI},o=d.FolderEvent.COPIED,n=d.FolderEvent.COPY_ERROR):d.FolderAction.MOVE==e?(t={destFolderUri:r.toFolder.URI,sourceFolderUri:r.folder.URI},o=d.FolderEvent.MOVED,n=d.FolderEvent.MOVE_ERROR):d.FolderAction.UPDATE==e?(t={folder:Object.toJSON({URI:r.folder.URI,label:r.folder.label,desc:r.folder.description})},o=d.FolderEvent.UPDATED,n=d.FolderEvent.UPDATE_ERROR):d.ThemeAction.SETTHEME==e?(r.folder?t={folderUri:r.folder.URI}:r.folderUri&&(t={folderUri:r.folderUri}),o=d.ThemeEvent.UPDATED):d.ThemeAction.DOWNLOAD_THEME==e?(t={folderUri:r.folder.URI},n=d.ThemeEvent.THEME_ERROR):d.ThemeAction.REUPLOAD==e&&(t={themeName:r.themeName,folderUri:r.folderUri},o=d.ThemeEvent.REUPLOADED,n=d.ThemeEvent.THEME_ERROR),t&&o&&n||new Error("Unsupported folder action.");var i=new d.ServerAction(e,{data:t});return i.onSuccess=function(e){d.fire(o,{responseData:e,inputData:r})},i.onError=function(e){d.fire(n,{responseData:e,inputData:r})},i},d.ServerAction.createResourceAction=function(e,r){function t(t,o){i.dependentResources.show(t,{dependenciesBtnOk:function(){new d.ServerAction.createResourceAction(e,{resources:o,folder:r.folder}).invokeAction()}},{buttons:["ok","cancel"],dialogTitle:d.getMessage("dialog.resources.exist.title"),topMessage:d.getMessage("dialog.resources.exist"),bottomMessage:d.getMessage("dialog.resources.exist.confirm.skip")})}function o(o){var n;if(d.ResourceAction.COPY!=e&&d.ResourceAction.MOVE!=e)return o;try{n=JSON.parse(o)}catch(e){return o}if(!n||!n.existingLabels)return o;var i=c.filter(r.resources,function(e){return-1==n.existingLabels.indexOf(e.label)});return 0===i.length?(1==n.existingLabels.length?d.getMessage("dialog.resources.one.exists"):d.getMessage("dialog.resources.all.exist"))+" "+r.folder.URIString:(t(n.existingLabels,i),null)}var n,a,s;if(d.ResourceAction.DELETE==e){var R=u.getResourceUriAndTypeList(r.resources);n={selectedResources:Object.toJSON(R)},a=d.ResourceEvent.DELETED,s=d.ResourceEvent.DELETE_ERROR}else if(d.ResourceAction.COPY==e){var l=u.getResourceUris(r.resources);n={selectedResources:Object.toJSON(l),destFolderUri:r.folder.URI},a=d.ResourceEvent.COPIED,s=d.ResourceEvent.COPY_ERROR}else if(d.ResourceAction.MOVE==e){var p=u.getResourceUris(r.resources);n={selectedResources:Object.toJSON(p),destFolderUri:r.folder.URI},a=d.ResourceEvent.MOVED,s=d.ResourceEvent.MOVE_ERROR}else d.ResourceAction.UPDATE==e&&(n={selectedResource:Object.toJSON(r.resource)},a=d.ResourceEvent.UPDATED,s=d.ResourceEvent.UPDATE_ERROR);n&&a&&s||new Error("Unsupported resource action.");var f=new d.ServerAction(e,{data:n});return f.onSuccess=function(t){d.ResourceAction.MOVE==e&&d.CopyMoveController.cancel(),d.fire(a,{responseData:t,inputData:r})},f.onError=function(e){var t=o(e);t&&d.fire(s,{responseData:t,inputData:r})},f},d.ServerAction.createPermissionAction=function(e,r){var t=new d.ServerAction(e,{data:r}),o=e==d.PermissionAction.UPDATE?d.PermissionEvent.UPDATED:d.PermissionEvent.LOADED;return t.onSuccess=function(t){d.fire(o,{responseData:t,inputData:r,doSet:e!=d.PermissionAction.NEXT})},t.onError=function(e){d.fire(d.PermissionEvent.ERROR,e)},t},d.ServerAction.createGenerateAction=function(e,r){var t=new d.ServerAction(e,{data:{data:Object.toJSON(r)}});return t.actionURL="reportGenerator.html?action="+e,t.onSuccess=function(e){d.fire(d.ResourceEvent.GENERATED,{responseData:e,inputData:r})},t.onError=function(e){d.fire(d.ResourceEvent.GENERATE_ERROR,{responseData:e,inputData:r})},t},d.ServerAction.createConvertAction=function(e,r){var t=new d.ServerAction(e,{data:r});return t.actionURL="dataViewConverter.html?action="+e,t.onSuccess=function(e){d.fire(d.ResourceEvent.CONVERTED,{responseData:e,inputData:r})},t.onError=function(e){d.fire(d.ResourceEvent.CONVERT_ERROR,{responseData:e,inputData:r})},t},d.RedirectAction=function(e,r){this.DIMMER_TIMEOUT=400,this.type=e,this.flowId=r.flowId,this.url=r.url?r.url:this.flowId?this.FLOW_URL:void 0,this.paramsMap=r.paramsMap||{},this.hash=r.hash?"#"+r.hash:"",this.encode=r.encode,this.type!==d.RedirectType.FLOW_REDIRECT&&this.url===this.FLOW_URL&&(this.paramsMap._flowId=this.flowId)},d.RedirectAction.addMethod("FLOW_URL","flow.html"),d.RedirectAction.addMethod("_serializeParams",function(e,r){if(e){var t="";for(var o in e)Object.isUndefined(o)||(t+="&"+o+"="+(r?encodeURIComponent(e[o]):e[o]));return t&&t.length>0?t.substring(1):""}return""}),d.RedirectAction.addMethod("invokeAction",function(e){e=e||{};var r=y("#"+I.LOADING_ID);if(r.length>0&&(r.addClass(S.CANCELLABLE_CLASS),r.find("#cancel").click(function(){y(this).addClass("disabled"),r.addClass("cancelCalled"),window.location.reload()})),this.type===d.RedirectType.FLOW_REDIRECT){var t=n("redirectForm");n("flowParams").setValue(this.flowId+"?"+this._serializeParams(this.paramsMap,this.encode));var o=new d.ServerAction("isServerAvailable",{data:{}}),c=setTimeout(function(){i.popup.show(I.LOADING_ID,!0)},this.DIMMER_TIMEOUT);o.onSuccess=function(e){"Yes"==e.strip()?(++I.ajaxRequestCount,r.hasClass("cancelCalled")?r.removeClass("cancelCalled"):t.submit(),d.fire(d.Event.FLOW_REDIRECT_RUNNING,e)):(a(),d.fire(d.Event.REDIRECT_ERROR,e))},o.onError=function(e){a(),d.fire(d.Event.REDIRECT_ERROR,e)};var a=function(){clearTimeout(c),i.popup.hide(I.LOADING_ID)};o.invokeAction()}else if(this.type===d.RedirectType.LOCATION_REDIRECT){var u=this.url+(y.isEmptyObject(this.paramsMap)?"":"?"+this._serializeParams(this.paramsMap,this.encode))+this.hash;e.isContentResource?v(u):C(u)}else if(this.type===d.RedirectType.WINDOW_REDIRECT){var s=window.open(),R=this._serializeParams(this.paramsMap,this.encode);s.opener=null,s.document.location=this.url+(R?"?"+R:"")+this.hash}}),d.runActionFactory={ReportUnit:function(e,r){var t=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.FLOW_REDIRECT;return new d.RedirectAction(t,{url:"flow.html",flowId:"viewReportFlow",paramsMap:{_flowId:"viewReportFlow",reportUnit:r?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder}})},AdhocReportUnit:function(e,r){var t=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.FLOW_REDIRECT;return new d.RedirectAction(t,{url:"flow.html",flowId:"viewAdhocReportFlow",paramsMap:{reportUnit:r?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder}})},OlapUnit:function(e,r){var t=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.LOCATION_REDIRECT;return new d.RedirectAction(t,{url:"olap/viewOlap.html",paramsMap:{name:r?encodeURIComponent(e.URIString):e.URIString,new:!0,parentFlow:"searchFlow",ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder}})},DashboardResource:function(e,r){var t=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.FLOW_REDIRECT;return new d.RedirectAction(t,{url:"flow.html",flowId:"dashboardRuntimeFlow",paramsMap:{dashboardResource:r?encodeURIComponent(e.URIString):e.URIString}})},DashboardModelResource:function(e,r){var t=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.LOCATION_REDIRECT;return new d.RedirectAction(t,{url:"dashboard/viewer.html#"+encodeURIComponent(e.URIString)})},ReportOptions:function(e,r){var t,o={reportOptionsURI:r?encodeURIComponent(e.URIString):e.URIString,standAlone:!0,ParentFolderUri:r?encodeURIComponent(e.parentFolder):e.parentFolder},n=e.parentResource;n&&n.typeEquals(d.ResourceType.ADHOC_REPORT_UNIT)?(t="viewAdhocReportFlow",o.reportUnit=r?encodeURIComponent(n.URIString):n.URIString):t="viewReportFlow";var i=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.FLOW_REDIRECT;return new d.RedirectAction(i,{url:"flow.html",flowId:t,paramsMap:o})}},d.RedirectAction.createRunResourceAction=function(e,r){e||(e=e||d.model.getSelectedResources()[0]);var t=d.runActionFactory[e.typeSuffix()];return t?t(e,r):new d.Action(function(){alert("Run action for resource type '"+e.resourceType+"' is not implemented!")})},d.RedirectAction.createRunResourceInNewTabAction=function(e,r){return d.RedirectAction.createRunResourceAction(e,!0)},d.editActionFactory={"default-action":function(e,r){return u.isCustomDataSource(e)?d.editActionFactory.JdbcReportDataSource(e,r):new d.Action(function(){alert("Edit action for resource type '"+e.resourceType+"' is not implemented!")})},ReportUnit:function(e,r){return new d.RedirectAction(r,{flowId:"reportUnitFlow",paramsMap:{selectedResource:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocReportUnit:function(e,r){return d.editActionFactory.ReportUnit(e,r)},DataDefinerUnit:function(e,r){return new d.RedirectAction(r,{flowId:"queryBuilderFlow",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})},OlapUnit:function(e,r){return new d.RedirectAction(r,{flowId:"olapUnitFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},DashboardResource:function(e,r){return new d.RedirectAction(r,{flowId:"dashboardRuntimeFlow",paramsMap:{dashboardResource:e.URIString}})},ReportOptions:function(e,r){return new d.RedirectAction(r,{flowId:"reportOptionsEditFlow",paramsMap:{reportOptionsURI:e.URIString,ParentFolderUri:e.parentFolder}})},JdbcReportDataSource:function(e,r){return new d.RedirectAction(r,{flowId:"addDataSourceFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},JndiJdbcReportDataSource:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},CustomReportDataSource:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},BeanReportDataSource:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},VirtualReportDataSource:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},HiveDataSourceService:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},CassandraDataSourceService:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},DiagnosticCustomDataSourceService:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},MongoDbDataSourceService:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},AwsReportDataSource:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},AzureSqlReportDataSource:function(e,r){return d.editActionFactory.JdbcReportDataSource(e,r)},Query:function(e,r){return new d.RedirectAction(r,{flowId:"queryFlow",paramsMap:{currentQuery:e.URIString,isEdit:!0,ParentFolderUri:e.parentFolder}})},InputControl:function(e,r){return new d.RedirectAction(r,{flowId:"addInputControlFlow",paramsMap:{isEdit:!0,resource:e.URIString,ParentFolderUri:e.parentFolder}})},ListOfValues:function(e,r){return new d.RedirectAction(r,{flowId:"addListOfValuesFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},DataType:function(e,r){return new d.RedirectAction(r,{flowId:"dataTypeFlow",paramsMap:{resource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},MondrianConnection:function(e,r){return new d.RedirectAction(r,{flowId:"olapClientConnectionFlow",paramsMap:{selectedResource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},SecureMondrianConnection:function(e,r){return d.editActionFactory.MondrianConnection(e,r)},XMLAConnection:function(e,r){return d.editActionFactory.MondrianConnection(e,r)},MondrianXMLADefinition:function(e,r){return new d.RedirectAction(r,{flowId:"mondrianXmlaSourceFlow",paramsMap:{selectedResource:e.URIString,isEdit:"edit",ParentFolderUri:e.parentFolder}})},FileResource:function(e,r){return new d.RedirectAction(r,{flowId:"addFileResourceFlow",paramsMap:{selectedResource:e.URIString,ParentFolderUri:e.parentFolder}})},SemanticLayerDataSource:function(e,r){return new d.RedirectAction(r,{url:"domaindesigner.html",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})}},d.resourceTypeToDefaultRedirectTypeMap={},d.resourceTypeToDefaultRedirectTypeMap[d.ResourceType.SEMANTIC_LAYER_DATA_SOURCE]=d.RedirectType.LOCATION_REDIRECT,d.getDefaultRedirectTypeByResourceType=function(e){var r=d.resourceTypeToDefaultRedirectTypeMap[e];return r||(r=d.RedirectType.FLOW_REDIRECT),r},d.RedirectAction.createEditResourceAction=function(e,r){e||(e=d.model.getSelectedResources()[0]);var t;t=r?d.RedirectType.WINDOW_REDIRECT:d.getDefaultRedirectTypeByResourceType(e.resourceType);var o=d.editActionFactory[e.typeSuffix()];return o?o(e,t):d.editActionFactory[d.Action.DEFAULT](e,t)},d.openActionFactory={ContentResource:function(e,r){return r===d.RedirectType.FLOW_REDIRECT&&(r=d.RedirectType.LOCATION_REDIRECT),new d.RedirectAction(r,{url:"fileview/fileview"+e.URIString,paramsMap:{}})},DashboardResource:function(e,r){return new d.RedirectAction(r,{flowId:"dashboardDesignerFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},DashboardModelResource:function(e,r){var t=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.LOCATION_REDIRECT;return new d.RedirectAction(t,{url:"dashboard/designer.html#"+encodeURIComponent(e.URIString)})},DataDefinerUnit:function(e,r){return new d.RedirectAction(r,{flowId:"queryBuilderFlow",paramsMap:{uri:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocReportUnit:function(e,r){return new d.RedirectAction(r,{flowId:"adhocFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})},AdhocDataView:function(e,r){return new d.RedirectAction(r,{flowId:"adhocFlow",paramsMap:{resource:e.URIString,ParentFolderUri:e.parentFolder}})}},d.RedirectAction.createOpenResourceAction=function(e,r){e||(e=d.model.getSelectedResources()[0]);var t=r?d.RedirectType.WINDOW_REDIRECT:d.RedirectType.FLOW_REDIRECT,o=d.openActionFactory[e.typeSuffix()];return o?o(e,t):new d.Action(function(){alert("Open action for resource type '"+e.resourceType+"' is not implemented!")})},d.RedirectAction.createRunInBackgroundResourceAction=function(){var e=d.model.getSelectedResources()[0],r="";if(e.resourceType.endsWith(".ReportUnit")||e.resourceType.endsWith(".AdhocReportUnit")||e.resourceType.endsWith(".DashboardModelResource")||e.resourceType.endsWith(".ReportOptions"))return e.parentResource&&(r="@@parentReportURI="+e.parentResource.URIString+"@@"),new d.RedirectAction(d.RedirectType.LOCATION_REDIRECT,{url:A.vars.contextPath+"/scheduler/main.html",paramsMap:{reportUnitURI:e.URIString,parentReportUnitURI:e.parentResource?e.parentResource.URIString:"",resourceType:e.resourceType.substring(e.resourceType.lastIndexOf(".")+1)},hash:"runInBackground@"+e.URIString+r,encode:!0})},d.RedirectAction.createScheduleAction=function(){var e=d.model.getSelectedResources()[0],r="";if(e.resourceType.endsWith(".ReportUnit")||e.resourceType.endsWith(".AdhocReportUnit")||e.resourceType.endsWith(".DashboardModelResource")||e.resourceType.endsWith(".ReportOptions"))return e.parentResource&&(r="@@parentReportURI="+e.parentResource.URIString+"@@"),new d.RedirectAction(d.RedirectType.LOCATION_REDIRECT,{url:A.vars.contextPath+"/scheduler/main.html",paramsMap:{reportUnitURI:e.URIString,resourceType:e.resourceType.substring(1+e.resourceType.lastIndexOf(".")),parentReportUnitURI:e.parentResource?e.parentResource.URIString:""},hash:e.URIString+r,encode:!0})},d.createActionFactory={OlapClientConnection:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"olapClientConnectionFlow",paramsMap:{ParentFolderUri:e.URI}})},OlapUnit:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"olapUnitFlow",paramsMap:{ParentFolderUri:e.URI}})},ReportDataSource:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"addDataSourceFlow",paramsMap:{ParentFolderUri:e.URI}})},SemanticLayerDataSource:function(e){return new d.RedirectAction(d.RedirectType.LOCATION_REDIRECT,{url:"domaindesigner.html",paramsMap:{ParentFolderUri:e.URI}})},FileResource:function(e,r){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"addFileResourceFlow",paramsMap:{expectedFileType:r,parentFolder:e.URI}})},ReportUnit:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"reportUnitFlow",paramsMap:{ParentFolderUri:e.URI}})},Query:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"queryFlow",paramsMap:{ParentFolderUri:e.URI}})},InputControl:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"addInputControlFlow",paramsMap:{ParentFolderUri:e.URI}})},DataType:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"dataTypeFlow",paramsMap:{ParentFolderUri:e.URI}})},ListOfValues:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"addListOfValuesFlow",paramsMap:{ParentFolderUri:e.URI}})},XMLAConnection:function(e){return new d.RedirectAction(d.RedirectType.FLOW_REDIRECT,{flowId:"mondrianXmlaSourceFlow",paramsMap:{ParentFolderUri:e.URI}})}},d.RedirectAction.createCreateResourceAction=function(e,r){var t=d.model.getContextFolder(),o=d.createActionFactory[e];return o?o(t,r):new d.Action(function(){alert("Create action for resource type suffix '"+e+"' is not implemented!")})},d.confirmAndLeave=function(){return new d.Action(function(){return!R()&&!l()||confirm(d.getMessage("RM_CANCEL_EDIT_MESSAGE"))}).invokeAction()},t.exports=d});