/*
 * Copyright (C) 2005 - 2020 TIBCO Software Inc. All rights reserved. Confidentiality & Proprietary.
 * Licensed pursuant to commercial TIBCO End User License Agreement.
 */

!function(t,e){"object"==typeof module&&module.exports?module.exports=t(require("highcharts"),require("jquery")):"function"==typeof define&&define.amd?define(["highcharts","jquery"],t):t(e.Highcharts,e.jQuery)}(function(t,e){function i(t,e){var o,s,r=t&&t.length;if(r)return o=["plotX","plotY"][e%2],t.sort(function(t,e){return t[o]-e[o]}),s=Math.floor(r/2),{point:t[s],left:i(t.slice(0,s),e+1),right:i(t.slice(s+1),e+1)}}function o(t,e,i){var s,r,n,a,l,h=e.point,c=["plotX","plotY"][i%2],d=h;return h.dist=Math.pow(t.plotX-h.plotX,2)+Math.pow(t.plotY-h.plotY,2),s=t[c]-h[c],r=s<0?"left":"right",e[r]&&(a=o(t,e[r],i+1),d=a.dist<d.dist?a:h,n=s<0?"right":"left",e[n]&&Math.abs(s)<d.dist&&(l=o(t,e[n],i+1),d=l.dist<d.dist?l:d)),d}!function(t){var e,i=t.addEvent,o=t.Axis,s=t.Chart,r=t.color,n=t.each,a=t.extend,l=t.isNumber,h=t.Legend,c=t.LegendSymbolMixin,d=t.noop,p=t.merge,f=t.pick;t.ColorAxis||(e=t.ColorAxis=function(){this.init.apply(this,arguments)},a(e.prototype,o.prototype),a(e.prototype,{defaultColorAxisOptions:{lineWidth:0,minPadding:0,maxPadding:0,gridLineWidth:1,tickPixelInterval:72,startOnTick:!0,endOnTick:!0,offset:0,marker:{animation:{duration:50},width:.01,color:"#999999"},labels:{overflow:"justify",rotation:0},minColor:"#e6ebf5",maxColor:"#003399",tickLength:5,showInLegend:!0},keepProps:["legendGroup","legendItemHeight","legendItemWidth","legendItem","legendSymbol"].concat(o.prototype.keepProps),init:function(t,e){var i,s="vertical"!==t.options.legend.layout;this.coll="colorAxis",i=p(this.defaultColorAxisOptions,{side:s?2:1,reversed:!s},e,{opposite:!s,showEmpty:!1,title:null,visible:t.options.legend.enabled}),o.prototype.init.call(this,t,i),e.dataClasses&&this.initDataClasses(e),this.initStops(),this.horiz=s,this.zoomEnabled=!1,this.defaultLegendLength=200},initDataClasses:function(t){var e,i=this.chart,o=0,s=i.options.chart.colorCount,a=this.options,l=t.dataClasses.length;this.dataClasses=e=[],this.legendItems=[],n(t.dataClasses,function(t,n){var h;t=p(t),e.push(t),t.color||("category"===a.dataClassColor?(h=i.options.colors,s=h.length,t.color=h[o],t.colorIndex=o,++o===s&&(o=0)):t.color=r(a.minColor).tweenTo(r(a.maxColor),l<2?.5:n/(l-1)))})},setTickPositions:function(){if(!this.dataClasses)return o.prototype.setTickPositions.call(this)},initStops:function(){this.stops=this.options.stops||[[0,this.options.minColor],[1,this.options.maxColor]],n(this.stops,function(t){t.color=r(t[1])})},setOptions:function(t){o.prototype.setOptions.call(this,t),this.options.crosshair=this.options.marker},setAxisSize:function(){var t,e,i,o,s=this.legendSymbol,r=this.chart,n=r.options.legend||{};s?(this.left=t=s.attr("x"),this.top=e=s.attr("y"),this.width=i=s.attr("width"),this.height=o=s.attr("height"),this.right=r.chartWidth-t-i,this.bottom=r.chartHeight-e-o,this.len=this.horiz?i:o,this.pos=this.horiz?t:e):this.len=(this.horiz?n.symbolWidth:n.symbolHeight)||this.defaultLegendLength},normalizedValue:function(t){return this.isLog&&(t=this.val2lin(t)),1-(this.max-t)/(this.max-this.min||1)},toColor:function(t,e){var i,o,s,r,n,a,l=this.stops,h=this.dataClasses;if(h){for(a=h.length;a--;)if(n=h[a],o=n.from,s=n.to,(void 0===o||t>=o)&&(void 0===s||t<=s)){r=n.color,e&&(e.dataClass=a,e.colorIndex=n.colorIndex);break}}else{for(i=this.normalizedValue(t),a=l.length;a--&&!(i>l[a][0]););o=l[a]||l[a+1],s=l[a+1]||o,i=1-(s[0]-i)/(s[0]-o[0]||1),r=o.color.tweenTo(s.color,i)}return r},getOffset:function(){var t=this.legendGroup,e=this.chart.axisOffset[this.side];t&&(this.axisParent=t,o.prototype.getOffset.call(this),this.added||(this.added=!0,this.labelLeft=0,this.labelRight=this.width),this.chart.axisOffset[this.side]=e)},setLegendColor:function(){var t,e=this.horiz,i=this.reversed,o=i?1:0,s=i?0:1;t=e?[o,0,s,0]:[0,s,0,o],this.legendColor={linearGradient:{x1:t[0],y1:t[1],x2:t[2],y2:t[3]},stops:this.stops}},drawLegendSymbol:function(t,e){var i=t.padding,o=t.options,s=this.horiz,r=f(o.symbolWidth,s?this.defaultLegendLength:12),n=f(o.symbolHeight,s?12:this.defaultLegendLength),a=f(o.labelPadding,s?16:30),l=f(o.itemDistance,10);this.setLegendColor(),e.legendSymbol=this.chart.renderer.rect(0,t.baseline-11,r,n).attr({zIndex:1}).add(e.legendGroup),this.legendItemWidth=r+i+(s?l:a),this.legendItemHeight=n+i+(s?a:0)},setState:function(t){n(this.series,function(e){e.setState(t)})},visible:!0,setVisible:d,getSeriesExtremes:function(){var t=this.series,e=t.length;for(this.dataMin=1/0,this.dataMax=-1/0;e--;)t[e].getExtremes(),void 0!==t[e].valueMin&&(this.dataMin=Math.min(this.dataMin,t[e].valueMin),this.dataMax=Math.max(this.dataMax,t[e].valueMax))},drawCrosshair:function(t,e){var i,s=e&&e.plotX,r=e&&e.plotY,n=this.pos,a=this.len;e&&(i=this.toPixels(e[e.series.colorKey]),i<n?i=n-2:i>n+a&&(i=n+a+2),e.plotX=i,e.plotY=this.len-i,o.prototype.drawCrosshair.call(this,t,e),e.plotX=s,e.plotY=r,this.cross&&!this.cross.addedToColorAxis&&this.legendGroup&&(this.cross.addClass("highcharts-coloraxis-marker").add(this.legendGroup),this.cross.addedToColorAxis=!0,this.cross.attr({fill:this.crosshair.color})))},getPlotLinePath:function(t,e,i,s,r){return l(r)?this.horiz?["M",r-4,this.top-6,"L",r+4,this.top-6,r,this.top,"Z"]:["M",this.left,r,"L",this.left-6,r+6,this.left-6,r-6,"Z"]:o.prototype.getPlotLinePath.call(this,t,e,i,s)},update:function(t,e){var i=this.chart,s=i.legend;n(this.series,function(t){t.isDirtyData=!0}),t.dataClasses&&s.allItems&&(n(s.allItems,function(t){t.isDataClass&&t.legendGroup&&t.legendGroup.destroy()}),i.isDirtyLegend=!0),i.options[this.coll]=p(this.userOptions,t),o.prototype.update.call(this,t,e),this.legendItem&&(this.setLegendColor(),s.colorizeItem(this,!0))},remove:function(){this.legendItem&&this.chart.legend.destroyItem(this),o.prototype.remove.call(this)},getDataClassLegendSymbols:function(){var e,i=this,o=this.chart,s=this.legendItems,r=o.options.legend,l=r.valueDecimals,h=r.valueSuffix||"";return s.length||n(this.dataClasses,function(r,p){var f=!0,u=r.from,g=r.to;e="",void 0===u?e="< ":void 0===g&&(e="> "),void 0!==u&&(e+=t.numberFormat(u,l)+h),void 0!==u&&void 0!==g&&(e+=" - "),void 0!==g&&(e+=t.numberFormat(g,l)+h),s.push(a({chart:o,name:e,options:{},drawLegendSymbol:c.drawRectangle,visible:!0,setState:d,isDataClass:!0,setVisible:function(){f=this.visible=!f,n(i.series,function(t){n(t.points,function(t){t.dataClass===p&&t.setVisible(f)})}),o.legend.colorizeItem(this,f)}},r))}),s},name:""}),n(["fill","stroke"],function(e){t.Fx.prototype[e+"Setter"]=function(){this.elem.attr(e,r(this.start).tweenTo(r(this.end),this.pos),null,!0)}}),i(s,"afterGetAxes",function(){var t=this.options,i=t.colorAxis;this.colorAxis=[],i&&new e(this,i)}),i(h,"afterGetAllItems",function(e){var i,o=[],s=this.chart.colorAxis[0];for(s&&s.options&&s.options.showInLegend&&(s.options.dataClasses?o=s.getDataClassLegendSymbols():o.push(s),n(s.series,function(i){t.erase(e.allItems,i)})),i=o.length;i--;)e.allItems.unshift(o[i])}),i(h,"afterColorizeItem",function(t){t.visible&&t.item.legendColor&&t.item.legendSymbol.attr({fill:t.item.legendColor})}),i(h,"afterUpdate",function(){this.chart.colorAxis[0]&&this.chart.colorAxis[0].update({},arguments[2])}))}(t),function(t){var e=t.defined,i=t.each,o=t.noop,s=t.seriesTypes;t.colorPointMixin={isValid:function(){return null!==this.value&&this.value!==1/0&&this.value!==-1/0},setVisible:function(t){var e=this,o=t?"show":"hide";i(["graphic","dataLabel"],function(t){e[t]&&e[t][o]()})},setState:function(e){t.Point.prototype.setState.call(this,e),this.graphic&&this.graphic.attr({zIndex:"hover"===e?1:0})}},t.colorSeriesMixin={pointArrayMap:["value"],axisTypes:["xAxis","yAxis","colorAxis"],optionalAxis:"colorAxis",trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:o,parallelArrays:["x","y","value"],colorKey:"value",pointAttribs:s.column.prototype.pointAttribs,translateColors:function(){var t=this,e=this.options.nullColor,o=this.colorAxis,s=this.colorKey;i(this.data,function(i){var r,n=i[s];(r=i.options.color||(i.isNull?e:o&&void 0!==n?o.toColor(n,i):i.color||t.color))&&(i.color=r)})},colorAttribs:function(t){var i={};return e(t.color)&&(i[this.colorProp||"fill"]=t.color),i}}}(t),function(t){var e=t.colorPointMixin,i=t.colorSeriesMixin,o=t.each,s=t.LegendSymbolMixin,r=t.merge,n=t.noop,a=t.pick,l=t.Series,h=t.seriesType,c=t.seriesTypes;h("heatmap","scatter",{animation:!1,borderWidth:0,nullColor:"#f7f7f7",dataLabels:{formatter:function(){return this.point.value},inside:!0,verticalAlign:"middle",crop:!1,overflow:!1,padding:0},marker:null,pointRange:null,tooltip:{pointFormat:"{point.x}, {point.y}: {point.value}<br/>"},states:{hover:{halo:!1,brightness:.2}}},r(i,{pointArrayMap:["y","value"],hasPointSpecificOptions:!0,getExtremesFromAll:!0,directTouch:!0,init:function(){var t;c.scatter.prototype.init.apply(this,arguments),t=this.options,t.pointRange=a(t.pointRange,t.colsize||1),this.yAxis.axisPointRange=t.rowsize||1},translate:function(){var t=this,e=t.options,i=t.xAxis,s=t.yAxis,r=e.pointPadding||0,n=function(t,e,i){return Math.min(Math.max(e,t),i)};t.generatePoints(),o(t.points,function(t){var o=(e.colsize||1)/2,l=(e.rowsize||1)/2,h=n(Math.round(i.len-i.translate(t.x-o,0,1,0,1)),-i.len,2*i.len),c=n(Math.round(i.len-i.translate(t.x+o,0,1,0,1)),-i.len,2*i.len),d=n(Math.round(s.translate(t.y-l,0,1,0,1)),-s.len,2*s.len),p=n(Math.round(s.translate(t.y+l,0,1,0,1)),-s.len,2*s.len),f=a(t.pointPadding,r);t.plotX=t.clientX=(h+c)/2,t.plotY=(d+p)/2,t.shapeType="rect",t.shapeArgs={x:Math.min(h,c)+f,y:Math.min(d,p)+f,width:Math.abs(c-h)-2*f,height:Math.abs(p-d)-2*f}}),t.translateColors()},drawPoints:function(){c.column.prototype.drawPoints.call(this),o(this.points,function(t){t.graphic.attr(this.colorAttribs(t))},this)},animate:n,getBox:n,drawLegendSymbol:s.drawRectangle,alignDataLabel:c.column.prototype.alignDataLabel,getExtremes:function(){l.prototype.getExtremes.call(this,this.valueData),this.valueMin=this.dataMin,this.valueMax=this.dataMax,l.prototype.getExtremes.call(this)}}),t.extend({haloPath:function(t){if(!t)return[];var e=this.shapeArgs;return["M",e.x-t,e.y-t,"L",e.x-t,e.y+e.height+t,e.x+e.width+t,e.y+e.height+t,e.x+e.width+t,e.y-t,"Z"]}},e))}(t);var s=!1;return t.wrap(t.seriesTypes.heatmap.prototype,"drawPoints",function(){var e,o=this,r=o.chart;s=!1,r.options.chart.isHeatMapTimeSeriesChart&&(s=!0),r.renderer.forExport&&(s=!1),s?(e=o.getContext())?(e.canvas.height=r.renderer.plotBox.height,e.canvas.width=r.renderer.plotBox.width,t.each(o.points,function(t){var i,o=t.plotY;void 0===o||isNaN(o)||null===t.y||(i=t.shapeArgs,e.fillStyle=t.color,e.fillRect(i.x,i.y,i.width,i.height))}),o.tree=null,setTimeout(function(){o.tree=i(o.points,0)}),o.addStylesForTooltipOnCanvas()):r.showLoading("Your browser doesn't support HTML5 canvas, <br>please use a modern browser"):this.proceed()}),t.wrap(t.Pointer.prototype,"runPointActions",function(e,i,o){var r;this.proceed(i,o),s&&(r=this.chart,!0!==i._syntheticEvent&&this.chart.options.chart.isHeatMapTimeSeriesChart&&t.each(r.series,function(t){var e;t.getNearest&&(e=t.getNearest({plotX:i.chartX-r.plotLeft,plotY:i.chartY-r.plotTop}))&&(i._syntheticEvent=!0,e.onMouseOver(i))}))}),t.extend(t.seriesTypes.heatmap.prototype,{getContext:function(){var t;return this.ctx||(t=document.createElement("canvas"),t.setAttribute("width",this.chart.plotWidth),t.setAttribute("height",this.chart.plotHeight),t.style.position="absolute",t.style.left=this.group.translateX+"px",t.style.top=this.group.translateY+"px",t.style.zIndex=0,t.style.cursor="crosshair",this.chart.container.appendChild(t),t.getContext&&(this.ctx=t.getContext("2d"))),this.ctx},getNearest:function(t){return this.tree?o(t,this.tree,0):null},addStylesForTooltipOnCanvas:function(){var t=e(this.chart.container),i=t.find("#jasper_highcharts_css");if(s){if(0===i.length){var o=e("<style type='text/css'>.highcharts-tooltip>span {background: rgba(255,255,255,0.85);border: 1px solid silver;border-radius: 3px;box-shadow: 1px 1px 2px #888;padding: 8px;z-index: 2;}.highcharts-button>span {background: rgba(255,255,255,0.85);border: 1px solid silver;border-radius: 3px;padding: 5px;z-index: 2;cursor: pointer;}.highcharts-button>span:hover {background: -moz-linear-gradient(top, #ffffff 0%, #aaccff 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#ffffff), color-stop(100%,#aaccff));background: -webkit-linear-gradient(top, #ffffff 0%,#aaccff 100%);background: -o-linear-gradient(top, #ffffff 0%,#aaccff 100%);background: -ms-linear-gradient(top, #ffffff 0%,#aaccff 100%);background: linear-gradient(to bottom, #ffffff 0%,#aaccff 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#aaccff',GradientType=0 );}</style>");o.attr("id","jasper_highcharts_css"),t.append(o)}}else i.length&&i.remove()}}),t},this);